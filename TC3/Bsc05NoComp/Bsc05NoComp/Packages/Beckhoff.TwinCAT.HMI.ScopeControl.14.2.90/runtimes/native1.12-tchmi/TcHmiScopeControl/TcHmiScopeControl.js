"use strict";var TcHmi;!function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl_1){class TcHmiScopeControl extends TcHmi.Controls.System.TcHmiControl{static#tchmiFQN="TcHmi.Controls.Beckhoff.TcHmiScopeControl."+this.name;constructor(element,pcElement,attrs){super(element,pcElement,attrs),this.__mousedownHandler=this.__onMouseDown(),this.__mousedownGlobalHandler=this.__onMouseDownGlobal(),this.__mouseupHandler=this.__onMouseUp(),this.__mousemoveHandler=this.__onMouseMove(),this.__mousemoveChangeCursorHandler=this.__onMouseMoveChangeCursor(),this.__mousemoveOverviewHandler=this.__onMouseMoveOverview(),this.__mouseupOverviewHandler=this.__onMouseUpOverview(),this.__touchstartHandler=this.__onTouchStart(),this.__touchmoveHandler=this.__onTouchMove(),this.__touchendHandler=this.__onTouchEnd(),this.__mousewheelHandler=this.__onMouseWheel(),this.__serverSymbolsHelper=new TcHmiScopeControl_1.ServerSymbols(this)}static triggerImages=new Map;__elementTemplateRoot;__elementChartings;__elementTriggerWindow;__elementBorder;__elementOverview;__elementChartName;__elementMenuBar;__elementMenuBarDropdown;__elementToolBar;__elementTimeBar;__elementLegend;__elementLoading;__elementTooltip;__elementTooltipText;__elementTooltipArrow;__elementDialog;__elementTimeRangeDialog;__storage;__replace=void 0;__localizedElements=new Map;__localizedEngineeringElements=new Map;__localizationReader=void 0;__destroyLocalizationWatch=null;__scopeIsInitialized=!1;__showLegend=!0;__scaling={x:1,y:1};__scopeConfig;__serverInterval;__serverDomain;__enableRecordControls;__chartChartColorSource;__triggerWindowPosition;__showTriggerWindow;__lineCharts=[];__overviewChart=null;__chartingElements=[];__toolBarControls={};__toolBarControlsArray=[];__timeBarControls={};__datagrid;__initEventDestroyEvent=null;__resizeEventDestroyEvent=null;__themeDataLoadedEventDestroyEvent=null;__userDataChangedEventDestroyEvent=null;__scopeEventsDestroyEvent=null;__configEventsDestroyEvent=null;__mousedownHandler;__mousedownGlobalHandler;__mouseupHandler;__mousemoveHandler;__mousemoveChangeCursorHandler;__mousemoveOverviewHandler;__mouseupOverviewHandler;__touchstartHandler;__touchmoveHandler;__touchendHandler;__mousewheelHandler;__subscriptionIdOnExtensionStateChanged=null;__initRequestId=null;__openConnectionRequestId=null;__subscriptionIdMenubar=null;__setChartSizeRequestId=null;__subscriptionId=null;__subscriptionIdActualWindow=null;__startRecordRequestId=null;__startRequestId=null;__stopRecordRequestId=null;__stopRequestId=null;__zoomRequestId=null;__panRequestId=null;__wheelRequestId=null;__unzoomRequestId=null;__zoomOutRequestId=null;__displayWidthRequestId=null;__gotoRequestId=null;__scrollRequestId=null;__scrollBigRequestId=null;__undoRequestId=null;__redoRequestId=null;__setOverviewModeRequestId=null;__setOverviewRectRequestId=null;__getTooltipRequestId=null;__resizeChartsRequestId=null;__changeChannelStateRequestId=null;__saveCurrentRecordRequestId=null;__subscriptionIdTriggerWindow=null;__setTriggerCommentRequestId=null;__uploadedRecordsRequestId=null;__deleteScopeRecordRequestId=null;__changePersistRequestId=null;__getAnalyticsDataRequestId=null;__subscriptionIdGetRecords=null;__getChartListRequestId=null;__openConnectionToFileRequestId=null;__getMenubarRequestId=null;__getDataRequestId=null;__closeConnectionRequestId=null;__subscriptionIdGetAllUploadedRecords=null;__subscriptionIdGetOwnUploadedRecords=null;__clickOverviewElementRequestId=null;__setAnalyticsRecordRequestId=null;__tooltipTimeout=null;__menubar;__legend;__scopeLayout;__scopeGraphData;__scopeGraphWindow=null;__triggerWindow=null;__enabledButtons=TcHmiScopeControl_1.ButtonsEnabled.None;__enabledTimes=TcHmiScopeControl_1.TimesEnabled.None;__sessionId=null;__socketId=null;__extensionInitCompleted=!1;__scopeConfigLoaded=!1;__mouseMode=TcHmiScopeControl_1.MouseMode.None;__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!1};__multitouchInfo={multitouchMode:!1,first:{identifier:null,startPoint:{x:0,y:0}},second:{identifier:null,startPoint:{x:0,y:0}},offset:{left:0,top:0},distance:0,elementIndex:-1,middlePoint:{x:0,y:0}};__wheelInfo={isWheeling:!1,wheelSteps:0,mousePosition:{x:0,y:0},timeout:0};__resizeLines=[];__destroyEvents={};__themeChartBackgroundColor=null;__themeChartForegroundColor=null;__themeOverviewBackgroundColor=null;__themeOverviewForegroundColor=null;__themeCanvasBackgroundColor=null;__themeAxisColor=null;__themeGridColor=null;__themeAxisGroupForegroundColor=null;__displayWidthText;__gotoText;__showOverview;__overviewRectangle={position:{x:0,y:0},dimensions:{width:0,height:0}};__loadingSpinner=null;__virtualMappingForControlRecord=[{controlRight:"operate",virtualControlRight:"controlRecord"}];__virtualMappingForChangeHistoricalAquisitions=[{controlRight:"operate",virtualControlRight:"changeHistoricalAquisitions"}];__timeRangeDialog=null;__dialog=null;__uploadedRecordsForActUser=null;__scopeConfigToFile=null;__oldScopeConfig=void 0;__errorPrompt=null;__activeLegendElements;__serverSymbolsHelper;__previnit(){if(this.__elementTemplateRoot=this.__element.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template"),this.__elementChartings=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chartings"),this.__elementTriggerWindow=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-window"),this.__elementBorder=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-border"),this.__elementOverview=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-overview"),this.__elementChartName=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart-name"),this.__elementMenuBar=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar"),this.__elementTimeBar=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-time-bar"),this.__elementToolBar=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-tool-bar"),this.__elementMenuBarDropdown=$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-dropdown TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-popup tchmi-box"><div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-time-bar-dropdown tchmi-box"></div><div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tool-bar-dropdown tchmi-box"></div></div>'),this.__elementLegend=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend"),this.__elementLoading=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-loading"),this.__elementTooltip=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip"),this.__elementTooltipText=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-text"),this.__elementTooltipArrow=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow"),this.__elementDialog=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-dialog"),this.__elementTimeRangeDialog=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-time-range-dialog"),0===this.__elementTemplateRoot.length||0===this.__elementChartings.length||0===this.__elementTriggerWindow.length||0===this.__elementBorder.length||0===this.__elementOverview.length||0===this.__elementChartName.length||0===this.__elementMenuBar.length||0===this.__elementTimeBar.length||0===this.__elementToolBar.length||0===this.__elementMenuBarDropdown.length||0===this.__elementLegend.length||0===this.__elementLoading.length||0===this.__elementTooltip.length||0===this.__elementTooltipText.length||0===this.__elementTooltipArrow.length||0===this.__elementDialog.length||0===this.__elementTimeRangeDialog.length)throw new Error("Invalid Template.html");let loadingSpinnerDivTempDiv=document.createElement("div");loadingSpinnerDivTempDiv.innerHTML='<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-loading-spinner-container"><div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-loading-spinner"><div></div><div></div><div></div><div></div></div></div>',this.__loadingSpinner=loadingSpinnerDivTempDiv.firstElementChild;let localizedElements=this.__element[0].querySelectorAll("[data-tchmi-localized-content-key]");for(let i=0,ii=localizedElements.length;i<ii;i++){let element=localizedElements[i],localizeKey=element.dataset.tchmiLocalizedContentKey;localizeKey&&this.__localizedElements.set(localizeKey,{element:element,value:""})}TCHMI_DESIGNER?this.__destroyLocalizationWatch=this.__localization.watchEx({level:TcHmi.Locale.Level.Engineering},(data=>{if(data.error===TcHmi.Errors.NONE&&data.reader){this.__localizationReader=data.reader;for(const[key,info]of this.__localizedEngineeringElements){let localizedText=data.reader.get(key);info.innerHTML=localizedText}}})):this.__destroyLocalizationWatch=this.__localization.watch((data=>{if(data.error===TcHmi.Errors.NONE&&data.reader){this.__localizationReader=data.reader;for(const[key,info]of this.__localizedElements){let localizedText=data.reader.get(key);if(key.includes("Tooltip"))info.element.title=tchmi_decode_control_characters(localizedText);else if(null!==info.value)if(info.value.includes("Label_Text_Date_Placeholder")){let valueLocalization=this.__localizationReader.get("Label_Text_Date_Placeholder");info.element.textContent=tchmi_decode_control_characters(localizedText+": "+valueLocalization)}else key.includes("Label_Text_")?info.element.textContent=tchmi_decode_control_characters(localizedText+": "+info.value):info.element.textContent=tchmi_decode_control_characters(localizedText);else info.element.textContent=tchmi_decode_control_characters(localizedText)}}})),super.__previnit()}__init(){super.__init(),this.__storage=new TcHmi.LocalStorage(this,{replace:this.getReplace(),activeLegendElements:this.getScopeConfig()}),this.__activeLegendElements=this.__storage.get("activeLegendElements");let triggerWindowDatagrid=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiDatagrid",`${this.__id}_triggerWindowDatagrid`,{"data-tchmi-src-column":[{name:"count",label:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Label_Count%/l%",control:"TextBlock",width:1,widthUnit:"factor",resize:!0,sortable:!1,editable:!1,horizontalAlignment:"Center",verticalAlignment:"Center",headerHorizontalAlignment:"Center",headerVerticalAlignment:"Center"},{name:"triggerGroup",label:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Label_Trigger_Group%/l%",control:"TextBlock",width:30,widthUnit:"%",resize:!0,sortable:!1,editable:!1,horizontalAlignment:"Center",verticalAlignment:"Center",headerHorizontalAlignment:"Center",headerVerticalAlignment:"Center"},{name:"releaseTime",label:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Label_Release_Time%/l%",control:"TextBlock",width:30,widthUnit:"%",resize:!0,sortable:!1,editable:!1,horizontalAlignment:"Center",verticalAlignment:"Center",headerHorizontalAlignment:"Center",headerVerticalAlignment:"Center"},{name:"comment",label:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Label_Comment%/l%",control:"TextBox",width:25,widthUnit:"%",resize:!0,sortable:!1,editable:!0,horizontalAlignment:"Center",verticalAlignment:"Center",headerHorizontalAlignment:"Center",headerVerticalAlignment:"Center"}],"data-tchmi-width":100,"data-tchmi-width-unit":"%","data-tchmi-height":100,"data-tchmi-height-unit":"%","data-tchmi-show-row-numbers":!1},this);if(!triggerWindowDatagrid)throw new Error("Needed Datagrid could not be instantiated");if(triggerWindowDatagrid.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-window-datagrid"),this.__elementTriggerWindow[0].appendChild(triggerWindowDatagrid.getElement()[0]),this.__destroyEvents.TriggerWindowDatagrid=TcHmi.EventProvider.register(this.__id+"_triggerWindowDatagrid.onDataChanged",this.__onTriggerDatagrid_DataChanged()),this.__datagrid=triggerWindowDatagrid,this.__elementLegend[0].addEventListener("mousedown",this.__onCheckboxMouseDown),this.__elementLegend[0].addEventListener("touchstart",this.__onCheckboxTouchStart),this.__loadThemedResources(),TCHMI_DESIGNER)return;if(this.__serverDomain){this.__configEventsDestroyEvent=TcHmi.Server.Events.registerConsumer([{path:"domain",comparator:"==",value:this.__serverDomain},{logic:"AND"},{path:"payload::configType",comparator:">=",value:0},{logic:"OR"},{path:"payload::type",comparator:"==",value:"general"}],{subscription:this.__configEventCallback()});let symbol="ListDomains";this.__subscriptionIdOnExtensionStateChanged=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbol}],300,this.__onExtensionStateChanged())}let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Init",writeValue:{controlName:this.__id}},{commandOptions:["SendErrorMessage"],symbol:"GetSymbolAccess",writeValue:this.__serverDomain+".GetAllUploadedRecords"}]};TcHmi.Server.releaseRequest(this.__initRequestId),this.__initRequestId=TcHmi.Server.requestEx(request,null,this.__initCallback())}getReplace(){return this.__replace}__clearInit(){null!==this.__subscriptionId&&(TcHmi.Server.unsubscribe(this.__subscriptionId,null),this.__subscriptionId=null),null!==this.__subscriptionIdMenubar&&(TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar,null),this.__subscriptionIdMenubar=null),null!==this.__subscriptionIdActualWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow,null),this.__subscriptionIdActualWindow=null),null!==this.__subscriptionIdTriggerWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdTriggerWindow,null),this.__subscriptionIdTriggerWindow=null),null!==this.__subscriptionIdGetAllUploadedRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetAllUploadedRecords,null),this.__subscriptionIdGetAllUploadedRecords=null),null!==this.__subscriptionIdGetOwnUploadedRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetOwnUploadedRecords,null),this.__subscriptionIdGetOwnUploadedRecords=null),null!==this.__subscriptionIdGetRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetRecords,null),this.__subscriptionIdGetRecords=null),this.__scopeEventsDestroyEvent?.(),this.__scopeEventsDestroyEvent=null,this.__dialog?.resetToDefault(),this.__sessionId=null,this.__socketId=null,this.__extensionInitCompleted=!1;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Init",writeValue:{controlName:this.__id}},{commandOptions:["SendErrorMessage"],symbol:"GetSymbolAccess",writeValue:this.__serverDomain+".GetAllUploadedRecords"}]};TcHmi.Server.releaseRequest(this.__initRequestId),this.__initRequestId=TcHmi.Server.requestEx(request,null,this.__initCallback()),this.__openWebsocket()}__initCallback(){return result=>{if(!this.__isDestroyed&&null!==this.__initRequestId)if(this.__initRequestId=null,result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error. Details: `+TcHmi.Log.buildMessage(result.response.error)),void this.__loadingSpinner?.remove();if(result.response.commands)for(let i=0,ii=result.response.commands.length;i<ii;i++){if(result.response.commands[i].error&&130!==result.response.commands[i].error.code)return TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: `+TcHmi.Log.buildMessage(result.response.commands[i].error)),this.__loadingSpinner?.remove(),void this.__clearFullControl();if(result.response.commands[i].symbol===this.__serverDomain+".Init"){let sessionId=result.response.sessionId,socketId=result.response.commands[i].readValue?.socketId;this.__extensionInitCompleted=result.response.commands[i].readValue?.initCompleted,sessionId&&socketId&&this.__serverDomain&&(this.__sessionId=sessionId,this.__socketId=socketId,this.__scopeEventsDestroyEvent=TcHmi.Server.Events.registerConsumer([{path:"domain",comparator:"==",value:this.__serverDomain},{logic:"AND"},{path:"payload::sessionId",comparator:"==",value:this.__sessionId},{logic:"AND"},{path:"payload::socketId",comparator:"==",value:this.__socketId}],{subscription:this.__scopeEventCallback()},this.__eventRegisterDoneCallback()))}else if(null!==result.response.commands[i].readValue&&"GetSymbolAccess"===result.response.commands[i].symbol)if(this.__subscriptionIdGetAllUploadedRecords&&TcHmi.Server.unsubscribe(this.__subscriptionIdGetAllUploadedRecords,null),this.__subscriptionIdGetOwnUploadedRecords&&TcHmi.Server.unsubscribe(this.__subscriptionIdGetOwnUploadedRecords,null),3===result.response.commands[i].readValue){let symbol=this.__serverDomain+".GetAllUploadedRecords";this.__subscriptionIdGetAllUploadedRecords=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbol}],1e3,this.__getUploadedRecordsCallback())}else{let symbol=this.__serverDomain+".GetOwnUploadedRecords";this.__subscriptionIdGetOwnUploadedRecords=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbol}],1e3,this.__getUploadedRecordsCallback())}}}else this.__loadingSpinner?.remove(),result.error&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Framework error= ${result.error}, name= ${TcHmi.Errors[result.error]} while fetching data from server. Details: `+TcHmi.Log.buildMessage(result.details))}}__getUploadedRecordsCallback(){return result=>{if(!this.__isDestroyed&&result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return void TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error. Details: `+TcHmi.Log.buildMessage(result.response.error));if(result.response.commands)for(let i=0,ii=result.response.commands.length;i<ii;i++)result.response.commands[i].error&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: ${TcHmi.Log.buildMessage(result.response.commands[i].error)}`),result.response.commands[i].symbol!==this.__serverDomain+".GetAllUploadedRecords"&&result.response.commands[i].symbol!==this.__serverDomain+".GetOwnUploadedRecords"||(this.__uploadedRecordsForActUser=result.response.commands[i].readValue,this.__dialog?.setSrcDataOfRecordsDatagrid(this.__uploadedRecordsForActUser))}}}__eventRegisterDoneCallback(){return data=>{data.error!==TcHmi.Errors.NONE&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Error registering the scope event consumer. Details: ${data.error} IMPORTANT: No scope events are logged now. All messages and errors are displayed on the server log page.`),this.__scopeIsInitialized=!0,TcHmi.EventProvider.raise(this.__id+".onInitChanged")}}__initChanged(){return evt=>{this.__initEventDestroyEvent?.(),this.__initEventDestroyEvent=null,this.__openConnection()}}__attach(){super.__attach(),!TCHMI_DESIGNER&&this.__serverDomain&&this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),TCHMI_DESIGNER||(this.__resizeEventDestroyEvent=TcHmi.EventProvider.register(this.__id+".onResized",this.__rebuild()),this.__themeDataLoadedEventDestroyEvent=TcHmi.EventProvider.register("onThemeDataChanged",this.__onThemeDataChanged()),this.__userDataChangedEventDestroyEvent=TcHmi.EventProvider.register("onUserDataChanged",this.__onUserDataChanged()));const passiveEventOptions={passive:!0,capture:!1},activeEventOptions={passive:!1,capture:!1};document.addEventListener("mousedown",this.__mousedownGlobalHandler,passiveEventOptions),document.addEventListener("mousemove",this.__mousemoveHandler,passiveEventOptions),document.addEventListener("mouseup",this.__mouseupHandler,passiveEventOptions),this.__element[0].addEventListener("mousemove",this.__mousemoveChangeCursorHandler,passiveEventOptions),document.addEventListener("touchmove",this.__touchmoveHandler,activeEventOptions),document.addEventListener("touchend",this.__touchendHandler,activeEventOptions),this.__replace=this.__storage?.get("replace"),this.__openWebsocket()}__detach(){super.__detach(),this.__initEventDestroyEvent?.(),this.__initEventDestroyEvent=null,this.__resizeEventDestroyEvent?.(),this.__resizeEventDestroyEvent=null,this.__themeDataLoadedEventDestroyEvent?.(),this.__themeDataLoadedEventDestroyEvent=null,this.__userDataChangedEventDestroyEvent?.(),this.__userDataChangedEventDestroyEvent=null,null!==this.__scopeEventsDestroyEvent&&(this.__scopeEventsDestroyEvent(),this.__scopeEventsDestroyEvent=null),null!==this.__startRecordRequestId&&(TcHmi.Server.releaseRequest(this.__startRecordRequestId),this.__startRecordRequestId=null),null!==this.__startRequestId&&(TcHmi.Server.releaseRequest(this.__startRequestId),this.__startRequestId=null),null!==this.__stopRecordRequestId&&(TcHmi.Server.releaseRequest(this.__stopRecordRequestId),this.__stopRecordRequestId=null),null!==this.__stopRequestId&&(TcHmi.Server.releaseRequest(this.__stopRequestId),this.__stopRequestId=null),null!==this.__zoomRequestId&&(TcHmi.Server.releaseRequest(this.__zoomRequestId),this.__zoomRequestId=null),null!==this.__panRequestId&&(TcHmi.Server.releaseRequest(this.__panRequestId),this.__panRequestId=null),null!==this.__wheelRequestId&&(TcHmi.Server.releaseRequest(this.__wheelRequestId),this.__wheelRequestId=null),null!==this.__unzoomRequestId&&(TcHmi.Server.releaseRequest(this.__unzoomRequestId),this.__unzoomRequestId=null),null!==this.__zoomOutRequestId&&(TcHmi.Server.releaseRequest(this.__zoomOutRequestId),this.__zoomOutRequestId=null),null!==this.__displayWidthRequestId&&(TcHmi.Server.releaseRequest(this.__displayWidthRequestId),this.__displayWidthRequestId=null),null!==this.__gotoRequestId&&(TcHmi.Server.releaseRequest(this.__gotoRequestId),this.__gotoRequestId=null),null!==this.__scrollRequestId&&(TcHmi.Server.releaseRequest(this.__scrollRequestId),this.__scrollRequestId=null),null!==this.__scrollBigRequestId&&(TcHmi.Server.releaseRequest(this.__scrollBigRequestId),this.__scrollBigRequestId=null),null!==this.__undoRequestId&&(TcHmi.Server.releaseRequest(this.__undoRequestId),this.__undoRequestId=null),null!==this.__redoRequestId&&(TcHmi.Server.releaseRequest(this.__redoRequestId),this.__redoRequestId=null),null!==this.__setOverviewModeRequestId&&(TcHmi.Server.releaseRequest(this.__setOverviewModeRequestId),this.__setOverviewModeRequestId=null),null!==this.__setOverviewRectRequestId&&(TcHmi.Server.releaseRequest(this.__setOverviewRectRequestId),this.__setOverviewRectRequestId=null),null!==this.__getTooltipRequestId&&(TcHmi.Server.releaseRequest(this.__getTooltipRequestId),this.__getTooltipRequestId=null),null!==this.__resizeChartsRequestId&&(TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=null),null!==this.__changeChannelStateRequestId&&(TcHmi.Server.releaseRequest(this.__changeChannelStateRequestId),this.__changeChannelStateRequestId=null),null!==this.__setTriggerCommentRequestId&&(TcHmi.Server.releaseRequest(this.__setTriggerCommentRequestId),this.__setTriggerCommentRequestId=null),null!==this.__saveCurrentRecordRequestId&&(TcHmi.Server.releaseRequest(this.__saveCurrentRecordRequestId),this.__saveCurrentRecordRequestId=null),null!==this.__uploadedRecordsRequestId&&(TcHmi.Server.releaseRequest(this.__uploadedRecordsRequestId),this.__uploadedRecordsRequestId=null),null!==this.__deleteScopeRecordRequestId&&(TcHmi.Server.releaseRequest(this.__deleteScopeRecordRequestId),this.__deleteScopeRecordRequestId=null),null!==this.__changePersistRequestId&&(TcHmi.Server.releaseRequest(this.__changePersistRequestId),this.__changePersistRequestId=null),null!==this.__getAnalyticsDataRequestId&&(TcHmi.Server.releaseRequest(this.__getAnalyticsDataRequestId),this.__getAnalyticsDataRequestId=null),null!==this.__getChartListRequestId&&(TcHmi.Server.releaseRequest(this.__getChartListRequestId),this.__getChartListRequestId=null),null!==this.__openConnectionToFileRequestId&&(TcHmi.Server.releaseRequest(this.__openConnectionToFileRequestId),this.__openConnectionToFileRequestId=null),null!==this.__getMenubarRequestId&&(TcHmi.Server.releaseRequest(this.__getMenubarRequestId),this.__getMenubarRequestId=null),null!==this.__getDataRequestId&&(TcHmi.Server.releaseRequest(this.__getDataRequestId),this.__getDataRequestId=null),null!==this.__closeConnectionRequestId&&(TcHmi.Server.releaseRequest(this.__closeConnectionRequestId),this.__closeConnectionRequestId=null),null!==this.__clickOverviewElementRequestId&&(TcHmi.Server.releaseRequest(this.__clickOverviewElementRequestId),this.__clickOverviewElementRequestId=null),null!==this.__setAnalyticsRecordRequestId&&(TcHmi.Server.releaseRequest(this.__setAnalyticsRecordRequestId),this.__setAnalyticsRecordRequestId=null);const passiveEventOptions={passive:!0,capture:!1},activeEventOptions={passive:!1,capture:!1};document.removeEventListener("mousedown",this.__mousedownGlobalHandler,passiveEventOptions),document.removeEventListener("mousemove",this.__mousemoveHandler,passiveEventOptions),document.removeEventListener("mouseup",this.__mouseupHandler,passiveEventOptions),this.__element[0].removeEventListener("mousemove",this.__mousemoveChangeCursorHandler,passiveEventOptions),document.removeEventListener("touchmove",this.__touchmoveHandler,activeEventOptions),document.removeEventListener("touchend",this.__touchendHandler,activeEventOptions),null!==this.__subscriptionId&&(TcHmi.Server.unsubscribe(this.__subscriptionId,null),this.__subscriptionId=null),null!==this.__subscriptionIdMenubar&&(TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar,null),this.__subscriptionIdMenubar=null),null!==this.__subscriptionIdActualWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow,null),this.__subscriptionIdActualWindow=null),null!==this.__subscriptionIdTriggerWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdTriggerWindow,null),this.__subscriptionIdTriggerWindow=null),null!==this.__subscriptionIdGetAllUploadedRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetAllUploadedRecords,null),this.__subscriptionIdGetAllUploadedRecords=null),null!==this.__subscriptionIdGetOwnUploadedRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetOwnUploadedRecords,null),this.__subscriptionIdGetOwnUploadedRecords=null),null!==this.__subscriptionIdGetRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetRecords,null),this.__subscriptionIdGetRecords=null);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".DetachControl",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};TcHmi.Server.requestEx(request,{parallel:!0})}destroy(){if(!this.__keepAlive){if(super.destroy(),null!==this.__subscriptionIdOnExtensionStateChanged&&(TcHmi.Server.unsubscribe(this.__subscriptionIdOnExtensionStateChanged,null),this.__subscriptionIdOnExtensionStateChanged=null),this.__configEventsDestroyEvent?.(),this.__configEventsDestroyEvent=null,null!==this.__subscriptionIdGetAllUploadedRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetAllUploadedRecords,null),this.__subscriptionIdGetAllUploadedRecords=null),null!==this.__subscriptionIdGetOwnUploadedRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetOwnUploadedRecords,null),this.__subscriptionIdGetOwnUploadedRecords=null),this.__scopeConfigToFile){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".CloseConnection",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfigToFile}}]};TcHmi.Server.requestEx(request,{parallel:!0})}else if(this.__scopeConfig){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".CloseConnection",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};TcHmi.Server.requestEx(request,{parallel:!0})}for(const destroyEvent of Object.values(this.__destroyEvents))destroyEvent?.();this.__destroyEvents={},this.__elementLegend[0].removeEventListener("mousedown",this.__onCheckboxMouseDown),this.__elementLegend[0].removeEventListener("touchstart",this.__onCheckboxTouchStart),this.__destroyLocalizationWatch?.(),this.__dialog?.destroy(),this.__dialog=null,this.__timeRangeDialog?.destroy(),this.__timeRangeDialog=null,this.__destroyLocalizationWatch=null}}__addOrUpdateLocalizedElement(element,key,value=null){if(this.__localizedElements.set(key,{element:element,value:value}),this.__localizationReader){let localizedText=this.__localizationReader.get(key);if(key.includes("Tooltip"))element.title=tchmi_decode_control_characters(localizedText);else if(null!==value)if(value.includes("Label_Text_Date_Placeholder")){let valueLocalization=this.__localizationReader.get("Label_Text_Date_Placeholder");element.textContent=tchmi_decode_control_characters(localizedText+": "+valueLocalization)}else key.includes("Label_Text_")?element.textContent=tchmi_decode_control_characters(localizedText+": "+value):element.textContent=tchmi_decode_control_characters(localizedText);else element.textContent=tchmi_decode_control_characters(localizedText)}}__removeLocalizedElement(key){this.__localizedElements.delete(key)}__loadThemedResources(){let chartBackgroundColor=TcHmi.Theme.Resources.get(this,"ChartBackgroundColor");TcHmi.isSolidColor(chartBackgroundColor.value)&&(this.__themeChartBackgroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(chartBackgroundColor.value));let chartForegroundColor=TcHmi.Theme.Resources.get(this,"ChartForegroundColor");TcHmi.isSolidColor(chartForegroundColor.value)&&(this.__themeChartForegroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(chartForegroundColor.value));let overviewBackgroundColor=TcHmi.Theme.Resources.get(this,"OverviewBackgroundColor");TcHmi.isSolidColor(overviewBackgroundColor.value)&&(this.__themeOverviewBackgroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(overviewBackgroundColor.value));let overviewForegroundColor=TcHmi.Theme.Resources.get(this,"OverviewForegroundColor");TcHmi.isSolidColor(overviewForegroundColor.value)&&(this.__themeOverviewForegroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(overviewForegroundColor.value));let canvasBackgroundColor=TcHmi.Theme.Resources.get(this,"CanvasBackgroundColor");TcHmi.isSolidColor(canvasBackgroundColor.value)&&(this.__themeCanvasBackgroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(canvasBackgroundColor.value));let axisColor=TcHmi.Theme.Resources.get(this,"AxisColor");TcHmi.isSolidColor(axisColor.value)&&(this.__themeAxisColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(axisColor.value));let gridColor=TcHmi.Theme.Resources.get(this,"GridColor");TcHmi.isSolidColor(gridColor.value)&&(this.__themeGridColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(gridColor.value));let axisGroupForegroundColor=TcHmi.Theme.Resources.get(this,"AxisGroupForegroundColor");TcHmi.isSolidColor(axisGroupForegroundColor.value)&&(this.__themeAxisGroupForegroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(axisGroupForegroundColor.value)),this.__drawLineChart()}__onThemeDataChanged(){let __this=this;return(evt,ctrl)=>{__this.__loadThemedResources(),__this.__rebuild()}}__onUserDataChanged(){return(event,data)=>{TcHmi.Server.getCurrentUserConfig().session!==this.__sessionId&&this.__serverDomain&&this.__clearInit()}}__onExtensionStateChanged(){return result=>{if(result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error. Details: `+TcHmi.Log.buildMessage(result.response.error)),void this.__loadingSpinner?.remove();if(result.response.commands&&this.__serverDomain)for(let i=0,ii=result.response.commands.length;i<ii;i++)if("ListDomains"===result.response.commands[i].symbol){let extensions=result.response.commands[i].readValue,scopeExtension=extensions&&extensions[this.__serverDomain],state=scopeExtension&&scopeExtension.state;if("Initialized"===state)null===this.__openConnectionRequestId&&this.__clearInit();else{this.__scopeConfigToFile=null,null!==this.__subscriptionIdMenubar&&(TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar),this.__subscriptionIdMenubar=null),null!==this.__subscriptionId&&(TcHmi.Server.unsubscribe(this.__subscriptionId),this.__subscriptionId=null),null!==this.__subscriptionIdActualWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow),this.__subscriptionIdActualWindow=null),null!==this.__subscriptionIdTriggerWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdTriggerWindow),this.__subscriptionIdTriggerWindow=null),null!==this.__subscriptionIdGetAllUploadedRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetAllUploadedRecords,null),this.__subscriptionIdGetAllUploadedRecords=null),null!==this.__subscriptionIdGetRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetRecords),this.__subscriptionIdGetRecords=null),null!==this.__subscriptionIdGetOwnUploadedRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetOwnUploadedRecords,null),this.__subscriptionIdGetOwnUploadedRecords=null),this.__clearFullControl(),this.__loadingSpinner?.remove();let status=state?` (Status: ${state})`:"",details=result.response.commands[i].error&&130!==result.response.commands[i].error.code?`Details: ${TcHmi.Log.buildMessage(result.response.commands[i].error)}`:"";TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Domain: ${this.__serverDomain} is not known${status}. Please make sure the server extension is loaded and the domain name is correct. ${details}`)}}}else this.__loadingSpinner?.remove(),result.error&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Framework error= ${result.error}, name=${TcHmi.Errors[result.error]} while fetching data from server. Details: `+TcHmi.Log.buildMessage(result.details))}}__scopeEventCallback(){return data=>{if(data.error||!data.event)return void TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error. Details: `+TcHmi.Log.buildMessage(data.details));const payloadResult=data.event;if("DOWNLOAD_COMPLETE"===payloadResult.name&&this.__scopeConfig&&this.__openConnection(),!TcHmi.Server.Events.isPayload(payloadResult)||!payloadResult.payload)return void TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error ${data.error}. Details: Event is possible null.`);const payload=payloadResult.payload;if(data.event&&"OPEN_CONNECTION_TO_FILE_SUCCESS"===data.event.name){if(this.__scopeConfigToFile){let writeValueData={controlName:this.__id,scopeConfig:this.__scopeConfigToFile},request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".GetMenubar",writeValue:writeValueData},{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".GetLegend",writeValue:writeValueData}]};TcHmi.Server.releaseRequest(this.__getMenubarRequestId),this.__getMenubarRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getMenubarCallback())}}else payload.severity===TcHmi.Server.Events.Severity.Info?TcHmi.Log.infoEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] ScopeExtension has thrown an information. Details: `+payload.message):payload.severity===TcHmi.Server.Events.Severity.Warning?TcHmi.Log.warnEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] ScopeExtension has thrown a warning. Details: `+payload.message):payload.severity===TcHmi.Server.Events.Severity.Error&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] ScopeExtension has thrown an error. Details: `+payload.message)}}__configEventCallback(){return data=>{if(data.error||!data.event)return void TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error ${data.error}. Details: ${TcHmi.Log.buildMessage(data.details)}`);const payloadResult=data.event;if("INIT_COMPLETE"===payloadResult.name)this.__extensionInitCompleted=!0,this.__scopeConfigLoaded&&this.__openConnection();else{if(!TcHmi.Server.Events.isPayload(payloadResult)||!payloadResult.payload)return void TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error ${data.error}. Details: Event is possible null.`);const payload=payloadResult.payload;if(payload.severity===TcHmi.Server.Events.Severity.Info)switch(null!==payload.oldConfigName?TcHmi.Log.infoEx(`[Source=Control, Module=${this.__type+(TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:"")}, Id=${this.getId()}] ScopeExtension has thrown an information. Details: ${payload.configType} from ${payload.oldConfigName} to ${payload.configName}`):TcHmi.Log.infoEx(`[Source=Control, Module=${this.__type+(TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:"")}, Id=${this.getId()}] ScopeExtension has thrown an information. Details: ${payload.configType} ${payload.configName}`),payload.configType){case TcHmiScopeControl_1.ConfigType.Add:case TcHmiScopeControl_1.ConfigType.Rename:this.__scopeConfig&&(payload.configName===this.__scopeConfig.name?(this.__scopeConfigLoaded=!0,this.__extensionInitCompleted&&this.__openConnection()):payload.oldConfigName===this.__scopeConfig.name&&(this.__scopeConfigLoaded=!1));break;case TcHmiScopeControl_1.ConfigType.Delete:this.__scopeConfig&&payload.configName===this.__scopeConfig.name&&(this.__scopeConfigLoaded=!1,this.__clearFullControl())}}}}__rebuild(){return(evt,ctrl)=>{if(this.__isAttached)if(this.__subscriptionIdMenubar)if(this.__menubar){let enableButtons=TcHmiScopeControl_1.ButtonsEnabled.None;this.__menubar.visibleToolstrip&&(enableButtons=this.__menubar.enabledButtons);let enableTimes=TcHmiScopeControl_1.TimesEnabled.None;this.__menubar.visibleTimestrip&&(enableTimes=this.__menubar.enabledTimeLabels),this.__createMenuButtons(enableButtons,enableTimes),this.__calcMenuButtons(),this.__menubar.visibleToolstrip?0===this.__menubar.enabledButtons?TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","flex"):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"),this.__menubar.visibleTimestrip?0===this.__menubar.enabledTimeLabels?TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none"):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","flex"):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none"),this.__serverSymbolsHelper.setChartSize(!0)}else this.__createMenuButtons(TcHmiScopeControl_1.ButtonsEnabled.None,TcHmiScopeControl_1.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none");else this.__createMenuButtons(TcHmiScopeControl_1.ButtonsEnabled.None,TcHmiScopeControl_1.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none");else this.__drawLineChart()}}__openWebsocket(){TCHMI_DESIGNER||null===this.__openConnectionRequestId&&(this.__scopeIsInitialized?this.__openConnection():null===this.__initEventDestroyEvent&&(this.__initEventDestroyEvent=TcHmi.EventProvider.register(this.__id+".onInitChanged",this.__initChanged())))}__openConnection(){if(!TCHMI_DESIGNER&&this.__isAttached&&this.__scopeIsInitialized&&this.__extensionInitCompleted&&null===this.__openConnectionRequestId){null!==this.__subscriptionIdMenubar&&(TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar),this.__subscriptionIdMenubar=null),null!==this.__subscriptionId&&(TcHmi.Server.unsubscribe(this.__subscriptionId),this.__subscriptionId=null),null!==this.__subscriptionIdActualWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow),this.__subscriptionIdActualWindow=null),null!==this.__subscriptionIdTriggerWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdTriggerWindow),this.__subscriptionIdTriggerWindow=null),null!==this.__subscriptionIdGetRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetRecords),this.__subscriptionIdGetRecords=null);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".OpenConnection",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),TcHmi.Server.releaseRequest(this.__openConnectionRequestId),this.__openConnectionRequestId=TcHmi.Server.requestEx(request,null,this.__connectionCallback())}}__clearFullControl(){this.__createMenuButtons(TcHmiScopeControl_1.ButtonsEnabled.None,TcHmiScopeControl_1.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none"),this.__createLegend(void 0),this.__datagrid&&this.__datagrid.setSrcData(null);const passiveEventOptions={passive:!0,capture:!1},activeEventOptions={passive:!1,capture:!1};for(let i=0,ii=this.__lineCharts.length;i<ii;i++){let canvas=this.__lineCharts[i].getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,activeEventOptions),canvas.removeEventListener("wheel",this.__mousewheelHandler,activeEventOptions)),this.__lineCharts[i].remove(),this.__chartingElements[i].remove()}if(this.__lineCharts=[],this.__chartingElements=[],this.__dialog?.closeChartsDialog(),this.__dialog?.hide(),this.__timeRangeDialog&&this.__timeRangeDialog.hide(),this.__overviewChart){let canvas=this.__overviewChart.getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),canvas.removeEventListener("mousemove",this.__mousemoveOverviewHandler,passiveEventOptions),canvas.removeEventListener("mouseup",this.__mouseupOverviewHandler,passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,activeEventOptions)),this.__overviewChart.remove(),this.__overviewChart=null}this.__elementOverview.css({display:"none"}),this.__elementChartName.css("display","none"),this.__elementChartings.css({"background-color":"","background-image":""}),this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart").remove();const canvasBorderElem=this.__elementBorder[0];let contextBorderElem=canvasBorderElem.getContext("2d");contextBorderElem?.clearRect(0,0,canvasBorderElem.width,canvasBorderElem.height),this.__resizeLines=[],this.__sessionId=null,this.__socketId=null,this.__extensionInitCompleted=!1,this.__scopeConfigLoaded=!1}__connectionCallback(){return result=>{if(!this.__isDestroyed&&null!==this.__openConnectionRequestId)if(this.__openConnectionRequestId=null,result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error. Details: `+TcHmi.Log.buildMessage(result.response.error)),void this.__loadingSpinner?.remove();if(result.response.commands)for(let i=0,ii=result.response.commands.length;i<ii;i++){if(result.response.commands[i].error&&130!==result.response.commands[i].error.code)return TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with for command for symbol=${result.response.commands[i].symbol}. Details: `+TcHmi.Log.buildMessage(result.response.commands[i].error)),this.__loadingSpinner?.remove(),void this.__clearFullControl();result.response.commands[i].symbol===this.__serverDomain+".OpenConnection"&&(this.__resubscribeMenubar(),this.__showTriggerWindow&&this.__unsubscribeTriggerWindow())}}else this.__loadingSpinner?.remove(),result.error&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Framwork error=${result.error}, name=${TcHmi.Errors[result.error]} while fetching data from server.`)}}__setChartSizeCallback(){return result=>{if(!this.__isDestroyed&&null!==this.__setChartSizeRequestId)if(this.__setChartSizeRequestId=null,result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error. Details: `+TcHmi.Log.buildMessage(result.response.error)),void this.__loadingSpinner?.remove();if(result.response.commands)for(let i=0,ii=result.response.commands.length;i<ii;i++)result.response.commands[i].error&&(TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error for command for symol=${result.response.commands[i].symbol}. Details: `+TcHmi.Log.buildMessage(result.response.commands[i].error)),this.__loadingSpinner?.remove()),result.response.commands[i].symbol===this.__serverDomain+".SetChartSize"&&(this.__loadingSpinner?.remove(),this.__resubscribe())}else this.__loadingSpinner?.remove(),result.error&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Framework error=${result.error}, name=${TcHmi.Errors[result.error]} while fetching data from server. Details: `+TcHmi.Log.buildMessage(result.details))}}__resubscribeMenubar(){null!==this.__subscriptionIdMenubar?TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar,this.__resubscribeMenubarCallback()):this.__subscribeMenubar()}__resubscribeMenubarCallback(){return result=>{this.__subscriptionIdMenubar=null,this.__subscribeMenubar()}}__subscribeMenubar(){if(this.__subscriptionIdMenubar=null,this.__isAttached&&this.__scopeConfig){let symbolMenubar=this.__serverDomain+".GetMenubar",symbolLegend=this.__serverDomain+".GetLegend",writeValue={controlName:this.__id,scopeConfig:this.__scopeConfig},writeValueLegend={controlName:this.__id,scopeConfig:this.__scopeConfig,activeLegendElements:this.__activeLegendElements};this.__showLegend?this.__subscriptionIdMenubar=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolMenubar,writeValue:writeValue},{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolLegend,writeValue:writeValueLegend}],300,this.__getMenubarCallback()):this.__subscriptionIdMenubar=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolMenubar,writeValue:writeValue}],300,this.__getMenubarCallback())}}__unsubscribeTriggerWindow(){null!==this.__subscriptionIdTriggerWindow?TcHmi.Server.unsubscribe(this.__subscriptionIdTriggerWindow,this.__resubscribeTriggerWindowCallback()):this.__subscribeTriggerWindow()}__resubscribeTriggerWindowCallback(){return result=>{this.__subscriptionIdTriggerWindow=null,this.__subscribeTriggerWindow()}}__subscribeTriggerWindow(){if(this.__subscriptionIdTriggerWindow=null,this.__isAttached&&this.__scopeConfig){let writeValue,symbolTriggerWindow=this.__serverDomain+".GetTriggerWindow";writeValue={controlName:this.__id,scopeConfig:this.__scopeConfig},this.__subscriptionIdTriggerWindow=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolTriggerWindow,writeValue:writeValue}],300,this.__getDataCallback())}}__getMenubarCallback(){return result=>{if(!this.__isDestroyed)if(result&&result.error===TcHmi.Errors.NONE&&result.response&&(result.response.id===this.__subscriptionIdMenubar||result.response.id===this.__getMenubarRequestId)){if(result.response.id===this.__getMenubarRequestId&&(this.__getMenubarRequestId=null),result.response.error)return TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error. Details: `+TcHmi.Log.buildMessage(result.response.error)),this.__loadingSpinner?.remove(),this.__createMenuButtons(TcHmiScopeControl_1.ButtonsEnabled.None,TcHmiScopeControl_1.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none"),void this.__createLegend(void 0);if(result.response.commands&&void 0!==this.__subscriptionIdMenubar){for(let i=0,ii=result.response.commands.length;i<ii;i++){if(result.response.commands[i].error)return 130!==result.response.commands[i].error.code&&(TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: `+TcHmi.Log.buildMessage(result.response.commands[i].error)),this.__loadingSpinner?.remove()),this.__createMenuButtons(TcHmiScopeControl_1.ButtonsEnabled.None,TcHmiScopeControl_1.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none"),void this.__createLegend(void 0);if(result.response.commands[i].readValue)if(result.response.commands[i].symbol===this.__serverDomain+".GetMenubar"){if(this.__menubar=result.response.commands[i].readValue,this.__menubar){let enableButtons=TcHmiScopeControl_1.ButtonsEnabled.None;this.__menubar.visibleToolstrip&&(enableButtons=this.__menubar.enabledButtons);let enableTimes=TcHmiScopeControl_1.TimesEnabled.None;this.__menubar.visibleTimestrip&&(enableTimes=this.__menubar.enabledTimeLabels),this.__createMenuButtons(enableButtons,enableTimes),this.__calcMenuButtons(),this.__menubar.visibleToolstrip?0===this.__menubar.enabledButtons?TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","flex"):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"),this.__menubar.visibleTimestrip?0===this.__menubar.enabledTimeLabels?TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none"):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","flex"):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none")}}else result.response.commands[i].symbol===this.__serverDomain+".GetLegend"&&(this.__legend=result.response.commands[i].readValue,this.__createLegend(this.__legend))}this.__serverSymbolsHelper.setChartSize(!1)}}else this.__loadingSpinner?.remove(),result.error&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Framework error=${result.error}, name=${TcHmi.Errors[result.error]} while fetching data from server. Details: `+TcHmi.Log.buildMessage(result.details))}}__resubscribe(changedServerInterval=!1){null!==this.__subscriptionId?TcHmi.Server.unsubscribe(this.__subscriptionId,this.__resubscribeGetDataCallback()):this.__subscribeGetData(),changedServerInterval||(null!==this.__subscriptionIdActualWindow?TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow,this.__resubscribeActualWindowCallback()):this.__subscribeActualWindow())}__resubscribeGetDataCallback(){return result=>{this.__subscriptionId=null,this.__subscribeGetData()}}__subscribeGetData(){if(this.__isAttached&&this.__scopeConfig&&this.__serverInterval){let writeValueData,symbolData=this.__serverDomain+".GetData",symbolWindow=this.__serverDomain+".GetWindow",symbolLayout=this.__serverDomain+".GetLayout";writeValueData={controlName:this.__id,scopeConfig:this.__scopeConfig},TcHmi.Server.releaseRequest(this.__subscriptionId),this.__subscriptionId=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolLayout,writeValue:writeValueData},{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolData,writeValue:writeValueData},{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolWindow,writeValue:writeValueData}],this.__serverInterval,this.__getDataCallback())}}__resubscribeActualWindowCallback(){return result=>{this.__subscriptionIdActualWindow=null,this.__subscribeActualWindow()}}__subscribeActualWindow(){if(this.__isAttached&&this.__scopeConfig){let writeValueData;writeValueData={controlName:this.__id,scopeConfig:this.__scopeConfig},this.__subscriptionIdActualWindow=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:this.__serverDomain+".GetActualWindow",writeValue:writeValueData}],300,this.__getDataCallback())}}__getDataCallback(){return result=>{if(!this.__isDestroyed)if(this.__loadingSpinner?.remove(),result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return void TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error. Details: `+TcHmi.Log.buildMessage(result.response.error));if(result.response.commands&&void 0!==this.__subscriptionId)for(let i=0,ii=result.response.commands.length;i<ii;i++){if(result.response.commands[i].error){if(31===result.response.commands[i].error.code)return void this.__openWebsocket();130!==result.response.commands[i].error.code&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: `+TcHmi.Log.buildMessage(result.response.commands[i].error))}if(result.response.commands[i].symbol===this.__serverDomain+".GetLayout"&&(result.response.id===this.__subscriptionId&&!this.__scopeConfigToFile||result.response.id===this.__getDataRequestId&&this.__scopeConfigToFile)){const chartType=this.__scopeLayout?.chartType??null;let drawOnlyOverview=!1,newLayout=result.response.commands[i].readValue;if(newLayout&&this.__scopeLayout&&newLayout.charts&&this.__scopeLayout.charts&&JSON.stringify(newLayout.charts)===JSON.stringify(this.__scopeLayout.charts)&&(drawOnlyOverview=!0),this.__scopeLayout&&this.__scopeLayout.chartType!==chartType&&(this.__mouseMode=TcHmiScopeControl_1.MouseMode.None),drawOnlyOverview&&this.__manipulationInfo.isManipulating&&-1===this.__manipulationInfo.elementIndex&&this.__overviewChart&&this.__scopeLayout&&this.__scopeLayout.overview&&this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect){const canvas=this.__overviewChart.getCanvasZooming();let context=canvas.getContext("2d");if(null===context)return;let canvasWidth=canvas.width/window.devicePixelRatio,canvasHeight=canvas.height/window.devicePixelRatio,width=this.__manipulationInfo.end.x-this.__manipulationInfo.start.x;if(this.__manipulationInfo.isOverviewSizeChanged)if(this.__manipulationInfo.beginOverviewRectChanging){let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width-width;newWidth<5&&(newWidth=5),context.clearRect(0,0,canvasWidth,canvasHeight),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+width,this.__scopeLayout.overview.canvas.position.y,newWidth,this.__scopeGraphWindow.overviewRect.dimensions.height)}else{let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width+width;newWidth<5&&(newWidth=5),context.clearRect(0,0,canvasWidth,canvasHeight),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x,this.__scopeLayout.overview.canvas.position.y,newWidth,this.__scopeGraphWindow.overviewRect.dimensions.height)}else context.clearRect(0,0,canvasWidth,canvasHeight),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+width,this.__scopeLayout.overview.canvas.position.y,this.__scopeGraphWindow.overviewRect.dimensions.width,this.__scopeGraphWindow.overviewRect.dimensions.height)}else this.__scopeLayout=result.response.commands[i].readValue,this.__drawLineChart(drawOnlyOverview);this.__scopeGraphWindow&&this.__scopeLayout?this.__enableOrDisableMenuControls(this.__scopeGraphWindow.scopeState,this.__scopeGraphWindow.liveState,this.__scopeGraphWindow.undo,this.__scopeGraphWindow.redo,TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]):this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT)}else if(result.response.commands[i].symbol===this.__serverDomain+".GetWindow"&&(result.response.id===this.__subscriptionId&&!this.__scopeConfigToFile||result.response.id===this.__getDataRequestId&&this.__scopeConfigToFile)){if(this.__manipulationInfo.isManipulating&&-1===this.__manipulationInfo.elementIndex)return;if(this.__scopeGraphWindow=result.response.commands[i].readValue,this.__updatedMenuValues(this.__scopeGraphWindow),this.__scopeGraphWindow&&this.__scopeLayout?this.__enableOrDisableMenuControls(this.__scopeGraphWindow.scopeState,this.__scopeGraphWindow.liveState,this.__scopeGraphWindow.undo,this.__scopeGraphWindow.redo,TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]):this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect&&this.__scopeLayout&&this.__scopeLayout.overview&&this.__overviewChart){if(this.__manipulationInfo.isManipulating&&-1===this.__manipulationInfo.elementIndex)break;const canvas=this.__overviewChart.getCanvasZooming();let context=canvas.getContext("2d");if(context){let canvasWidth=canvas.width/window.devicePixelRatio,canvasHeight=canvas.height/window.devicePixelRatio;context.clearRect(0,0,canvasWidth,canvasHeight),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x,this.__scopeLayout.overview.canvas.position.y,this.__scopeGraphWindow.overviewRect.dimensions.width,this.__scopeGraphWindow.overviewRect.dimensions.height)}if(this.__scopeLayout&&this.__scopeLayout.overview){let offsetTop=this.__scopeLayout.overview.canvas.position.y,offsetLeft=this.__scopeLayout.overview.canvas.position.x;this.__overviewRectangle={position:{x:offsetLeft+this.__scopeGraphWindow.overviewRect.position.x,y:offsetTop},dimensions:{width:this.__scopeGraphWindow.overviewRect.dimensions.width,height:this.__scopeGraphWindow.overviewRect.dimensions.height}}}}}else if(result.response.commands[i].symbol===this.__serverDomain+".GetData"&&(result.response.id===this.__subscriptionId&&!this.__scopeConfigToFile||result.response.id===this.__getDataRequestId&&this.__scopeConfigToFile)){if(result.response.id===this.__getDataRequestId&&(this.__getDataRequestId=null),this.__manipulationInfo.isManipulating&&-1===this.__manipulationInfo.elementIndex)return;if(null===this.__startRecordRequestId&&null===this.__startRequestId&&null===this.__stopRecordRequestId&&null===this.__stopRequestId&&null===this.__zoomRequestId&&null===this.__panRequestId&&null===this.__wheelRequestId&&null===this.__zoomOutRequestId&&null===this.__unzoomRequestId&&null===this.__displayWidthRequestId&&null===this.__gotoRequestId&&null===this.__scrollRequestId&&null===this.__scrollBigRequestId&&null===this.__undoRequestId&&null===this.__redoRequestId&&null===this.__setOverviewModeRequestId&&null===this.__setOverviewRectRequestId&&null===this.__getTooltipRequestId&&null===this.__resizeChartsRequestId&&null===this.__changeChannelStateRequestId&&null===this.__setTriggerCommentRequestId&&null===this.__clickOverviewElementRequestId&&(this.__scopeGraphData=result.response.commands[i].readValue,this.__scopeGraphData&&this.__lineCharts&&this.__lineCharts.length>0&&this.__scopeLayout&&this.__lineCharts.length===this.__scopeLayout.charts.length)){if(this.__scopeLayout.overview){let overviewData=this.__scopeGraphData.overview;if(overviewData&&this.__overviewChart){if(overviewData.graphs)for(let graphKey in overviewData.graphs){let graph=overviewData.graphs[graphKey];if(graph&&this.__overviewChart){let overviewGraph=this.__overviewChart.getLineGraphWithName(graphKey);overviewGraph&&overviewGraph.setPoints(graph.axesData)}}if(this.__overviewChart&&(this.__overviewChart.deleteAllTriggers(),overviewData.trigger))for(let e=0,ee=overviewData.trigger.length;e<ee;e++)this.__overviewChart.addTrigger(overviewData.trigger[e])}}for(let i=0,ii=this.__scopeGraphData.charts.length;i<ii;i++){let chartData=this.__scopeGraphData.charts[i],chart=this.__lineCharts[i];if(chart&&chartData){if(chart.deleteAllTriggers(),chartData.trigger)for(let e=0,ee=chartData.trigger.length;e<ee;e++)chart.addTrigger(chartData.trigger[e]);if(chart.deleteAllXYTriggers(),chartData.xyTrigger)for(let e=0,ee=chartData.xyTrigger.length;e<ee;e++)chart.addXYTrigger(chartData.xyTrigger[e]);if(chartData.graphs)for(let chartGraphKey in chartData.graphs){let graph=chartData.graphs[chartGraphKey];if(graph){let lineGraph=chart.getLineGraphWithName(chartGraphKey);lineGraph&&(lineGraph.setPoints(graph.axesData),lineGraph.setZeroPoint(graph.zeroPoint),lineGraph.setLineSeries(graph.lineSeries))}}}}for(let i=0,ii=this.__lineCharts.length;i<ii;i++)this.__lineCharts[i].setLineChanged(!0),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__lineCharts[i].draw(this.__scopeLayout.charts[i],null):this.__lineCharts[i].draw(this.__scopeLayout.charts[i],this.__themeCanvasBackgroundColor);this.__overviewChart&&this.__scopeLayout.overview&&(this.__overviewChart.setLineChanged(!0),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__overviewChart.draw(this.__scopeLayout.overview,null):this.__overviewChart.draw(this.__scopeLayout.overview,this.__themeCanvasBackgroundColor))}}else if(result.response.commands[i].symbol===this.__serverDomain+".StartRecord")this.__startRecordRequestId=null,this.__scopeConfigToFile||this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".StartDisplay")this.__startRequestId=null,this.__scopeConfigToFile||this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".StopRecord")this.__stopRecordRequestId=null,this.__scopeConfigToFile||this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".StopDisplay")this.__stopRequestId=null,this.__scopeConfigToFile||this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".Zoom")this.__zoomRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".Pan")this.__panRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".Wheel")this.__wheelRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".ZoomOutMax")this.__zoomOutRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".ZoomToDefault")this.__unzoomRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".SetDisplayWidth")this.__displayWidthRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".Goto")this.__gotoRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".Scroll")this.__scrollRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".ScrollBig")this.__scrollBigRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".Undo")this.__undoRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".Redo")this.__redoRequestId=null,this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".SetOverviewMode")this.__setOverviewModeRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".SetOverviewRect")this.__setOverviewRectRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".GetTooltip"){this.__getTooltipRequestId=null;let readValue=result.response.commands[i].readValue;readValue.displayText&&readValue.timeoutMS?(this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!1},this.__showTooltip(readValue),this.__scopeGraphWindow&&this.__scopeLayout?this.__enableOrDisableMenuControls(this.__scopeGraphWindow.scopeState,this.__scopeGraphWindow.liveState,this.__scopeGraphWindow.undo,this.__scopeGraphWindow.redo,TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]):this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT)):this.__userInteractionStart(this.__manipulationInfo.mousePosition.x,this.__manipulationInfo.mousePosition.y,result.response.commands[i].writeValue.chartIndex)}else if(result.response.commands[i].symbol===this.__serverDomain+".ResizeCharts")this.__resizeChartsRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".ChangeChannelState")this.__changeChannelStateRequestId=null,this.__scopeConfigToFile?this.__serverSymbolsHelper.__getDataAsRequest():this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".SetTriggerComment")this.__setTriggerCommentRequestId=null,this.__resubscribe();else if(result.response.commands[i].symbol===this.__serverDomain+".SaveCurrentRecord")if(this.__saveCurrentRecordRequestId=null,result.response.commands[i].error){const errorMessage=result.response.commands[i].error?.reason??result.response.commands[i].error?.message??result.response.commands[i].error?.code?.toString()??"";this.__dialog&&(this.__createErrorDialog("%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_SaveCurrentRecord%/l%",errorMessage),this.__dialog.setIsWaitingForServer(!1),this.__dialog.enableAllButtons())}else this.__dialog?.setIsWaitingForServer(!1),this.__dialog?.enableAllButtons();else if(result.response.commands[i].symbol!==this.__serverDomain+".GetActualWindow"||result.response.id!==this.__subscriptionIdActualWindow||this.__scopeConfigToFile)if(result.response.commands[i].symbol===this.__serverDomain+".GetTriggerWindow"&&(result.response.id===this.__subscriptionIdTriggerWindow&&!this.__scopeConfigToFile||result.response.id===this.__getDataRequestId&&this.__scopeConfigToFile)){if(this.__triggerWindow=result.response.commands[i].readValue,this.__datagrid){let updatedTriggerWindow=this.__triggerWindow;if(updatedTriggerWindow)for(let k=0,kk=updatedTriggerWindow.length;k<kk;k++){const dateSplitted=TcHmi.Localization.parseDate(new Date(updatedTriggerWindow[k].releaseTime));updatedTriggerWindow[k].releaseTime=("00"+dateSplitted.hour).slice(-2)+":"+("00"+dateSplitted.minute).slice(-2)+":"+("00"+dateSplitted.second).slice(-2)+","+("000"+dateSplitted.millisecond).slice(-3)}this.__datagrid.setSrcData(this.__triggerWindow)}}else if(result.response.commands[i].symbol===this.__serverDomain+".DeleteScopeRecord")if(this.__deleteScopeRecordRequestId=null,result.response.commands[i].error){const errorMessage=result.response.commands[i].error?.reason??result.response.commands[i].error?.message??result.response.commands[i].error?.code?.toString()??"";this.__dialog&&(this.__createErrorDialog("%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_DeleteScopeRecord%/l%",errorMessage),this.__dialog.setIsWaitingForServer(!1),this.__dialog.enableAllButtons())}else this.__dialog?.setIsWaitingForServer(!1),this.__dialog?.enableAllButtons();else if(result.response.commands[i].symbol===this.__serverDomain+".ChangePersist"){if(this.__changePersistRequestId=null,result.response.commands[i].error){const errorMessage=result.response.commands[i].error?.reason??result.response.commands[i].error?.message??result.response.commands[i].error?.code?.toString()??"";this.__dialog&&this.__createErrorDialog("%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_ChangePersist%/l%",errorMessage)}}else if(result.response.commands[i].symbol===this.__serverDomain+".GetChartList"){if(this.__getChartListRequestId=null,result.response.commands[i].error&&this.__dialog){const errorMessage=result.response.commands[i].error?.reason??result.response.commands[i].error?.message??result.response.commands[i].error?.code.toString()??"";this.__createErrorDialog("%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_GetChartList%/l%",errorMessage)}else if(this.__dialog){let chartNames=result.response.commands[i].readValue;this.__dialog.addChartsToCombobox(chartNames),this.__dialog.showChartsDialog()}}else if(result.response.commands[i].symbol===this.__serverDomain+".OpenConnectionToFile")if(this.__openConnectionToFileRequestId=null,result.response.commands[i].error&&130!==result.response.commands[i].error.code&&this.__dialog){const errorMessage=result.response.commands[i].error?.reason??result.response.commands[i].error?.message??result.response.commands[i].error?.code?.toString()??"";this.__createErrorDialog("%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_OpenConnectionToFile%/l%",errorMessage),this.__dialog.setAttachedGuid(null),this.__dialog.closeChartsDialog()}else this.__dialog&&(this.__clearFullControl(),this.__scopeLayout=void 0,this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__scopeConfigToFile=result.response.commands[i].readValue);else result.response.commands[i].symbol===this.__serverDomain+".SetChartSize"?(this.__setChartSizeRequestId=null,this.__scopeConfigToFile&&this.__serverSymbolsHelper.__getDataAsRequest()):result.response.commands[i].symbol===this.__serverDomain+".CloseConnection"?(this.__closeConnectionRequestId=null,this.__scopeConfigToFile=null,this.__dialog?.setAttachedGuid(null),this.__scopeConfig&&this.__resubscribeMenubar()):result.response.commands[i].symbol===this.__serverDomain+".ClickOverviewElement"?(this.__clickOverviewElementRequestId=null,this.__resubscribe()):result.response.commands[i].symbol===this.__serverDomain+".GetAnalyticsData"?(this.__getAnalyticsDataRequestId=null,result.response.commands[i].error&&130===result.response.commands[i].error.code?(null!==this.__subscriptionIdGetRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetRecords,null),this.__subscriptionIdGetRecords=null),this.__subscriptionIdGetRecords=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:this.__serverDomain+".GetRecords",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}],300,this.__getDataCallback())):this.__timeRangeDialog&&this.__timeRangeDialog.addData([])):result.response.commands[i].symbol===this.__serverDomain+".GetRecords"?void 0===result.response.commands[i].error?(null!==this.__subscriptionIdGetRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetRecords,null),this.__subscriptionIdGetRecords=null),this.__timeRangeDialog&&this.__timeRangeDialog.addData(result.response.commands[i].readValue)):130!==result.response.commands[i].error.code&&(null!==this.__subscriptionIdGetRecords&&(TcHmi.Server.unsubscribe(this.__subscriptionIdGetRecords,null),this.__subscriptionIdGetRecords=null),this.__timeRangeDialog&&this.__timeRangeDialog.addData([])):result.response.commands[i].symbol===this.__serverDomain+".SetAnalyticsRecord"&&(this.__setAnalyticsRecordRequestId=null,this.__serverSymbolsHelper.startRecord(),this.__resubscribe(),this.__timeRangeDialog&&this.__timeRangeDialog.hide());else{let actualWindow=result.response.commands[i].readValue;if(this.__scopeLayout&&actualWindow?this.__enableOrDisableMenuControls(actualWindow.scopeState,actualWindow.liveState,actualWindow.undo,actualWindow.redo,TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]):this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),this.__scopeGraphWindow){let windowData=this.__scopeGraphWindow;actualWindow&&(windowData.liveState=actualWindow.liveState,windowData.displayWidth=actualWindow.displayWidth,windowData.redo=actualWindow.redo,windowData.scopeState=actualWindow.scopeState,windowData.undo=actualWindow.undo,windowData.xAxisEnd=actualWindow.xAxisEnd,windowData.xAxisStart=actualWindow.xAxisStart),this.__updatedMenuValues(windowData)}else this.__updatedMenuValues(null)}}}else result.error&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}] Framework error=${result.error}, name=${TcHmi.Errors[result.error]} while fetching data from server. Details: `+TcHmi.Log.buildMessage(result.details))}}__createErrorDialog(symbol,errorMessage=null){null===this.__errorPrompt&&(this.__errorPrompt=new Controls.Helpers.TextAndButtonsPrompt({ok:{value:void 0,attributes:{"data-tchmi-width":60,"data-tchmi-height":30,"data-tchmi-text":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Button_Text_OK%/l%"}}},this),this.__errorPrompt.setBackgroundAction({close:!0,action:"ok"})),errorMessage?this.__errorPrompt.setLocalizations({headerText:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Header_Error%/l%",contentText:{symbolExpression:symbol,formatValues:[errorMessage]}}):this.__errorPrompt.setLocalizations({headerText:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Header_Error%/l%",contentText:symbol}),this.__errorPrompt.prompt()}__drawLineChart(drawOnlyOverview=!1){const canvasBorderElem=this.__elementBorder[0],passiveEventOptions={passive:!0,capture:!1},activeEventOptions={passive:!1,capture:!1};if(this.__scopeLayout&&this.__scopeLayout.charts){if(!drawOnlyOverview){if(this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!1},this.__mouseMode===TcHmiScopeControl_1.MouseMode.None)switch(TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]){case TcHmiScopeControl_1.ChartType.SingleBarChart:this.__serverSymbolsHelper.setMouseMode(TcHmiScopeControl_1.MouseMode.PanY);break;case TcHmiScopeControl_1.ChartType.YT:case TcHmiScopeControl_1.ChartType.XY:case TcHmiScopeControl_1.ChartType.ArrayBarChart:default:this.__serverSymbolsHelper.setMouseMode(TcHmiScopeControl_1.MouseMode.PanXY)}let chartLength=this.__scopeLayout.charts.length;if(chartLength>this.__lineCharts.length)for(let i=this.__lineCharts.length,ii=chartLength;i<ii;i++){let newChart=$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart"></div>');this.__elementBorder.before(newChart),this.__chartingElements.push(newChart),this.__lineCharts.push(new Beckhoff.TcHmiScopeControl.Charting.ScopeChart(newChart,this.__scopeLayout.charts[i].dimensions.width,this.__scopeLayout.charts[i].dimensions.height));let canvas=this.__lineCharts[i].getCanvasZooming();canvas&&(canvas.addEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),canvas.addEventListener("touchstart",this.__touchstartHandler,activeEventOptions),canvas.addEventListener("wheel",this.__mousewheelHandler,activeEventOptions))}else if(chartLength<this.__lineCharts.length)for(let i=this.__lineCharts.length-1,ii=chartLength-1;i>=ii;i--)if(i>=chartLength){let canvas=this.__lineCharts[i].getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,activeEventOptions),canvas.removeEventListener("wheel",this.__mousewheelHandler,activeEventOptions)),this.__lineCharts[i].remove(),this.__lineCharts.splice(i,1),this.__chartingElements[i].remove(),this.__chartingElements.splice(i,1)}this.__resizeLines=[];let heightObjectsBeforeCharts=0;this.__scopeLayout.overview&&(heightObjectsBeforeCharts+=this.__scopeLayout.overview.dimensions.height+5);let width=this.__elementChartings.innerWidth(),height=this.__elementChartings.innerHeight();this.__elementBorder.attr("width",width).attr("height",height);let contextBorderElem=canvasBorderElem.getContext("2d");contextBorderElem&&(contextBorderElem.clearRect(0,0,canvasBorderElem.width,canvasBorderElem.height),this.__themeChartForegroundColor&&this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.Theme?contextBorderElem.strokeStyle=this.__themeChartForegroundColor:contextBorderElem.strokeStyle=this.__scopeLayout.foregroundColor,contextBorderElem.lineWidth=1,contextBorderElem.beginPath());let headlineHeight=0;this.__scopeLayout.headline?(this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__elementChartName.css({display:"block","font-size":this.__scopeLayout.headline.fontSize+"pt",color:this.__scopeLayout.headline.color,width:this.__scopeLayout.headline.dimensions.width,height:this.__scopeLayout.headline.dimensions.height,top:heightObjectsBeforeCharts+"px","border-bottom":"1px solid "+this.__scopeLayout.foregroundColor}):this.__elementChartName.css({display:"block","font-size":this.__scopeLayout.headline.fontSize+"pt",color:null!==this.__themeChartForegroundColor?this.__themeChartForegroundColor:this.__scopeLayout.headline.color,width:this.__scopeLayout.headline.dimensions.width,height:this.__scopeLayout.headline.dimensions.height,top:heightObjectsBeforeCharts+"px","border-bottom":"1px solid "+this.__themeChartForegroundColor}),this.__elementChartName[0].textContent=this.__scopeLayout.headline.label,headlineHeight=this.__scopeLayout.headline.dimensions.height):this.__elementChartName.css("display","none"),this.__themeChartBackgroundColor&&this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.Theme?this.__elementChartings.css({"background-color":this.__themeChartBackgroundColor,"background-image":""}):this.__scopeLayout.gradientBackground?this.__elementChartings.css({"background-image":"linear-gradient("+this.__scopeLayout.backgroundColor+", "+this.__scopeLayout.gradientBackgroundColor+")","background-color":""}):this.__elementChartings.css({"background-color":this.__scopeLayout.backgroundColor,"background-image":""});let beginHorizontalLineY=0;this.__scopeLayout.headline&&(beginHorizontalLineY=this.__scopeLayout.headline.dimensions.height);for(let i=0,ii=this.__scopeLayout.charts.length;i<ii;i++)if(this.__scopeLayout.charts[i].visible){if(contextBorderElem){let startPointHorizontal={x:0,y:(heightObjectsBeforeCharts+this.__scopeLayout.charts[i].position.y|0)-.5},endPointHorizontal={x:0|canvasBorderElem.width,y:(heightObjectsBeforeCharts+this.__scopeLayout.charts[i].position.y|0)-.5},lineWasDrawHorizontal=this.__resizeLines.some((elem=>elem.startPoint.y===startPointHorizontal.y));this.__scopeLayout.charts[i].position.y===beginHorizontalLineY||lineWasDrawHorizontal||(contextBorderElem.moveTo(startPointHorizontal.x,startPointHorizontal.y),contextBorderElem.lineTo(endPointHorizontal.x,endPointHorizontal.y),this.__resizeLines.push({orientation:TcHmiScopeControl_1.Orientation.Horizontal,startPoint:startPointHorizontal,endPoint:endPointHorizontal,chartIndex:i}));let startPointVertical={x:(this.__scopeLayout.charts[i].position.x+this.__scopeLayout.charts[i].dimensions.width|0)-.5,y:heightObjectsBeforeCharts+headlineHeight|0},endPointVertical={x:(this.__scopeLayout.charts[i].position.x+this.__scopeLayout.charts[i].dimensions.width|0)-.5,y:0|canvasBorderElem.height},lineWasDrawVertical=this.__resizeLines.some((elem=>elem.startPoint.x===startPointVertical.x));TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]!==TcHmiScopeControl_1.ChartType.SingleBarChart||lineWasDrawVertical||(contextBorderElem.moveTo(startPointVertical.x,startPointVertical.y),contextBorderElem.lineTo(endPointVertical.x,endPointVertical.y),this.__resizeLines.push({orientation:TcHmiScopeControl_1.Orientation.Vertical,startPoint:startPointVertical,endPoint:endPointVertical,chartIndex:i}))}this.__lineCharts[i].clear(this.__scopeLayout.charts[i].dimensions.width,this.__scopeLayout.charts[i].dimensions.height);let axisGroupForegroundColor="";this.__themeAxisGroupForegroundColor&&this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.Theme?axisGroupForegroundColor=this.__themeAxisGroupForegroundColor:this.__scopeLayout.charts[i].headline&&this.__scopeLayout.charts[i].headline.color&&(axisGroupForegroundColor=this.__scopeLayout.charts[i].headline.color),this.__lineCharts[i].setAxisGroupForegroundColor(axisGroupForegroundColor),this.__chartingElements[i].css({width:this.__scopeLayout.charts[i].dimensions.width+"px",height:this.__scopeLayout.charts[i].dimensions.height+"px",left:this.__scopeLayout.charts[i].position.x,top:heightObjectsBeforeCharts+this.__scopeLayout.charts[i].position.y});let chart=this.__scopeLayout.charts[i];for(let j=0,jj=chart.verticalAxis.length;j<jj;j++)chart.verticalAxis[j].visible&&(this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__lineCharts[i].addYAxis(chart.verticalAxis[j],null,null):this.__lineCharts[i].addYAxis(chart.verticalAxis[j],this.__themeAxisColor,this.__themeAxisColor)),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__lineCharts[i].addGrid(null,chart.verticalAxis[j],chart.gridSize,null):this.__lineCharts[i].addGrid(null,chart.verticalAxis[j],chart.gridSize,this.__themeGridColor),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__lineCharts[i].addSubgrid(null,chart.verticalAxis[j],chart.gridSize,null):this.__lineCharts[i].addSubgrid(null,chart.verticalAxis[j],chart.gridSize,this.__themeGridColor);for(let j=0,jj=chart.horizontalAxis.length;j<jj;j++)chart.horizontalAxis[j].visible&&(this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__lineCharts[i].addXAxis(chart.horizontalAxis[j],null,null):this.__lineCharts[i].addXAxis(chart.horizontalAxis[j],this.__themeAxisColor,this.__themeAxisColor)),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__lineCharts[i].addGrid(chart.horizontalAxis[j],null,chart.gridSize,null):this.__lineCharts[i].addGrid(chart.horizontalAxis[j],null,chart.gridSize,this.__themeGridColor),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__lineCharts[i].addSubgrid(chart.horizontalAxis[j],null,chart.gridSize,null):this.__lineCharts[i].addSubgrid(chart.horizontalAxis[j],null,chart.gridSize,this.__themeGridColor);if(this.__scopeLayout.charts[i].graphs)for(let j=0,jj=this.__scopeLayout.charts[i].graphs.length;j<jj;j++)this.__lineCharts[i].addLineGraph(this.__scopeLayout.charts[i].graphs[j],{dimensions:chart.gridSize.dimensions,position:chart.gridSize.position});if(this.__scopeGraphData){if(this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].graphs)for(let key in this.__scopeGraphData.charts[i].graphs){let graph=this.__scopeGraphData.charts[i].graphs[key],chart=this.__lineCharts[i];if(graph&&chart){let lineGraph=chart.getLineGraphWithName(key);lineGraph&&(lineGraph.setPoints(graph.axesData),lineGraph.setZeroPoint(graph.zeroPoint),lineGraph.setLineSeries(graph.lineSeries))}}if(this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].trigger)for(let k=0,kk=this.__scopeGraphData.charts[i].trigger.length;k<kk;k++)this.__lineCharts[i].addTrigger(this.__scopeGraphData.charts[i].trigger[k]);if(this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].xyTrigger)for(let k=0,kk=this.__scopeGraphData.charts[i].xyTrigger.length;k<kk;k++)this.__lineCharts[i].addXYTrigger(this.__scopeGraphData.charts[i].xyTrigger[k])}this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__lineCharts[i].draw(this.__scopeLayout.charts[i],null):this.__lineCharts[i].draw(this.__scopeLayout.charts[i],this.__themeCanvasBackgroundColor)}else this.__lineCharts[i].clear(0,0);contextBorderElem?.stroke()}if(this.__scopeLayout.overview){if(this.__resizeLines.push({orientation:TcHmiScopeControl_1.Orientation.Horizontal,startPoint:{x:0,y:1+(0|this.__scopeLayout.overview.dimensions.height)},endPoint:{x:0|canvasBorderElem.width,y:1+(0|this.__scopeLayout.overview.dimensions.height)},chartIndex:-1}),this.__showOverview=!0,this.__overviewChart)this.__overviewChart.clear(this.__scopeLayout.overview.dimensions.width,this.__scopeLayout.overview.dimensions.height);else{this.__overviewChart=new Beckhoff.TcHmiScopeControl.Charting.ScopeChart(this.__elementOverview,this.__scopeLayout.overview.dimensions.width,this.__scopeLayout.overview.dimensions.height);let canvas=this.__overviewChart.getCanvasZooming();canvas&&(canvas.addEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),canvas.addEventListener("mouseup",this.__mouseupOverviewHandler,passiveEventOptions),canvas.addEventListener("mousemove",this.__mousemoveOverviewHandler,passiveEventOptions),canvas.addEventListener("touchstart",this.__touchstartHandler,activeEventOptions))}this.__elementOverview.css({display:"block",width:this.__scopeLayout.overview.dimensions.width+"px",height:this.__scopeLayout.overview.dimensions.height+"px"});for(let j=0,jj=this.__scopeLayout.overview.verticalAxis.length;j<jj;j++)this.__scopeLayout.overview.verticalAxis[j].visible&&(this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__overviewChart.addYAxis(this.__scopeLayout.overview.verticalAxis[j],null,null):this.__overviewChart.addYAxis(this.__scopeLayout.overview.verticalAxis[j],this.__themeOverviewForegroundColor,this.__themeOverviewForegroundColor)),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__overviewChart.addGrid(null,this.__scopeLayout.overview.verticalAxis[j],this.__scopeLayout.overview.gridSize,null):this.__overviewChart.addGrid(null,this.__scopeLayout.overview.verticalAxis[j],this.__scopeLayout.overview.gridSize,this.__themeOverviewForegroundColor),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__overviewChart.addSubgrid(null,this.__scopeLayout.overview.verticalAxis[j],this.__scopeLayout.overview.gridSize,null):this.__overviewChart.addSubgrid(null,this.__scopeLayout.overview.verticalAxis[j],this.__scopeLayout.overview.gridSize,this.__themeOverviewForegroundColor);for(let j=0,jj=this.__scopeLayout.overview.horizontalAxis.length;j<jj;j++)this.__scopeLayout.overview.horizontalAxis[j].visible&&(this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__overviewChart.addXAxis(this.__scopeLayout.overview.horizontalAxis[j],null,null):this.__overviewChart.addXAxis(this.__scopeLayout.overview.horizontalAxis[j],this.__themeOverviewForegroundColor,this.__themeOverviewForegroundColor)),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__overviewChart.addGrid(this.__scopeLayout.overview.horizontalAxis[j],null,this.__scopeLayout.overview.gridSize,null):this.__overviewChart.addGrid(this.__scopeLayout.overview.horizontalAxis[j],null,this.__scopeLayout.overview.gridSize,this.__themeOverviewForegroundColor),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__overviewChart.addSubgrid(this.__scopeLayout.overview.horizontalAxis[j],null,this.__scopeLayout.overview.gridSize,null):this.__overviewChart.addSubgrid(this.__scopeLayout.overview.horizontalAxis[j],null,this.__scopeLayout.overview.gridSize,this.__themeOverviewForegroundColor);if(this.__scopeLayout.overview.graphs)for(let j=0,jj=this.__scopeLayout.overview.graphs.length;j<jj;j++)this.__overviewChart.addLineGraph(this.__scopeLayout.overview.graphs[j],{dimensions:this.__scopeLayout.overview.gridSize.dimensions,position:this.__scopeLayout.overview.gridSize.position});if(this.__scopeGraphData&&this.__overviewChart&&this.__scopeGraphData.overview&&this.__scopeGraphData.overview.graphs)for(let key in this.__scopeGraphData.overview.graphs){let graph=this.__scopeGraphData.overview.graphs[key];if(graph){let overviewGraph=this.__overviewChart.getLineGraphWithName(key);overviewGraph&&overviewGraph.setPoints(graph.axesData)}}if(this.__scopeGraphData&&this.__overviewChart&&this.__scopeGraphData.overview&&this.__scopeGraphData.overview.trigger)for(let k=0,kk=this.__scopeGraphData.overview.trigger.length;k<kk;k++)this.__overviewChart.addTrigger(this.__scopeGraphData.overview.trigger[k]);if(this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?this.__overviewChart.draw(this.__scopeLayout.overview,null):this.__overviewChart.draw(this.__scopeLayout.overview,this.__themeCanvasBackgroundColor),this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect){const canvas=this.__overviewChart.getCanvasZooming();let context=canvas.getContext("2d");if(context){let canvasWidth=canvas.width/window.devicePixelRatio,canvasHeight=canvas.height/window.devicePixelRatio;context.clearRect(0,0,canvasWidth,canvasHeight),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x,this.__scopeLayout.overview.canvas.position.y,this.__scopeGraphWindow.overviewRect.dimensions.width,this.__scopeGraphWindow.overviewRect.dimensions.height)}}}else if(this.__showOverview=!1,this.__elementOverview.css({display:"none"}),this.__overviewChart){let canvas=this.__overviewChart.getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),canvas.removeEventListener("mousemove",this.__mousemoveOverviewHandler,passiveEventOptions),canvas.removeEventListener("mouseup",this.__mouseupOverviewHandler,passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,activeEventOptions)),this.__overviewChart.remove(),this.__overviewChart=null}}else{for(let i=0,ii=this.__lineCharts.length;i<ii;i++){let canvas=this.__lineCharts[i].getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),canvas.removeEventListener("wheel",this.__mousewheelHandler,activeEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,activeEventOptions)),this.__lineCharts[i].remove(),this.__chartingElements[i].remove()}if(this.__lineCharts=[],this.__chartingElements=[],this.__overviewChart){let canvas=this.__overviewChart.getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),canvas.removeEventListener("mousemove",this.__mousemoveOverviewHandler,passiveEventOptions),canvas.removeEventListener("mouseup",this.__mouseupOverviewHandler,passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,activeEventOptions)),this.__overviewChart.remove(),this.__overviewChart=null}this.__elementOverview.css({display:"none"}),this.__elementChartName.css("display","none"),this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart").remove();let contextBorderElem=canvasBorderElem.getContext("2d");contextBorderElem&&contextBorderElem.clearRect(0,0,canvasBorderElem.width,canvasBorderElem.height)}}__onPressed(){return evt=>{if(null!==this.__elementMenuBarDropdown[0].parentElement&&this.showOptions(),evt.name.includes("options"))this.showOptions();else if(evt.name.includes("Run"))null!==this.__subscriptionId&&this.__serverSymbolsHelper.startDisplay();else if(evt.name.includes("Pause"))null!==this.__subscriptionId&&this.__serverSymbolsHelper.stopDisplay();else if(evt.name.includes("Unzoom"))null!==this.__subscriptionId&&this.__serverSymbolsHelper.zoomToDefault();else if(evt.name.includes("ZoomOutMax"))null!==this.__subscriptionId&&this.__serverSymbolsHelper.zoomOutMax();else if(evt.name.includes("PanXY"))this.__mouseMode=TcHmiScopeControl_1.MouseMode.PanXY;else if(evt.name.includes("PanY"))this.__mouseMode=TcHmiScopeControl_1.MouseMode.PanY;else if(evt.name.includes("Pan"))this.__mouseMode=TcHmiScopeControl_1.MouseMode.PanX;else if(evt.name.includes("ZoomXY"))this.__mouseMode=TcHmiScopeControl_1.MouseMode.ZoomXY;else if(evt.name.includes("ZoomY"))this.__mouseMode=TcHmiScopeControl_1.MouseMode.ZoomY;else if(evt.name.includes("Zoom"))this.__mouseMode=TcHmiScopeControl_1.MouseMode.ZoomX;else if(evt.name.includes("ScrollBackBig"))this.__serverSymbolsHelper.scrollBig(TcHmiScopeControl_1.Direction.Reverse);else if(evt.name.includes("ScrollBackSmall"))this.__serverSymbolsHelper.scroll(TcHmiScopeControl_1.Direction.Reverse);else if(evt.name.includes("ScrollForwardBig"))this.__serverSymbolsHelper.scrollBig(TcHmiScopeControl_1.Direction.Forward);else if(evt.name.includes("ScrollForwardSmall"))this.__serverSymbolsHelper.scroll(TcHmiScopeControl_1.Direction.Forward);else if(evt.name.includes("Undo"))this.__serverSymbolsHelper.undo();else if(evt.name.includes("Redo"))this.__serverSymbolsHelper.redo();else if(evt.name.includes("Overview"))this.__serverSymbolsHelper.setOverviewMode();else if(evt.name.includes("StartRecord"))this.__serverSymbolsHelper.startRecord();else if(evt.name.includes("StopRecord"))this.__serverSymbolsHelper.stopRecord();else if(evt.name.includes("TriggerWindow")){"Active"===this.__toolBarControls.TriggerWindowButton.getToggleState()?this.setShowTriggerWindow(!0):this.setShowTriggerWindow(!1)}else evt.name.includes("Upload")?(this.__dialog??=new TcHmiScopeControl_1.Dialog(this.__elementDialog[0],this),this.__dialog.setSrcDataOfRecordsDatagrid(this.__uploadedRecordsForActUser),this.__dialog.show()):evt.name.includes("Download")?this.__serverSymbolsHelper.__downloadScopeRecord():evt.name.includes("TimeRange")&&(this.__timeRangeDialog??=new TcHmiScopeControl_1.TimeRangeDialog(this.__elementTimeRangeDialog[0],this),this.__timeRangeDialog.show())}}__onTriggerDatagrid_DataChanged(){return(evt,property)=>{if("comment"===property.property&&this.__triggerWindow){let triggerWindowElem=this.__triggerWindow[property.index],request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetTriggerComment",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,triggerId:triggerWindowElem.id,newText:property.value}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__setTriggerCommentRequestId),this.__setTriggerCommentRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}}__onUserInteractionFinished(){return evt=>{if(evt.name.includes("DisplaywidthTextBox")){if(null!==this.__subscriptionId){let textboxElem=this.__toolBarControls.DisplaywidthTextBox;if(textboxElem){let textboxText=textboxElem.getText()??"";textboxText!==this.__displayWidthText&&this.__serverSymbolsHelper.setDisplayWidth(textboxText)}}}else if(evt.name.includes("GotoTextBox")&&null!==this.__subscriptionId){let textboxElem=this.__toolBarControls.GotoTextBox;if(textboxElem){let textboxText=textboxElem.getText()??"";textboxText!==this.__displayWidthText&&this.__serverSymbolsHelper.goTo(textboxText)}}}}__createLegend(legend){if(this.__elementLegend.children().remove(),legend){legend.length>0?TcHmi.StyleProvider.setSimpleElementStyle(this.__elementLegend,"display",""):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementLegend,"display","none");for(let i=0,ii=legend.length;i<ii;i++){let label=document.createElement("label");label.classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox-label"),label.innerText=legend[i].text;let checkbox=document.createElement("input");checkbox.setAttribute("type","checkbox"),checkbox.setAttribute("id",legend[i].id),checkbox.classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox");let color=document.createElement("div");color.classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox-color-element"),color.setAttribute("style","background-color: "+legend[i].color+";"),label.append(checkbox),label.append(color),this.__elementLegend.append(label);let active=TcHmi.ValueConverter.toBoolean(legend[i].enabled,!1);checkbox.checked=active}}else TcHmi.StyleProvider.setSimpleElementStyle(this.__elementLegend,"display","none")}__createMenuButtons(enableButtons,enableTimes){this.__elementMenuBarDropdown.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-time-bar-dropdown").children().detach().appendTo(this.__elementTimeBar);for(const labels of Object.keys(TcHmiScopeControl_1.TimesEnabled))if(isNaN(Number(labels))){let enumName=labels,addedLabels=(enableTimes&TcHmiScopeControl_1.TimesEnabled[enumName])===TcHmiScopeControl_1.TimesEnabled[enumName],timesName=enumName.replace("Label","");if(addedLabels){if(enumName.includes("Label")){let textValue="";textValue=enumName.includes("Position")?"0,00:00:00,000:000":enumName.includes("Date")?"Label_Text_Date_Placeholder":"00:00:00,000:000";let textblock,existingTextblock=this.__elementTimeBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName);textblock=null!==existingTextblock?$(existingTextblock):$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-textblock"></div>').attr({id:`${this.__id}_`+enumName,title:`%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_${timesName}%/l%`}),this.__elementTimeBar.append(textblock),this.__timeBarControls[enumName]=textblock,this.__addOrUpdateLocalizedElement(textblock[0],`Label_Text_${timesName}`,textValue),this.__addOrUpdateLocalizedElement(textblock[0],`Tooltip_Text_${timesName}`)}else if(enumName.includes("Splitter")){let splitter,existingSplitter=this.__elementTimeBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName);splitter=null!==existingSplitter?$(existingSplitter):$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-splitter"></div>').attr("id",`${this.__id}_`+enumName),this.__elementTimeBar.append(splitter),this.__timeBarControls[enumName]=splitter}}else if(!addedLabels){this.__removeLocalizedElement(`Label_Text_${timesName}`),this.__removeLocalizedElement(`Tooltip_Text_${timesName}`);let existingControl=this.__elementTimeBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName);if(existingControl)$(existingControl).remove();else{let splitter=this.__elementTimeBar.find("#"+this.__id+"_"+enumName);splitter&&splitter.length>0&&splitter.remove()}delete this.__timeBarControls[enumName]}}if(this.__toolBarControlsArray=[],this.__elementMenuBarDropdown.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tool-bar-dropdown").children().detach().appendTo(this.__elementToolBar),0===enableButtons||this.__menubar&&!this.__menubar.visibleToolstrip){if(null!==(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton"))){const elem=this.__toolBarControls.StartRecordButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.StartRecordButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.StartRecordButton),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StartRecordButton}if(null!==(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton"))){const elem=this.__toolBarControls.StopRecordButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.StopRecordButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.StopRecordButton),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StopRecordButton}}else if(this.__enableRecordControls){let stopRecordButton=this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton");if(null===stopRecordButton){let buttonStopControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__id}_StopRecordButton`,{"data-tchmi-is-enabled":!1,"data-tchmi-tooltip":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_Stop_Record%/l%","data-tchmi-virtual-control-right-mappings":this.__virtualMappingForControlRecord},this);if(!buttonStopControl)throw new Error("Needed Button could not be instantiated");buttonStopControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-StopRecordButton"),buttonStopControl.getElement().prependTo(this.__elementToolBar),this.__toolBarControls.StopRecordButton=buttonStopControl,this.__toolBarControlsArray.unshift(buttonStopControl),this.__destroyEvents.StopRecordButton=TcHmi.EventProvider.register(this.__id+"_StopRecordButton.onPressed",this.__onPressed())}else this.__toolBarControlsArray.unshift($(stopRecordButton));let startRecordButton=this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton");if(null===startRecordButton){let buttonStartControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__id}_StartRecordButton`,{"data-tchmi-is-enabled":!1,"data-tchmi-tooltip":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_Start_Record%/l%","data-tchmi-virtual-control-right-mappings":this.__virtualMappingForControlRecord},this);if(!buttonStartControl)throw new Error("Needed Button could not be instantiated");buttonStartControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-StartRecordButton"),buttonStartControl.getElement().prependTo(this.__elementToolBar),this.__toolBarControls.StartRecordButton=buttonStartControl,this.__toolBarControlsArray.unshift(buttonStartControl),this.__destroyEvents.StartRecordButton=TcHmi.EventProvider.register(this.__id+"_StartRecordButton.onPressed",this.__onPressed())}else this.__toolBarControlsArray.unshift($(startRecordButton))}else{if(null!==(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton"))){const elem=this.__toolBarControls.StartRecordButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.StartRecordButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.StartRecordButton),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StartRecordButton}if(null!==(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton"))){const elem=this.__toolBarControls.StopRecordButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.StopRecordButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.StopRecordButton),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StopRecordButton}}for(const button of Object.keys(TcHmiScopeControl_1.ButtonsEnabled))if(isNaN(Number(button))){let enumName=button,addedButton=(enableButtons&TcHmiScopeControl_1.ButtonsEnabled[enumName])===TcHmiScopeControl_1.ButtonsEnabled[enumName];if(addedButton){if(enumName.includes("ToggleButton")){let tooltipText=enumName.replace("ToggleButton","");if(null===(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName))){let toggleButtonControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiToggleButton",`${this.__id}_`+enumName,{"data-tchmi-toggle-group":this.__id+"MouseMode","data-tchmi-is-enabled":!1,"data-tchmi-tooltip":`%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_${tooltipText}%/l%`},this);if(!toggleButtonControl)throw new Error("Needed ToggleButton could not be instantiated");toggleButtonControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-toggle-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-"+enumName),this.__elementToolBar.append(toggleButtonControl.getElement()),this.__toolBarControls[enumName]=toggleButtonControl,this.__toolBarControlsArray.push(toggleButtonControl),this.__destroyEvents[enumName]=TcHmi.EventProvider.register(this.__id+"_"+enumName+".onPressed",this.__onPressed())}else{let existingControlValue=this.__toolBarControls[enumName];existingControlValue&&this.__toolBarControlsArray.push(existingControlValue)}}else if(enumName.includes("Button")){let tooltipText=enumName.replace("Button","");if(null===(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName))){let buttonControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__id}_`+enumName,{"data-tchmi-is-enabled":!1,"data-tchmi-tooltip":`%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_${tooltipText}%/l%`},this);if(!buttonControl)throw new Error("Needed Button could not be instantiated");buttonControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-"+enumName),this.__elementToolBar.append(buttonControl.getElement()),this.__toolBarControls[enumName]=buttonControl,this.__toolBarControlsArray.push(buttonControl),this.__destroyEvents[enumName]=TcHmi.EventProvider.register(this.__id+"_"+enumName+".onPressed",this.__onPressed())}else{let existingControlValue=this.__toolBarControls[enumName];existingControlValue&&this.__toolBarControlsArray.push(existingControlValue)}}else if(enumName.includes("Splitter")){let splitter,existingSplitter=this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName);null===existingSplitter?(splitter=$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-splitter TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-'+enumName+'"></div>').attr("id",`${this.__id}_`+enumName),this.__elementToolBar.append(splitter),this.__toolBarControls[enumName]=splitter):splitter=$(existingSplitter),this.__toolBarControlsArray.push(splitter)}else if(enumName.includes("TextBox")){let tooltipText=enumName.replace("TextBox","");if(null===(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName))){let textboxControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiTextbox",`${this.__id}_`+enumName,{"data-tchmi-text-horizontal-alignment":"Right","data-tchmi-is-enabled":!1,"data-tchmi-tooltip":`%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_${tooltipText}%/l%`,"data-tchmi-auto-focus-out":!0},this);if(!textboxControl)throw new Error("Needed Textbox could not be instantiated");textboxControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-textbox","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-"+enumName),this.__elementToolBar.append(textboxControl.getElement()),this.__toolBarControls[enumName]=textboxControl,this.__toolBarControlsArray.push(textboxControl),this.__destroyEvents[enumName]=TcHmi.EventProvider.register(this.__id+"_"+enumName+".onUserInteractionFinished",this.__onUserInteractionFinished())}else{let existingControlValue=this.__toolBarControls[enumName];existingControlValue&&this.__toolBarControlsArray.push(existingControlValue)}}}else if(!addedButton){let existingControl=this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_"+enumName);if(null===existingControl){let splitter=this.__elementToolBar.find("#"+this.__id+"_"+enumName);splitter&&splitter.length>0&&splitter.remove()}else $(existingControl).remove();if(enumName.includes("Button")||enumName.includes("TextBox")||enumName.includes("ToggleButton")){const elem=this.__toolBarControls[enumName];elem&&elem.destroy();const destroyEvent=this.__destroyEvents[enumName];destroyEvent&&(destroyEvent(),delete this.__destroyEvents[enumName])}delete this.__toolBarControls[enumName]}}if(0===enableButtons||this.__menubar&&!this.__menubar.visibleToolstrip){if(null!==(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_TriggerWindowButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_TriggerWindowButton"))){const elem=this.__toolBarControls.TriggerWindowButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.TriggerWindowButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.TriggerWindowButton),delete this.__toolBarControls.TriggerWindowButton}}else{let triggerWindowButton=this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_TriggerWindowButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_TriggerWindowButton");if(null===triggerWindowButton){let buttonTriggerWindowControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiToggleButton",`${this.__id}_TriggerWindowButton`,{"data-tchmi-is-enabled":!1,"data-tchmi-tooltip":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_Trigger_Window%/l%","data-tchmi-toggle-state":this.__showTriggerWindow?"Active":"Normal"},this);if(!buttonTriggerWindowControl)throw new Error("Needed Button could not be instantiated");buttonTriggerWindowControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-toggle-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-TriggerWindowButton"),this.__elementToolBar.append(buttonTriggerWindowControl.getElement()),this.__toolBarControls.TriggerWindowButton=buttonTriggerWindowControl,this.__toolBarControlsArray.push(buttonTriggerWindowControl),this.__destroyEvents.TriggerWindowButton=TcHmi.EventProvider.register(this.__id+"_TriggerWindowButton.onPressed",this.__onPressed())}else this.__toolBarControlsArray.push($(triggerWindowButton))}if(0===enableButtons||this.__menubar&&!this.__menubar.visibleToolstrip){if(null!==(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_UploadButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_UploadButton"))){const elem=this.__toolBarControls.UploadButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.UploadButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.UploadButton),delete this.__toolBarControls.UploadButton}}else{let uploadButton=this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_UploadButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_UploadButton");if(null===uploadButton){const uploadMapping={controlRight:"operate",virtualControlRight:"upload"};let buttonUploadControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__id}_UploadButton`,{"data-tchmi-is-enabled":!1,"data-tchmi-tooltip":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_Upload%/l%","data-tchmi-virtual-control-right-mappings":[uploadMapping]},this);if(!buttonUploadControl)throw new Error("Needed Button could not be instantiated");buttonUploadControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-UploadButton"),this.__elementToolBar.append(buttonUploadControl.getElement()),this.__toolBarControls.UploadButton=buttonUploadControl,this.__toolBarControlsArray.push(buttonUploadControl),this.__destroyEvents.UploadButton=TcHmi.EventProvider.register(this.__id+"_UploadButton.onPressed",this.__onPressed())}else this.__toolBarControlsArray.push($(uploadButton))}if(0===enableButtons||this.__menubar&&!this.__menubar.visibleToolstrip){if(null!==(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_DownloadButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_DownloadButton"))){const elem=this.__toolBarControls.DownloadButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.DownloadButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.DownloadButton),delete this.__toolBarControls.DownloadButton}}else{let downloadButton=this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_DownloadButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_DownloadButton");if(null===downloadButton){const downloadMapping={controlRight:"operate",virtualControlRight:"download"};let buttonDownloadControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__id}_DownloadButton`,{"data-tchmi-is-enabled":!1,"data-tchmi-tooltip":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_Download%/l%","data-tchmi-virtual-control-right-mappings":[downloadMapping]},this);if(!buttonDownloadControl)throw new Error("Needed Button could not be instantiated");buttonDownloadControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-DownloadButton"),this.__elementToolBar.append(buttonDownloadControl.getElement()),this.__toolBarControls.DownloadButton=buttonDownloadControl,this.__toolBarControlsArray.push(buttonDownloadControl),this.__destroyEvents.DownloadButton=TcHmi.EventProvider.register(this.__id+"_DownloadButton.onPressed",this.__onPressed())}else this.__toolBarControlsArray.push($(downloadButton))}if(0===enableButtons||this.__menubar&&!this.__menubar.visibleToolstrip||this.__menubar&&!this.__menubar.existsHistoricalAcquisition){if(null!==(this.__elementToolBar[0].querySelector("#"+this.__id+"_TimeRangeButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_TimeRangeButton"))){const elem=this.__toolBarControls.TimeRangeButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.TimeRangeButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.TimeRangeButton),delete this.__toolBarControls.TimeRangeButton}}else{let timeRangeButton=this.__elementToolBar[0].querySelector("#"+this.__id+"_TimeRangeButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_TimeRangeButton");if(null===timeRangeButton){let timeRangeControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__id}_TimeRangeButton`,{"data-tchmi-is-enabled":!1,"data-tchmi-tooltip":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_TimeRange%/l%","data-tchmi-virtual-control-right-mappings":this.__virtualMappingForChangeHistoricalAquisitions},this);if(!timeRangeControl)throw new Error("Needed Button could not be instantiated");timeRangeControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-TimeRangeButton"),this.__elementToolBar.append(timeRangeControl.getElement()),this.__toolBarControls.TimeRangeButton=timeRangeControl,this.__toolBarControlsArray.push(timeRangeControl),this.__destroyEvents.TimeRangeButton=TcHmi.EventProvider.register(this.__id+"_TimeRangeButton.onPressed",this.__onPressed())}else this.__toolBarControlsArray.push($(timeRangeButton))}if(void 0===this.__toolBarControls.OptionsButton){let optionsButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__id}_optionsButton`,{"data-tchmi-visibility":"Collapsed"},this);if(!optionsButton)throw new Error("Needed Button could not be instantiated");optionsButton.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-options"),this.__elementToolBar.append(optionsButton.getElement()),this.__toolBarControls.OptionsButton=optionsButton,this.__toolBarControlsArray.push(optionsButton),this.__destroyEvents.OptionsButton=TcHmi.EventProvider.register(this.__id+"_optionsButton.onPressed",this.__onPressed())}else{let existingControlValue=this.__toolBarControls.OptionsButton;existingControlValue&&this.__toolBarControlsArray.push(existingControlValue)}}__calcMenuButtons(){if(this.__elementToolBar&&this.__elementMenuBarDropdown&&this.__toolBarControlsArray&&this.__timeBarControls){let timeBarDropDown=this.__elementMenuBarDropdown.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-time-bar-dropdown"),toolBarDropDown=this.__elementMenuBarDropdown.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tool-bar-dropdown"),optionsButtonWidth=0,optionsButton=this.__toolBarControls.OptionsButton;if(optionsButton){optionsButton.setVisibility("Visible");let width=optionsButton.getElement().outerWidth(!0);optionsButtonWidth=void 0===width?0:width}let menuBarWidth=this.__elementToolBar.width(),actualWidth=optionsButtonWidth;for(const control of this.__toolBarControlsArray){let width;control instanceof TcHmi.Controls.System.TcHmiControl?-1===control.getId().search("optionsButton")&&(width=control.getElement().outerWidth(!0)):width=control.outerWidth(!0),void 0===width&&(width=0),actualWidth+=width,actualWidth>=menuBarWidth&&(control instanceof TcHmi.Controls.System.TcHmiControl?-1===control.getId().search("optionsButton")&&toolBarDropDown.append(control.getElement()):toolBarDropDown.append(control[0]))}actualWidth=optionsButtonWidth;for(let controlName in this.__timeBarControls){let control=this.__timeBarControls[controlName];if(void 0!==control){let width=control.outerWidth(!0);void 0===width&&(width=0),actualWidth+=width,actualWidth>=menuBarWidth&&timeBarDropDown.append(control[0])}}timeBarDropDown.children().length>0||toolBarDropDown.children().length>0?optionsButton?.setVisibility("Visible"):optionsButton?.setVisibility("Collapsed")}}enableOrDisableMenuControls(){null!==this.__startRecordRequestId||null!==this.__startRequestId||null!==this.__stopRecordRequestId||null!==this.__stopRequestId||null!==this.__zoomRequestId||null!==this.__panRequestId||null!==this.__wheelRequestId||null!==this.__zoomOutRequestId||null!==this.__unzoomRequestId||null!==this.__displayWidthRequestId||null!==this.__gotoRequestId||null!==this.__scrollRequestId||null!==this.__scrollBigRequestId||null!==this.__undoRequestId||null!==this.__redoRequestId||null!==this.__setOverviewModeRequestId||null!==this.__setOverviewRectRequestId||null!==this.__getTooltipRequestId||null!==this.__resizeChartsRequestId||null!==this.__changeChannelStateRequestId||null!==this.__setTriggerCommentRequestId||null!==this.__changePersistRequestId||null!==this.__getAnalyticsDataRequestId||null!==this.__closeConnectionRequestId||null!==this.__deleteScopeRecordRequestId||null!==this.__getChartListRequestId||null!==this.__getDataRequestId||null!==this.__getMenubarRequestId||null!==this.__initRequestId||null!==this.__openConnectionRequestId||null!==this.__openConnectionToFileRequestId||null!==this.__saveCurrentRecordRequestId||null!==this.__setChartSizeRequestId||null!==this.__uploadedRecordsRequestId||null!==this.__setAnalyticsRecordRequestId?this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT):this.__scopeGraphWindow&&this.__scopeLayout?this.__enableOrDisableMenuControls(this.__scopeGraphWindow.scopeState,this.__scopeGraphWindow.liveState,this.__scopeGraphWindow.undo,this.__scopeGraphWindow.redo,TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]):this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT)}__enableOrDisableMenuControls(scopeState,live,undo,redo,chartType){switch(scopeState){case"Unknown":case"Config":case"Connected":for(let controlName in this.__toolBarControls){let control=this.__toolBarControls[controlName];control instanceof TcHmi.Controls.System.TcHmiControl&&control.setIsEnabled(!1)}this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!0),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!1),this.__toolBarControls.TriggerWindowButton&&this.__toolBarControls.TriggerWindowButton.setIsEnabled(!0),this.__toolBarControls.UploadButton&&this.__toolBarControls.UploadButton.setIsEnabled(!0),this.__toolBarControls.DownloadButton&&this.__toolBarControls.DownloadButton.setIsEnabled(!1),this.__toolBarControls.TimeRangeButton&&this.__toolBarControls.TimeRangeButton.setIsEnabled(!1),this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0);break;case"Running":for(let controlName in this.__toolBarControls){let control=this.__toolBarControls[controlName];control instanceof TcHmi.Controls.System.TcHmiControl&&control.setIsEnabled(!1)}this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!1),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!0),this.__toolBarControls.TriggerWindowButton&&this.__toolBarControls.TriggerWindowButton.setIsEnabled(!0),this.__toolBarControls.UploadButton&&this.__toolBarControls.UploadButton.setIsEnabled(!0),this.__toolBarControls.DownloadButton&&this.__toolBarControls.DownloadButton.setIsEnabled(!1),this.__toolBarControls.TimeRangeButton&&this.__toolBarControls.TimeRangeButton.setIsEnabled(!1),this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0);break;case"Record":this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!1),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!0),this.__toolBarControls.TriggerWindowButton&&this.__toolBarControls.TriggerWindowButton.setIsEnabled(!0),this.__toolBarControls.UploadButton&&this.__toolBarControls.UploadButton.setIsEnabled(!0),this.__toolBarControls.DownloadButton&&this.__toolBarControls.DownloadButton.setIsEnabled(!1),this.__toolBarControls.TimeRangeButton&&this.__toolBarControls.TimeRangeButton.setIsEnabled(!1),this.__toolBarControls.RunButton&&this.__toolBarControls.RunButton.setIsEnabled(!live),this.__toolBarControls.PauseButton&&this.__toolBarControls.PauseButton.setIsEnabled(live),this.__toolBarControls.DisplaywidthTextBox&&this.__toolBarControls.DisplaywidthTextBox.setIsEnabled(!0),this.__toolBarControls.ScrollBackBigButton&&this.__toolBarControls.ScrollBackBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardBigButton&&this.__toolBarControls.ScrollForwardBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollBackSmallButton&&this.__toolBarControls.ScrollBackSmallButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardSmallButton&&this.__toolBarControls.ScrollForwardSmallButton.setIsEnabled(!live),this.__toolBarControls.GotoTextBox&&this.__toolBarControls.GotoTextBox.setIsEnabled(!live),this.__toolBarControls.UndoButton&&this.__toolBarControls.UndoButton.setIsEnabled(!live&&undo),this.__toolBarControls.RedoButton&&this.__toolBarControls.RedoButton.setIsEnabled(!live&&redo),this.__toolBarControls.ZoomToggleButton&&this.__toolBarControls.ZoomToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl_1.ChartType.ArrayBarChart),this.__toolBarControls.ZoomXYToggleButton&&this.__toolBarControls.ZoomXYToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl_1.ChartType.ArrayBarChart),this.__toolBarControls.PanXYToggleButton&&this.__toolBarControls.PanXYToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl_1.ChartType.ArrayBarChart||chartType===TcHmiScopeControl_1.ChartType.XY),this.__toolBarControls.PanToggleButton&&this.__toolBarControls.PanToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl_1.ChartType.ArrayBarChart),this.__toolBarControls.ZoomYToggleButton&&this.__toolBarControls.ZoomYToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl_1.ChartType.ArrayBarChart),this.__toolBarControls.PanYToggleButton&&this.__toolBarControls.PanYToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl_1.ChartType.ArrayBarChart),this.__toolBarControls.OverviewButton&&this.__toolBarControls.OverviewButton.setIsEnabled(!0),this.__toolBarControls.UnzoomButton&&this.__toolBarControls.UnzoomButton.setIsEnabled(!0),this.__toolBarControls.ZoomOutMaxButton&&this.__toolBarControls.ZoomOutMaxButton.setIsEnabled(!0),this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0);break;case"Reply":this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!0),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!1),this.__toolBarControls.TriggerWindowButton&&this.__toolBarControls.TriggerWindowButton.setIsEnabled(!0),this.__toolBarControls.UploadButton&&this.__toolBarControls.UploadButton.setIsEnabled(!0),this.__toolBarControls.DownloadButton&&this.__toolBarControls.DownloadButton.setIsEnabled(TcHmi.Environment.getBrowserCapabilities().supportsDownload),this.__toolBarControls.TimeRangeButton&&this.__toolBarControls.TimeRangeButton.setIsEnabled(!0),this.__toolBarControls.RunButton&&this.__toolBarControls.RunButton.setIsEnabled(!1),this.__toolBarControls.PauseButton&&this.__toolBarControls.PauseButton.setIsEnabled(!1),this.__toolBarControls.DisplaywidthTextBox&&this.__toolBarControls.DisplaywidthTextBox.setIsEnabled(!0),this.__toolBarControls.ScrollBackBigButton&&this.__toolBarControls.ScrollBackBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardBigButton&&this.__toolBarControls.ScrollForwardBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollBackSmallButton&&this.__toolBarControls.ScrollBackSmallButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardSmallButton&&this.__toolBarControls.ScrollForwardSmallButton.setIsEnabled(!live),this.__toolBarControls.GotoTextBox&&this.__toolBarControls.GotoTextBox.setIsEnabled(!live),this.__toolBarControls.UndoButton&&this.__toolBarControls.UndoButton.setIsEnabled(!live&&undo),this.__toolBarControls.RedoButton&&this.__toolBarControls.RedoButton.setIsEnabled(!live&&redo),this.__toolBarControls.ZoomToggleButton&&this.__toolBarControls.ZoomToggleButton.setIsEnabled(!live),this.__toolBarControls.ZoomXYToggleButton&&this.__toolBarControls.ZoomXYToggleButton.setIsEnabled(!live),this.__toolBarControls.PanToggleButton&&this.__toolBarControls.PanToggleButton.setIsEnabled(!live),this.__toolBarControls.PanXYToggleButton&&this.__toolBarControls.PanXYToggleButton.setIsEnabled(!live),this.__toolBarControls.ZoomYToggleButton&&this.__toolBarControls.ZoomYToggleButton.setIsEnabled(!live),this.__toolBarControls.PanYToggleButton&&this.__toolBarControls.PanYToggleButton.setIsEnabled(!live),this.__toolBarControls.UnzoomButton&&this.__toolBarControls.UnzoomButton.setIsEnabled(!0),this.__toolBarControls.ZoomOutMaxButton&&this.__toolBarControls.ZoomOutMaxButton.setIsEnabled(!0),this.__toolBarControls.OverviewButton&&this.__toolBarControls.OverviewButton.setIsEnabled(!0),this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0);break;case"Reply_SVDX":this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!1),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!1),this.__toolBarControls.TriggerWindowButton&&this.__toolBarControls.TriggerWindowButton.setIsEnabled(!0),this.__toolBarControls.UploadButton&&this.__toolBarControls.UploadButton.setIsEnabled(!0),this.__toolBarControls.DownloadButton&&this.__toolBarControls.DownloadButton.setIsEnabled(!1),this.__toolBarControls.TimeRangeButton&&this.__toolBarControls.TimeRangeButton.setIsEnabled(!1),this.__toolBarControls.RunButton&&this.__toolBarControls.RunButton.setIsEnabled(!1),this.__toolBarControls.PauseButton&&this.__toolBarControls.PauseButton.setIsEnabled(!1),this.__toolBarControls.DisplaywidthTextBox&&this.__toolBarControls.DisplaywidthTextBox.setIsEnabled(!0),this.__toolBarControls.ScrollBackBigButton&&this.__toolBarControls.ScrollBackBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardBigButton&&this.__toolBarControls.ScrollForwardBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollBackSmallButton&&this.__toolBarControls.ScrollBackSmallButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardSmallButton&&this.__toolBarControls.ScrollForwardSmallButton.setIsEnabled(!live),this.__toolBarControls.GotoTextBox&&this.__toolBarControls.GotoTextBox.setIsEnabled(!live),this.__toolBarControls.UndoButton&&this.__toolBarControls.UndoButton.setIsEnabled(!live&&undo),this.__toolBarControls.RedoButton&&this.__toolBarControls.RedoButton.setIsEnabled(!live&&redo),this.__toolBarControls.ZoomToggleButton&&this.__toolBarControls.ZoomToggleButton.setIsEnabled(!live),this.__toolBarControls.ZoomXYToggleButton&&this.__toolBarControls.ZoomXYToggleButton.setIsEnabled(!live),this.__toolBarControls.PanToggleButton&&this.__toolBarControls.PanToggleButton.setIsEnabled(!live),this.__toolBarControls.PanXYToggleButton&&this.__toolBarControls.PanXYToggleButton.setIsEnabled(!live),this.__toolBarControls.ZoomYToggleButton&&this.__toolBarControls.ZoomYToggleButton.setIsEnabled(!live),this.__toolBarControls.PanYToggleButton&&this.__toolBarControls.PanYToggleButton.setIsEnabled(!live),this.__toolBarControls.UnzoomButton&&this.__toolBarControls.UnzoomButton.setIsEnabled(!0),this.__toolBarControls.ZoomOutMaxButton&&this.__toolBarControls.ZoomOutMaxButton.setIsEnabled(!0),this.__toolBarControls.OverviewButton&&this.__toolBarControls.OverviewButton.setIsEnabled(!0),this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0);break;default:for(let controlName in this.__toolBarControls){let control=this.__toolBarControls[controlName];control instanceof TcHmi.Controls.System.TcHmiControl&&"OptionsButton"!==controlName&&control.setIsEnabled(!1)}this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0)}this.__dialog&&this.__dialog.getIsWaitingForServer()&&(this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!1),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!1))}__updatedMenuValues(windowData){for(let controlName in this.__timeBarControls)if(!controlName.includes("Splitter")){let textblock=this.__timeBarControls[controlName];if(controlName.includes("StartTime")){let textValue="";if(windowData&&windowData.xAxisStart){const dateSplitted=TcHmi.Localization.parseDate(new Date(windowData.xAxisStart));textValue=("00"+dateSplitted.hour).slice(-2)+":"+("00"+dateSplitted.minute).slice(-2)+":"+("00"+dateSplitted.second).slice(-2)+","+("000"+dateSplitted.millisecond).slice(-3)}else textValue="00:00:00,000:000";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_StartTime",textValue)}else if(controlName.includes("EndTime")){let textValue="";if(windowData&&windowData.xAxisEnd){const dateSplitted=TcHmi.Localization.parseDate(new Date(windowData.xAxisEnd));textValue=("00"+dateSplitted.hour).slice(-2)+":"+("00"+dateSplitted.minute).slice(-2)+":"+("00"+dateSplitted.second).slice(-2)+","+("000"+dateSplitted.millisecond).slice(-3)}else textValue="00:00:00,000:000";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_EndTime",textValue)}else if(controlName.includes("Position")){let textValue="";if(windowData&&windowData.xAxisPosition){textValue=Beckhoff.TcHmiScopeHelpers.ScopeHelper.__isoToScopeString(windowData.xAxisPosition)}else textValue="0,00:00:00,000:000";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_Position",textValue)}else if(controlName.includes("AbsTime")){let textValue="";if(windowData&&windowData.startDisplayTime){const dateSplitted=TcHmi.Localization.parseDate(new Date(windowData.startDisplayTime));textValue=("00"+dateSplitted.hour).slice(-2)+":"+("00"+dateSplitted.minute).slice(-2)+":"+("00"+dateSplitted.second).slice(-2)+","+("000"+dateSplitted.millisecond).slice(-3)}else textValue="00:00:00,000:000";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_AbsTime",textValue)}else if(controlName.includes("Date")){let textValue="";if(windowData&&windowData.startDisplayTime){let date=new Date(windowData.startDisplayTime);const dateSplitted=TcHmi.Localization.parseDate(date);textValue=date.toLocaleString(TcHmi.Server.getCurrentUserConfig().timeFormatLocale,{weekday:"long"})+", "+dateSplitted.day+". "+date.toLocaleString(TcHmi.Server.getCurrentUserConfig().timeFormatLocale,{month:"long"})+" "+dateSplitted.year}else textValue="Label_Text_Date_Placeholder";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_Date",textValue)}}for(let controlName in this.__toolBarControls)if(controlName.includes("DisplaywidthTextBox")){const textbox=this.__toolBarControls[controlName];if(windowData&&windowData.displayWidth){let scopeString=Beckhoff.TcHmiScopeHelpers.ScopeHelper.__isoToScopeString(windowData.displayWidth);textbox.setText(scopeString),this.__displayWidthText=scopeString}else textbox.setText("0,00:00:00,000:000")}else if(controlName.includes("GotoTextBox")){const textbox=this.__toolBarControls[controlName];if(windowData&&windowData.xAxisPosition){let scopeString=Beckhoff.TcHmiScopeHelpers.ScopeHelper.__isoToScopeString(windowData.xAxisPosition);textbox.setText(scopeString),this.__gotoText=scopeString}else textbox.setText("0,00:00:00,000:000")}}showOptions(){null===this.__elementMenuBarDropdown[0].parentElement?TcHmi.TopMostLayer.add(this,this.__elementMenuBarDropdown,{centerHorizontal:!0,centerVertical:!0}):TcHmi.TopMostLayer.remove(this,this.__elementMenuBarDropdown)}__transformEventCoords(clientX,clientY,targetElement){if(targetElement){let renderedWidth=this.getRenderedWidth(),renderedHeight=this.getRenderedHeight();if(null===renderedWidth||null===renderedHeight)return{x:0,y:0};let controlRect=this.__element[0].getBoundingClientRect();this.__scaling={x:renderedWidth/controlRect.width,y:renderedHeight/controlRect.height}}return{x:clientX*this.__scaling.x,y:clientY*this.__scaling.y}}__onCheckboxMouseDown=event=>{if(!this.getIsEnabled()||1!==event.which)return;let childElement=event.target,checkboxElem=null;if("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox"===childElement.className)checkboxElem=childElement;else if("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox-label"===childElement.className){let checkboxList=childElement.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox");checkboxList&&checkboxList.length>0&&(checkboxElem=checkboxList[0])}else if("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox-color-element"===childElement.className&&childElement&&childElement.parentElement){let checkboxList=childElement.parentElement.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox");checkboxList&&checkboxList.length>0&&(checkboxElem=checkboxList[0])}if(checkboxElem){let id=checkboxElem.id,checked=!checkboxElem.checked;if(!TcHmi.Access.checkAccess(this,"operate"))return void(checkboxElem.checked=checked);let children=this.__elementLegend.children(),activeLegendElements=[];for(let i=0,ii=children.length;i<ii;i++){let checkboxChecked=children[i].childNodes[1].checked,checkboxName=children[i].childNodes[0].textContent;id===children[i].childNodes[1].id&&(checkboxChecked=!checkboxChecked),checkboxChecked&&checkboxName&&activeLegendElements.push(checkboxName)}this.__activeLegendElements=activeLegendElements,this.__storage?.set("activeLegendElements",activeLegendElements),this.__serverSymbolsHelper.changeChannelState(id,checked)}};__onCheckboxTouchStart=event=>{if(!this.getIsEnabled())return;let childElement=event.target;if(childElement){let checkboxList=childElement.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox");if(checkboxList&&checkboxList.length>0){let checkoboxElement=checkboxList[0],id=checkoboxElement.id,checked=!checkoboxElement.checked;if(!TcHmi.Access.checkAccess(this,"operate"))return void(checkoboxElement.checked=checked);let children=this.__elementLegend.children(),activeLegendElements=[];for(let i=0,ii=children.length;i<ii;i++){let checkboxChecked=children[i].childNodes[1].checked,checkboxName=children[i].childNodes[0].textContent;id===children[i].childNodes[1].id&&(checkboxChecked=!checkboxChecked),checkboxChecked&&checkboxName&&activeLegendElements.push(checkboxName)}this.__activeLegendElements=activeLegendElements,this.__storage?.set("activeLegendElements",activeLegendElements),this.__serverSymbolsHelper.changeChannelState(id,checked)}}};__onMouseDown(){return e=>{if(!TcHmi.Access.checkAccess(this,"operate"))return;if(this.__tooltipTimeout&&(clearTimeout(this.__tooltipTimeout),this.__tooltipTimeout=null,this.__elementTooltip.css({visibility:"hidden",top:"0px",left:"0px"})),this.__manipulationInfo.isManipulating||!this.getIsEnabled())return;this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!1};let boundingRect=e.target.getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY,e.target),parentElement=e.currentTarget.parentElement;if(parentElement){let index=-1;if(parentElement!==this.__elementOverview[0]&&(index=Array.prototype.slice.call(this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart")).indexOf(parentElement)),this.__scopeLayout){let x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;if(this.__scopeLayout.showTooltip&&index>-1&&this.__scopeGraphWindow&&!this.__scopeGraphWindow.liveState&&x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height&&this.__scopeGraphData&&this.__scopeGraphData.charts)for(let i=0,ii=this.__scopeGraphData.charts.length;i<ii;i++)if(i===index&&this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].graphs)for(let key in this.__scopeGraphData.charts[i].graphs){let graph=this.__scopeGraphData.charts[i].graphs[key];if(graph){let tooltipDelta=graph.tooltipDelta;if(graph.axesData.filter((item=>x>=item.x-tooltipDelta&&x<=item.x+tooltipDelta&&y>=item.y-tooltipDelta&&y<=item.y+tooltipDelta)).length>0){this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y};let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:this.__serverDomain+".GetTooltip",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,chartIndex:index,mousePosition:{x:x,y:y}}}]};return this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__getTooltipRequestId),void(this.__getTooltipRequestId=TcHmi.Server.requestEx(request,{timeout:1e4},this.__getDataCallback()))}}}if(-1===index)this.__scopeLayout.overview&&x>=this.__scopeLayout.overview.canvas.position.x&&x<=this.__scopeLayout.overview.canvas.position.x+this.__scopeLayout.overview.canvas.dimensions.width&&y>=this.__scopeLayout.overview.canvas.position.y&&y<=this.__scopeLayout.overview.canvas.position.y+this.__scopeLayout.overview.canvas.dimensions.height&&(this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y},this.__userInteractionStart(x,y,index));else{if(this.__scopeGraphWindow&&this.__scopeGraphWindow.liveState)return;x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height&&(this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y},this.__userInteractionStart(x,y,index))}}}}}__onMouseDownGlobal(){return e=>{if(TcHmi.Access.checkAccess(this,"operate")&&!this.__manipulationInfo.isManipulating&&this.getIsEnabled()){if(this.__tooltipTimeout&&(clearTimeout(this.__tooltipTimeout),this.__tooltipTimeout=null,this.__elementTooltip.css({visibility:"hidden",top:"0px",left:"0px"})),this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!1},this.__resizeLines.length>0){let boundingRect=this.__elementBorder[0].getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY,e.target),x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;for(let i=0,ii=this.__resizeLines.length;i<ii;i++)if(this.__resizeLines[i].orientation===TcHmiScopeControl_1.Orientation.Horizontal){if(y>=this.__resizeLines[i].startPoint.y-5&&y<=this.__resizeLines[i].endPoint.y+5)return void(this.__manipulationInfo={isManipulating:!0,start:{x:x,y:y},end:{x:x,y:y},offset:{left:boundingRect.left,top:boundingRect.top},transform:{x:0,y:0},click:!0,mousePosition:{x:x,y:y},elementIndex:this.__resizeLines[i].chartIndex,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!0,resizeLineIndex:i,touchIdentifier:0,resizeTriggerWindow:!1})}else if(this.__resizeLines[i].orientation===TcHmiScopeControl_1.Orientation.Vertical&&x>=this.__resizeLines[i].startPoint.x-5&&x<=this.__resizeLines[i].endPoint.x+5)return void(this.__manipulationInfo={isManipulating:!0,start:{x:x,y:y},end:{x:x,y:y},offset:{left:boundingRect.left,top:boundingRect.top},transform:{x:0,y:0},click:!0,mousePosition:{x:x,y:y},elementIndex:this.__resizeLines[i].chartIndex,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!0,resizeLineIndex:i,touchIdentifier:0,resizeTriggerWindow:!1})}if(this.__showTriggerWindow){let boundingRect=e.target.getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY,e.target),x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Left){let widthTriggerWindow=this.__elementTriggerWindow.outerWidth()+5;x>=widthTriggerWindow&&x<=widthTriggerWindow+5&&(this.__manipulationInfo={isManipulating:!0,start:{x:x,y:y},end:{x:x,y:y},offset:{left:boundingRect.left,top:boundingRect.top},transform:{x:0,y:0},click:!0,mousePosition:{x:x,y:y},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!1,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!0})}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Right){let widthChartings=this.__elementChartings.outerWidth()+5;x>=widthChartings&&x<=widthChartings+5&&(this.__manipulationInfo={isManipulating:!0,start:{x:x,y:y},end:{x:x,y:y},offset:{left:boundingRect.left,top:boundingRect.top},transform:{x:0,y:0},click:!0,mousePosition:{x:x,y:y},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!1,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!0})}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Top){let heightTriggerWindow=this.__elementTriggerWindow.outerHeight()+5;y>=heightTriggerWindow&&y<=heightTriggerWindow+5&&(this.__manipulationInfo={isManipulating:!0,start:{x:x,y:y},end:{x:x,y:y},offset:{left:boundingRect.left,top:boundingRect.top},transform:{x:0,y:0},click:!0,mousePosition:{x:x,y:y},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!1,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!0})}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Bottom){let heightBeforeTriggerWindow=5+this.__elementMenuBar.outerHeight()+5+this.__elementChartings.outerHeight()+5+this.__elementLegend.outerHeight();y>=heightBeforeTriggerWindow&&y<=heightBeforeTriggerWindow+5&&(this.__manipulationInfo={isManipulating:!0,start:{x:x,y:y},end:{x:x,y:y},offset:{left:boundingRect.left,top:boundingRect.top},transform:{x:0,y:0},click:!0,mousePosition:{x:x,y:y},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!1,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!0})}}}}}__onMouseMove(){return e=>{if(!this.__manipulationInfo.isManipulating||!this.getIsEnabled())return;let coords=this.__transformEventCoords(e.clientX,e.clientY),x=coords.x-this.__manipulationInfo.offset.left,y=coords.y-this.__manipulationInfo.offset.top;this.__userInteractionMove(x,y)}}__onMouseMoveChangeCursor(){return e=>{if(this.__elementChartings.css("cursor","default"),!this.__manipulationInfo.isManipulating&&this.getIsEnabled()&&this.__scopeLayout){if(this.__resizeLines.length>0){let boundingRect=this.__elementBorder[0].getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY),x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;for(let i=0,ii=this.__resizeLines.length;i<ii;i++)if(this.__resizeLines[i].orientation===TcHmiScopeControl_1.Orientation.Horizontal){if(y>=this.__resizeLines[i].startPoint.y-5&&y<=this.__resizeLines[i].endPoint.y+5)return void this.__elementChartings.css("cursor","ns-resize")}else if(this.__resizeLines[i].orientation===TcHmiScopeControl_1.Orientation.Vertical&&x>=this.__resizeLines[i].startPoint.x-5&&x<=this.__resizeLines[i].endPoint.x+5)return void this.__elementChartings.css("cursor","ew-resize")}if(this.__showTriggerWindow){let boundingRect=e.target.getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY,e.target),x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Left){let widthTriggerWindow=this.__elementTriggerWindow.outerWidth()+5;x>=widthTriggerWindow&&x<=widthTriggerWindow+5?this.__elementTemplateRoot.css("cursor","ew-resize"):this.__elementTemplateRoot.css("cursor","")}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Right){let widthChartings=this.__elementChartings.outerWidth()+5;x>=widthChartings&&x<=widthChartings+5?this.__elementTemplateRoot.css("cursor","ew-resize"):this.__elementTemplateRoot.css("cursor","")}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Top){let heightTriggerWindow=this.__elementTriggerWindow.outerHeight()+5;y>=heightTriggerWindow&&y<=heightTriggerWindow+5?this.__elementTemplateRoot.css("cursor","ns-resize"):this.__elementTemplateRoot.css("cursor","")}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Bottom){let heightBeforeTriggerWindow=5+this.__elementMenuBar.outerHeight()+5+this.__elementChartings.outerHeight()+5+this.__elementLegend.outerHeight();y>=heightBeforeTriggerWindow&&y<=heightBeforeTriggerWindow+5?this.__elementTemplateRoot.css("cursor","ns-resize"):this.__elementTemplateRoot.css("cursor","")}}else this.__elementTemplateRoot.css("cursor","");if(this.__scopeGraphWindow&&this.__scopeGraphWindow.liveState)return;let target=e.target;if(target.className.includes("tchmi-chart-canvas-zooming")){let parentElement=target.parentElement;if(parentElement){let boundingRect=parentElement.getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY),x=coords.x-boundingRect.left,y=coords.y-boundingRect.top,index=-1;if(parentElement===this.__elementOverview[0])return;if(index=Array.prototype.slice.call(this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart")).indexOf(parentElement),-1!==index&&x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height){if(this.__scopeLayout.showTooltip&&this.__scopeGraphData&&this.__scopeGraphData.charts)for(let i=0,ii=this.__scopeGraphData.charts.length;i<ii;i++)if(i===index&&this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].graphs)for(let key in this.__scopeGraphData.charts[i].graphs){let graph=this.__scopeGraphData.charts[i].graphs[key];if(graph){let tooltipDelta=graph.tooltipDelta,axesData=graph.axesData;if(axesData){if(axesData.filter((item=>x>=item.x-tooltipDelta&&x<=item.x+tooltipDelta&&y>=item.y-tooltipDelta&&y<=item.y+tooltipDelta)).length>0)return void this.__elementChartings.css("cursor","pointer")}}}if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomXY)return void this.__elementChartings.css("cursor","crosshair");if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomY)return void this.__elementChartings.css("cursor","crosshair");if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomX)return void this.__elementChartings.css("cursor","crosshair");if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanXY)return void this.__elementChartings.css("cursor","move");if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanY)return void this.__elementChartings.css("cursor","ns-resize");if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanX)return void this.__elementChartings.css("cursor","ew-resize")}}}}}}__onMouseMoveOverview(){return e=>{if(!this.getIsEnabled())return;if(!this.__overviewRectangle)return void this.__elementOverview.css("cursor","");let coords=this.__transformEventCoords(e.offsetX,e.offsetY);if(coords.x>=this.__overviewRectangle.position.x-3&&coords.x<=this.__overviewRectangle.position.x+3&&coords.y>=this.__overviewRectangle.position.y&&coords.y<=this.__overviewRectangle.position.y+this.__overviewRectangle.dimensions.height)this.__elementOverview.css("cursor","ew-resize");else if(coords.x>=this.__overviewRectangle.position.x+this.__overviewRectangle.dimensions.width-3&&coords.x<=this.__overviewRectangle.position.x+this.__overviewRectangle.dimensions.width+3&&coords.y>=this.__overviewRectangle.position.y&&coords.y<=this.__overviewRectangle.position.y+this.__overviewRectangle.dimensions.height)this.__elementOverview.css("cursor","ew-resize");else if(coords.x>=this.__overviewRectangle.position.x+3&&coords.x<=this.__overviewRectangle.position.x+this.__overviewRectangle.dimensions.width-3&&coords.y>=this.__overviewRectangle.position.y&&coords.y<=this.__overviewRectangle.position.y+this.__overviewRectangle.dimensions.height)this.__elementOverview.css("cursor","move");else{if(this.__scopeGraphData&&this.__scopeGraphData.overview&&this.__scopeGraphData.overview.trigger)for(let i=0,ii=this.__scopeGraphData.overview.trigger.length;i<ii;i++)if(0===this.__scopeGraphData.overview.trigger[i].dimensions.width&&coords.x>=this.__scopeGraphData.overview.trigger[i].position.x-5&&coords.x<=this.__scopeGraphData.overview.trigger[i].position.x+5)return void this.__elementOverview.css("cursor","pointer");this.__elementOverview.css("cursor","")}}}__onMouseUpOverview(){return e=>{if(TcHmi.Access.checkAccess(this,"operate")&&!this.__manipulationInfo.isManipulating&&this.getIsEnabled()&&this.__scopeGraphWindow&&!this.__scopeGraphWindow.liveState&&this.__scopeGraphData&&this.__scopeGraphData.overview&&this.__scopeGraphData.overview.trigger){let coords=this.__transformEventCoords(e.offsetX,e.offsetY);for(let i=0,ii=this.__scopeGraphData.overview.trigger.length;i<ii;i++)if(0===this.__scopeGraphData.overview.trigger[i].dimensions.width&&coords.x>=this.__scopeGraphData.overview.trigger[i].position.x-5&&coords.x<=this.__scopeGraphData.overview.trigger[i].position.x+5){let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ClickOverviewElement",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,clickPoint:{x:coords.x,y:coords.y}}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__clickOverviewElementRequestId),this.__clickOverviewElementRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}}}__onMouseUp(){return e=>{this.__manipulationInfo.isManipulating&&this.getIsEnabled()&&this.__userInteractionEnd()}}__onMouseWheel(){return e=>{if(!TcHmi.Access.checkAccess(this,"operate"))return;if(this.__manipulationInfo.isManipulating||this.__multitouchInfo.multitouchMode)return;if(!this.getIsEnabled())return;if(null!==this.__wheelRequestId)return;e.preventDefault();let boundingRect=e.target.getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY,e.target),parentElement=e.currentTarget.parentElement;if(parentElement){let index=-1;if(parentElement!==this.__elementOverview[0]&&(index=Array.prototype.slice.call(this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart")).indexOf(parentElement)),this.__scopeLayout&&index>-1){let x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;if(x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height){let delta;switch(this.__wheelInfo.isWheeling=!0,this.__wheelInfo.mousePosition={x:x,y:y},e.deltaMode){case WheelEvent.DOM_DELTA_PAGE:delta=800*-e.deltaY;break;case WheelEvent.DOM_DELTA_LINE:delta=40*-e.deltaY;break;case WheelEvent.DOM_DELTA_PIXEL:default:delta=-e.deltaY}if(delta=Math.max(-1,Math.min(1,delta)),this.__wheelInfo.wheelSteps=this.__wheelInfo.wheelSteps+delta,this.__wheelInfo.timeout)return;let __this=this;this.__wheelInfo.timeout=setTimeout((function(){if((null!==__this.__subscriptionId||__this.__scopeConfigToFile)&&__this.__mouseMode){let scopeConfig=__this.__scopeConfig;__this.__scopeConfigToFile&&(scopeConfig=__this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:__this.__serverDomain+".Wheel",writeValue:{controlName:__this.__id,scopeConfig:scopeConfig,wheel:{chartIndex:index,delta:__this.__wheelInfo.wheelSteps,mouseMode:TcHmiScopeControl_1.MouseMode[__this.__mouseMode],mousePosition:{x:x,y:y}}}}]};__this.__loadingSpinner&&__this.__elementLoading[0].appendChild(__this.__loadingSpinner),__this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(__this.__wheelRequestId),__this.__wheelRequestId=TcHmi.Server.requestEx(request,{parallel:!0},__this.__getDataCallback())}__this.__wheelInfo.timeout&&(clearTimeout(__this.__wheelInfo.timeout),__this.__wheelInfo.timeout=0),__this.__wheelInfo={isWheeling:!1,wheelSteps:0,mousePosition:{x:0,y:0},timeout:0}}),300)}}}}}__onTouchStart(){return e=>{if(!TcHmi.Access.checkAccess(this,"operate"))return;if(this.__tooltipTimeout&&(clearTimeout(this.__tooltipTimeout),this.__tooltipTimeout=null,this.__elementTooltip.css({visibility:"hidden",top:"0px",left:"0px"})),!this.getIsEnabled())return;e.preventDefault(),this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!1};let boundingRect=e.target.getBoundingClientRect(),touch=e.touches[0],coords=this.__transformEventCoords(touch.clientX,touch.clientY,e.target);if(this.__manipulationInfo.isManipulating)return;let parentElement=e.currentTarget.parentElement;if(parentElement){let index=-1;if(parentElement!==this.__elementOverview[0]&&(index=Array.prototype.slice.call(this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart")).indexOf(parentElement)),this.__scopeLayout){let x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;if(this.__scopeLayout.showTooltip&&index>-1&&this.__scopeGraphWindow&&!this.__scopeGraphWindow.liveState&&x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height&&this.__scopeGraphData&&this.__scopeGraphData.charts)for(let i=0,ii=this.__scopeGraphData.charts.length;i<ii;i++)if(i===index&&this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].graphs)for(let key in this.__scopeGraphData.charts[i].graphs){let graph=this.__scopeGraphData.charts[i].graphs[key];if(graph){let tooltipDelta=graph.tooltipDelta;if(graph.axesData.filter((item=>x>=item.x-tooltipDelta&&x<=item.x+tooltipDelta&&y>=item.y-tooltipDelta&&y<=item.y+tooltipDelta)).length>0){this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y};let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:this.__serverDomain+".GetTooltip",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,chartIndex:index,mousePosition:{x:x,y:y}}}]};return this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__getTooltipRequestId),void(this.__getTooltipRequestId=TcHmi.Server.requestEx(request,{timeout:1e4},this.__getDataCallback()))}}}if(-1===index)this.__scopeLayout.overview&&x>=this.__scopeLayout.overview.canvas.position.x&&x<=this.__scopeLayout.overview.canvas.position.x+this.__scopeLayout.overview.canvas.dimensions.width&&y>=this.__scopeLayout.overview.canvas.position.y&&y<=this.__scopeLayout.overview.canvas.position.y+this.__scopeLayout.overview.canvas.dimensions.height&&(this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y},this.__userInteractionStart(x,y,index));else{if(this.__scopeGraphWindow&&this.__scopeGraphWindow.liveState)return;x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height&&(this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y},this.__userInteractionStart(x,y,index))}}}}}__onTouchMove(){return e=>{if(!this.getIsEnabled())return;if(!this.__manipulationInfo.isManipulating)return;let touch=e.touches[0],coords=this.__transformEventCoords(touch.clientX,touch.clientY),x=coords.x-this.__manipulationInfo.offset.left,y=coords.y-this.__manipulationInfo.offset.top;Math.sqrt(Math.pow(this.__manipulationInfo.mousePosition.x-x,2)+Math.pow(this.__manipulationInfo.mousePosition.y-y,2))>5&&this.__userInteractionMove(x,y)}}__onTouchEnd(){return e=>{if(!this.getIsEnabled())return;if(this.__manipulationInfo.isManipulating)return;let touch=e.changedTouches[0],coords=this.__transformEventCoords(touch.clientX,touch.clientY),x=coords.x-this.__manipulationInfo.offset.left,y=coords.y-this.__manipulationInfo.offset.top;Math.sqrt(Math.pow(this.__manipulationInfo.mousePosition.x-x,2)+Math.pow(this.__manipulationInfo.mousePosition.y-y,2))>5?this.__userInteractionEnd():this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!1}}}__userInteractionStart(x,y,position){if(this.__scopeLayout)if(-1===position){if(this.__scopeLayout.overview&&this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect){if(x<this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x-3||x>this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+this.__scopeGraphWindow.overviewRect.dimensions.width+3||y<this.__scopeLayout.overview.canvas.position.y||y>this.__scopeLayout.overview.canvas.position.y+this.__scopeGraphWindow.overviewRect.dimensions.height)return void(this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!1});x>=this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x-3&&x<=this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+3?(this.__manipulationInfo.isOverviewSizeChanged=!0,this.__manipulationInfo.beginOverviewRectChanging=!0):x>=this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+this.__scopeGraphWindow.overviewRect.dimensions.width-3&&x<=this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+this.__scopeGraphWindow.overviewRect.dimensions.width+3&&(this.__manipulationInfo.isOverviewSizeChanged=!0,this.__manipulationInfo.beginOverviewRectChanging=!1),this.__manipulationInfo.start.x=x,this.__manipulationInfo.start.y=y,this.__manipulationInfo.end.x=x,this.__manipulationInfo.end.y=y,this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.transform={x:0,y:0},this.__manipulationInfo.elementIndex=position}}else{let offsetTop=this.__scopeLayout.charts[position].canvas.position.y,offsetLeft=this.__scopeLayout.charts[position].canvas.position.x,xLineWidth=this.__scopeLayout.charts[position].canvas.dimensions.width,yLineHeight=this.__scopeLayout.charts[position].canvas.dimensions.height;if(x<offsetLeft||x>offsetLeft+xLineWidth||y<offsetTop||y>offsetTop+yLineHeight)return;this.__mouseMode!==TcHmiScopeControl_1.MouseMode.ZoomX&&this.__mouseMode!==TcHmiScopeControl_1.MouseMode.ZoomXY&&this.__mouseMode!==TcHmiScopeControl_1.MouseMode.ZoomY||(this.__manipulationInfo.start.x=x,this.__manipulationInfo.start.y=y,this.__manipulationInfo.end.x=x,this.__manipulationInfo.end.y=y,this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomX?(this.__manipulationInfo.start.y=offsetTop,this.__manipulationInfo.end.y=offsetTop):this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomY&&(this.__manipulationInfo.start.x=offsetLeft,this.__manipulationInfo.end.x=offsetLeft)),this.__mouseMode!==TcHmiScopeControl_1.MouseMode.PanX&&this.__mouseMode!==TcHmiScopeControl_1.MouseMode.PanXY&&this.__mouseMode!==TcHmiScopeControl_1.MouseMode.PanY||(this.__manipulationInfo.start.x=x,this.__manipulationInfo.start.y=y,this.__manipulationInfo.end.x=x,this.__manipulationInfo.end.y=y),this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.transform={x:0,y:0},this.__manipulationInfo.elementIndex=position}}__userInteractionMove(x,y){if(this.__manipulationInfo.chartSizeChanged){let dX=this.__manipulationInfo.end.x-this.__manipulationInfo.start.x,dY=this.__manipulationInfo.end.y-this.__manipulationInfo.start.y;const canvasBorderElem=this.__elementBorder[0];let contextBorderElem=canvasBorderElem.getContext("2d");if(contextBorderElem&&this.__scopeLayout){if(contextBorderElem.clearRect(0,0,canvasBorderElem.width,canvasBorderElem.height),-1===this.__resizeLines[this.__manipulationInfo.resizeLineIndex].chartIndex){this.__themeChartForegroundColor&&this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.Theme?contextBorderElem.strokeStyle=this.__themeChartForegroundColor:contextBorderElem.strokeStyle=this.__scopeLayout.foregroundColor,contextBorderElem.lineWidth=2,contextBorderElem.beginPath();let i=this.__manipulationInfo.resizeLineIndex;if(this.__scopeLayout.overview){let overviewElemHeight=this.__scopeLayout.overview.dimensions.height+dY,overviewMinHeight=this.__scopeLayout.overview.preferredSize.height,positionFromFirstChart=this.__chartingElements[0].position().top,chartsElemHeight=canvasBorderElem.height-positionFromFirstChart-dY,chartsMinHeight=10,newdY=overviewElemHeight>=overviewMinHeight?dY:overviewMinHeight-this.__scopeLayout.overview.dimensions.height;newdY=chartsElemHeight>=chartsMinHeight?newdY:canvasBorderElem.height-chartsMinHeight-positionFromFirstChart,contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x,this.__resizeLines[i].startPoint.y+newdY),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x,this.__resizeLines[i].endPoint.y+newdY),contextBorderElem.stroke()}}this.__themeChartForegroundColor&&this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.Theme?contextBorderElem.strokeStyle=this.__themeChartForegroundColor:contextBorderElem.strokeStyle=this.__scopeLayout.foregroundColor,contextBorderElem.lineWidth=1,contextBorderElem.beginPath();for(let i=0,ii=this.__resizeLines.length;i<ii;i++)if(-1!==this.__resizeLines[i].chartIndex)if(i===this.__manipulationInfo.resizeLineIndex)if(TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]===TcHmiScopeControl_1.ChartType.SingleBarChart)if(this.__resizeLines[i].orientation===TcHmiScopeControl_1.Orientation.Horizontal){let resizeLineUnderIndex=this.__resizeLines.slice(0,this.__manipulationInfo.resizeLineIndex),searchedOrientation=this.__resizeLines[this.__manipulationInfo.resizeLineIndex].orientation,allFoundedOrientation=resizeLineUnderIndex.filter((elem=>elem.orientation===searchedOrientation)),indexOfFirstElem=this.__manipulationInfo.elementIndex;0===allFoundedOrientation.length?indexOfFirstElem-=1:indexOfFirstElem=allFoundedOrientation[allFoundedOrientation.length-1].chartIndex;let firstElems=this.__scopeLayout.charts.filter((elem=>elem.position.y===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.y-this.__scopeLayout.charts[indexOfFirstElem].dimensions.height)),secondElems=this.__scopeLayout.charts.filter((elem=>elem.position.y===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.y)),firstElemMinHeight=null;for(let j=0,jj=firstElems.length;j<jj;j++)null!==firstElemMinHeight?firstElems[j].preferredSize.height>firstElemMinHeight&&(firstElemMinHeight=firstElems[j].preferredSize.height):firstElemMinHeight=firstElems[j].preferredSize.height;null===firstElemMinHeight&&(firstElemMinHeight=0);let secondElemMinHeight=null;for(let k=0,kk=secondElems.length;k<kk;k++)null!==secondElemMinHeight?secondElems[k].preferredSize.height>secondElemMinHeight&&(secondElemMinHeight=secondElems[k].preferredSize.height):secondElemMinHeight=secondElems[k].preferredSize.height;null===secondElemMinHeight&&(secondElemMinHeight=0);let newDY=firstElems[0].dimensions.height+dY>=firstElemMinHeight?dY:firstElemMinHeight-firstElems[0].dimensions.height;secondElems.length>0&&(newDY=secondElems[0].dimensions.height-dY>=secondElemMinHeight?newDY:secondElems[0].dimensions.height-secondElemMinHeight),contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x,this.__resizeLines[i].startPoint.y+newDY),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x,this.__resizeLines[i].endPoint.y+newDY)}else{let firstElems=this.__scopeLayout.charts.filter((elem=>elem.position.x===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.x)),secondElems=this.__scopeLayout.charts.filter((elem=>elem.position.x===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.x+this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.width)),firstElemMinWidth=null;for(let j=0,jj=firstElems.length;j<jj;j++)null!==firstElemMinWidth?firstElems[j].preferredSize.width>firstElemMinWidth&&(firstElemMinWidth=firstElems[j].preferredSize.width):firstElemMinWidth=firstElems[j].preferredSize.width;null===firstElemMinWidth&&(firstElemMinWidth=0);let secondElemMinWidth=null;for(let k=0,kk=secondElems.length;k<kk;k++)null!==secondElemMinWidth?secondElems[k].preferredSize.width>secondElemMinWidth&&(secondElemMinWidth=secondElems[k].preferredSize.width):secondElemMinWidth=secondElems[k].preferredSize.width;null===secondElemMinWidth&&(secondElemMinWidth=0);let newDX=firstElems[0].dimensions.width+dX>=firstElemMinWidth?dX:firstElemMinWidth-firstElems[0].dimensions.width;if(secondElems.length>0)newDX=secondElems[0].dimensions.width-dX>=secondElemMinWidth?newDX:secondElems[0].dimensions.width-secondElemMinWidth;else{let elemEndPosition=firstElems[0].position.x+firstElems[0].dimensions.width;elemEndPosition+newDX>this.__scopeLayout.dimensions.width&&(newDX=this.__scopeLayout.dimensions.width-elemEndPosition)}contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x+newDX,this.__resizeLines[i].startPoint.y),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x+newDX,this.__resizeLines[i].endPoint.y)}else{let firstElemHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height+dY,secondElemHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-dY;if(this.__resizeLines[i].orientation===TcHmiScopeControl_1.Orientation.Horizontal){let firstElemMinHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].preferredSize.height,secondElemMinHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].preferredSize.height,newDY=firstElemHeight>=firstElemMinHeight?dY:firstElemMinHeight-this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height;newDY=secondElemHeight>=secondElemMinHeight?newDY:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-secondElemMinHeight,contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x,this.__resizeLines[i].startPoint.y+newDY),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x,this.__resizeLines[i].endPoint.y+newDY)}}else contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x,this.__resizeLines[i].startPoint.y),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x,this.__resizeLines[i].endPoint.y);contextBorderElem.stroke()}}else if(this.__manipulationInfo.resizeTriggerWindow){if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Left){let diff=x-this.__manipulationInfo.start.x,triggerWindowWidth=this.__elementTriggerWindow.outerWidth();this.__elementTemplateRoot.css({"grid-template-columns":triggerWindowWidth+diff+"px auto"}),this.__manipulationInfo.start={x:x,y:y}}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Right){let diff=x-this.__manipulationInfo.start.x,triggerWindowWidth=this.__elementTriggerWindow.outerWidth();this.__elementTemplateRoot.css({"grid-template-columns":"auto "+(triggerWindowWidth-diff)+"px"}),this.__manipulationInfo.start={x:x,y:y}}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Top){let diff=y-this.__manipulationInfo.start.y,triggerWindowHeight=this.__elementTriggerWindow.outerHeight();this.__elementTemplateRoot.css({"grid-template-rows":triggerWindowHeight+diff+"px min-content auto min-content"}),this.__manipulationInfo.start={x:x,y:y}}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Bottom){let diff=y-this.__manipulationInfo.start.y,triggerWindowHeight=this.__elementTriggerWindow.outerHeight();this.__elementTemplateRoot.css({"grid-template-rows":"min-content auto min-content "+(triggerWindowHeight-diff)+"px"}),this.__manipulationInfo.start={x:x,y:y}}}else if(-1===this.__manipulationInfo.elementIndex){if(!(this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect&&this.__scopeLayout&&this.__scopeLayout.overview&&this.__overviewChart))return;let canvas=this.__overviewChart.getCanvasZooming(),context=canvas.getContext("2d");if(null===context)return;let canvasWidth=canvas.width/window.devicePixelRatio,canvasHeight=canvas.height/window.devicePixelRatio,width=x-this.__manipulationInfo.start.x;if(this.__manipulationInfo.isOverviewSizeChanged)if(this.__manipulationInfo.beginOverviewRectChanging){let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width-width;newWidth<5&&(newWidth=5),context.clearRect(0,0,canvasWidth,canvasHeight),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+width,this.__scopeLayout.overview.canvas.position.y,newWidth,this.__scopeGraphWindow.overviewRect.dimensions.height)}else{let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width+width;newWidth<5&&(newWidth=5),context.clearRect(0,0,canvasWidth,canvasHeight),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x,this.__scopeLayout.overview.canvas.position.y,newWidth,this.__scopeGraphWindow.overviewRect.dimensions.height)}else context.clearRect(0,0,canvasWidth,canvasHeight),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+width,this.__scopeLayout.overview.canvas.position.y,this.__scopeGraphWindow.overviewRect.dimensions.width,this.__scopeGraphWindow.overviewRect.dimensions.height)}else if(this.__scopeLayout&&this.__lineCharts){let position=this.__manipulationInfo.elementIndex,lineChart=this.__lineCharts[position];if(lineChart){let canvas=lineChart.getCanvasZooming(),context=canvas.getContext("2d"),canvasWidth=canvas.width/window.devicePixelRatio,canvasHeight=canvas.height/window.devicePixelRatio,offsetTop=this.__scopeLayout.charts[position].canvas.position.y,offsetLeft=this.__scopeLayout.charts[position].canvas.position.x,xLineWidth=this.__scopeLayout.charts[position].canvas.dimensions.width,yLineHeight=this.__scopeLayout.charts[position].canvas.dimensions.height;if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomX||this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomXY||this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomY){if(null===context)return;let width=x-this.__manipulationInfo.start.x,height=0;this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomX?height=yLineHeight:this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomY?(width=xLineWidth,height=y-this.__manipulationInfo.start.y):height=y-this.__manipulationInfo.start.y,context.clearRect(0,0,canvasWidth,canvasHeight),context.beginPath(),context.rect(this.__manipulationInfo.start.x,this.__manipulationInfo.start.y,width,height),context.fillStyle="rgba(51,153,255,0.3)",context.fill(),context.clearRect(0,0,canvasWidth,offsetTop),context.clearRect(0,0,offsetLeft,canvasHeight),context.clearRect(0,canvasHeight,canvasWidth,-(canvasHeight-yLineHeight-offsetTop)),context.clearRect(canvasWidth,0,-(canvasWidth-offsetLeft-xLineWidth),canvasHeight)}if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanX||this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanXY||this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanY){let dX=x-this.__manipulationInfo.end.x,dY=y-this.__manipulationInfo.end.y,drawingCanvas=lineChart.getCanvasDrawing();if(drawingCanvas){let drawingContext=drawingCanvas.getContext("2d");if(null===context||null===drawingContext)return;let canvasWidth=drawingCanvas.width/window.devicePixelRatio,canvasHeight=drawingCanvas.height/window.devicePixelRatio;drawingContext.clearRect(0,0,canvasWidth,canvasHeight),drawingContext.setTransform(1,0,0,1,0,0);let deviceDPI=window.devicePixelRatio;drawingContext.scale(deviceDPI,deviceDPI),this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanXY?(drawingContext.translate(this.__manipulationInfo.transform.x+dX,this.__manipulationInfo.transform.y+dY),this.__manipulationInfo.transform={x:this.__manipulationInfo.transform.x+dX,y:this.__manipulationInfo.transform.y+dY}):this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanY?(drawingContext.translate(0,this.__manipulationInfo.transform.y+dY),this.__manipulationInfo.transform.y=this.__manipulationInfo.transform.y+dY):(drawingContext.translate(this.__manipulationInfo.transform.x+dX,0),this.__manipulationInfo.transform.x=this.__manipulationInfo.transform.x+dX),lineChart.setLineChanged(!0),this.__chartChartColorSource===TcHmiScopeControl_1.ChartColorSource.ScopeConfig?lineChart.draw(this.__scopeLayout.charts[position],null):lineChart.draw(this.__scopeLayout.charts[position],this.__themeCanvasBackgroundColor)}}}}this.__manipulationInfo.end.x=x,this.__manipulationInfo.end.y=y}__userInteractionEnd(){if(this.__manipulationInfo.chartSizeChanged){if(this.__scopeLayout)if(-1===this.__manipulationInfo.elementIndex){const canvasBorderElem=this.__elementBorder[0];if(this.__scopeLayout.overview&&canvasBorderElem){let diff=this.__manipulationInfo.end.y-this.__manipulationInfo.start.y,overviewElemHeight=this.__scopeLayout.overview.dimensions.height+diff,overviewMinHeight=this.__scopeLayout.overview.preferredSize.height,positionFromFirstChart=this.__chartingElements[0].position().top,chartsElemHeight=canvasBorderElem.height-positionFromFirstChart-diff,chartsMinHeight=10,newDiff=overviewElemHeight>=overviewMinHeight?diff:overviewMinHeight-this.__scopeLayout.overview.dimensions.height;if(newDiff=chartsElemHeight>=chartsMinHeight?newDiff:canvasBorderElem.height-chartsMinHeight-positionFromFirstChart,null!==this.__subscriptionId||this.__scopeConfigToFile){let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ResizeCharts",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,resizeOverview:!0,charts:[{chartIndex:-1,width:this.__scopeLayout.overview.dimensions.width,height:this.__scopeLayout.overview.dimensions.height+newDiff}]}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}}else if(TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]===TcHmiScopeControl_1.ChartType.SingleBarChart)if(this.__resizeLines[this.__manipulationInfo.resizeLineIndex].orientation===TcHmiScopeControl_1.Orientation.Horizontal){let diff=this.__manipulationInfo.end.y-this.__manipulationInfo.start.y,resizeLineUnderIndex=this.__resizeLines.slice(0,this.__manipulationInfo.resizeLineIndex),searchedOrientation=this.__resizeLines[this.__manipulationInfo.resizeLineIndex].orientation,allFoundedOrientation=resizeLineUnderIndex.filter((elem=>elem.orientation===searchedOrientation)),indexOfFirstElem=this.__manipulationInfo.elementIndex;0===allFoundedOrientation.length?indexOfFirstElem-=1:indexOfFirstElem=allFoundedOrientation[allFoundedOrientation.length-1].chartIndex;let firstElems=this.__scopeLayout.charts.filter((elem=>elem.position.y===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.y-this.__scopeLayout.charts[indexOfFirstElem].dimensions.height)),secondElems=this.__scopeLayout.charts.filter((elem=>elem.position.y===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.y)),firstElemMinHeight=null;for(let j=0,jj=firstElems.length;j<jj;j++)null!==firstElemMinHeight?firstElems[j].preferredSize.height>firstElemMinHeight&&(firstElemMinHeight=firstElems[j].preferredSize.height):firstElemMinHeight=firstElems[j].preferredSize.height;null===firstElemMinHeight&&(firstElemMinHeight=0);let secondElemMinHeight=null;for(let k=0,kk=secondElems.length;k<kk;k++)null!==secondElemMinHeight?secondElems[k].preferredSize.height>secondElemMinHeight&&(secondElemMinHeight=secondElems[k].preferredSize.height):secondElemMinHeight=secondElems[k].preferredSize.height;null===secondElemMinHeight&&(secondElemMinHeight=0);let newDiff=firstElems[0].dimensions.height+diff>=firstElemMinHeight?diff:firstElemMinHeight-firstElems[0].dimensions.height;if(secondElems.length>0&&(newDiff=secondElems[0].dimensions.height-diff>=secondElemMinHeight?newDiff:secondElems[0].dimensions.height-secondElemMinHeight),0!==newDiff){let charts=[];for(let i=0,ii=firstElems.length;i<ii;i++){let index=this.__scopeLayout.charts.indexOf(firstElems[i]);charts.push({chartIndex:index,width:this.__scopeLayout.charts[index].dimensions.width,height:this.__scopeLayout.charts[index].dimensions.height+newDiff})}for(let l=0,ll=secondElems.length;l<ll;l++){let index=this.__scopeLayout.charts.indexOf(secondElems[l]);charts.push({chartIndex:index,width:this.__scopeLayout.charts[index].dimensions.width,height:this.__scopeLayout.charts[index].dimensions.height-newDiff})}if(null!==this.__subscriptionId||this.__scopeConfigToFile){let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ResizeCharts",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,resizeOverview:!1,charts:charts}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}}else{let diff=this.__manipulationInfo.end.x-this.__manipulationInfo.start.x,firstElems=this.__scopeLayout.charts.filter((elem=>elem.position.x===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.x)),secondElems=this.__scopeLayout.charts.filter((elem=>elem.position.x===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.x+this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.width)),firstElemMinWidth=null;for(let j=0,jj=firstElems.length;j<jj;j++)null!==firstElemMinWidth?firstElems[j].preferredSize.width>firstElemMinWidth&&(firstElemMinWidth=firstElems[j].preferredSize.width):firstElemMinWidth=firstElems[j].preferredSize.width;null===firstElemMinWidth&&(firstElemMinWidth=0);let secondElemMinWidth=null;for(let k=0,kk=secondElems.length;k<kk;k++)null!==secondElemMinWidth?secondElems[k].preferredSize.width>secondElemMinWidth&&(secondElemMinWidth=secondElems[k].preferredSize.width):secondElemMinWidth=secondElems[k].preferredSize.width;null===secondElemMinWidth&&(secondElemMinWidth=0);let newDiff=firstElems[0].dimensions.width+diff>=firstElemMinWidth?diff:firstElemMinWidth-firstElems[0].dimensions.width;if(secondElems.length>0)newDiff=secondElems[0].dimensions.width-diff>=secondElemMinWidth?newDiff:secondElems[0].dimensions.width-secondElemMinWidth;else{let elemEndPosition=firstElems[0].position.x+firstElems[0].dimensions.width;elemEndPosition+newDiff>this.__scopeLayout.dimensions.width&&(newDiff=this.__scopeLayout.dimensions.width-elemEndPosition)}if(0!==newDiff){let charts=[];for(let i=0,ii=firstElems.length;i<ii;i++){let index=this.__scopeLayout.charts.indexOf(firstElems[i]);charts.push({chartIndex:index,width:this.__scopeLayout.charts[index].dimensions.width+newDiff,height:this.__scopeLayout.charts[index].dimensions.height})}for(let l=0,ll=secondElems.length;l<ll;l++){let index=this.__scopeLayout.charts.indexOf(secondElems[l]);charts.push({chartIndex:index,width:this.__scopeLayout.charts[index].dimensions.width-newDiff,height:this.__scopeLayout.charts[index].dimensions.height})}1===charts.length&&0===secondElems.length&&charts.push({chartIndex:0,width:this.__scopeLayout.charts[0].dimensions.width-newDiff,height:this.__scopeLayout.charts[0].dimensions.height});let scopeConfig=this.__scopeConfig;if(this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile),null!==this.__subscriptionId){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ResizeCharts",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,resizeOverview:!1,charts:charts}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}}else{let diff=this.__manipulationInfo.end.y-this.__manipulationInfo.start.y,firstElemHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height+diff,secondElemHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-diff,firstElemMinHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].preferredSize.height,secondElemMinHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].preferredSize.height,newDiff=firstElemHeight>=firstElemMinHeight?diff:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].preferredSize.height-this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height;if(newDiff=secondElemHeight>=secondElemMinHeight?newDiff:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].preferredSize.height,0!==newDiff&&(null!==this.__subscriptionId||this.__scopeConfigToFile)){let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ResizeCharts",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,resizeOverview:!1,charts:[{chartIndex:this.__manipulationInfo.elementIndex-1,width:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.width,height:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height+newDiff},{chartIndex:this.__manipulationInfo.elementIndex,width:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.width,height:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-newDiff}]}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}}else if(this.__manipulationInfo.resizeTriggerWindow)this.__serverSymbolsHelper.setChartSize(!0);else if(-1===this.__manipulationInfo.elementIndex){if(this.__overviewChart){let width=this.__manipulationInfo.end.x-this.__manipulationInfo.start.x;if(this.__manipulationInfo.isOverviewSizeChanged){if((null!==this.__subscriptionId||this.__scopeConfigToFile)&&this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect)if(this.__manipulationInfo.beginOverviewRectChanging){let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width-width,xDirection=0;newWidth<5&&(newWidth=5,xDirection=width-this.__scopeGraphWindow.overviewRect.dimensions.width+5);let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetOverviewRect",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,sizeChanged:{width:newWidth,changedAtBeginning:this.__manipulationInfo.beginOverviewRectChanging},xDirection:xDirection}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__setOverviewRectRequestId),this.__setOverviewRectRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}else{let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width+width;newWidth<5&&(newWidth=5);let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetOverviewRect",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,sizeChanged:{width:newWidth,changedAtBeginning:this.__manipulationInfo.beginOverviewRectChanging}}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__setOverviewRectRequestId),this.__setOverviewRectRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}else if(null!==this.__subscriptionId||this.__scopeConfigToFile){let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetOverviewRect",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,xDirection:width}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__setOverviewRectRequestId),this.__setOverviewRectRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}}else if(this.__scopeLayout&&this.__lineCharts){let position=this.__manipulationInfo.elementIndex,lineChart=this.__lineCharts[position];if(lineChart){if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomX||this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomXY||this.__mouseMode===TcHmiScopeControl_1.MouseMode.ZoomY){let canvas=lineChart.getCanvasZooming(),context=canvas.getContext("2d"),canvasWidth=canvas.width/window.devicePixelRatio,canvasHeight=canvas.height/window.devicePixelRatio;if(context&&context.clearRect(0,0,canvasWidth,canvasHeight),null!==this.__subscriptionId||this.__scopeConfigToFile){let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Zoom",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,zoom:{chartIndex:position,mouseMode:TcHmiScopeControl_1.MouseMode[this.__mouseMode],startPoint:{x:this.__manipulationInfo.start.x,y:this.__manipulationInfo.start.y},endPoint:{x:this.__manipulationInfo.end.x,y:this.__manipulationInfo.end.y}}}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__zoomRequestId),this.__zoomRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}if(this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanX||this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanXY||this.__mouseMode===TcHmiScopeControl_1.MouseMode.PanY){let canvas=lineChart.getCanvasDrawing();if(canvas){let context=canvas.getContext("2d");if(null!==context){context.setTransform(1,0,0,1,0,0);let deviceDPI=window.devicePixelRatio;context.scale(deviceDPI,deviceDPI)}}if(null!==this.__subscriptionId||this.__scopeConfigToFile){let scopeConfig=this.__scopeConfig;this.__scopeConfigToFile&&(scopeConfig=this.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Pan",writeValue:{controlName:this.__id,scopeConfig:scopeConfig,pan:{chartIndex:position,mouseMode:TcHmiScopeControl_1.MouseMode[this.__mouseMode],startPoint:{x:this.__manipulationInfo.start.x,y:this.__manipulationInfo.start.y},endPoint:{x:this.__manipulationInfo.end.x,y:this.__manipulationInfo.end.y}}}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT),TcHmi.Server.releaseRequest(this.__panRequestId),this.__panRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__getDataCallback())}}}}this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0,resizeTriggerWindow:!1}}__showTooltip(tooltipObj){if(!this.__scopeLayout||!this.__elementTooltip||!this.__elementMenuBar)return;this.__elementTooltip.css("visibility","visible"),this.__elementTooltipText[0].textContent=tooltipObj.displayText;let widthTooltip=this.__elementTooltip.outerWidth(),heightTooltip=this.__elementTooltip.outerHeight(),menubarHeight=this.__elementMenuBar.outerHeight()+5,chartPosition=this.__scopeLayout.charts[tooltipObj.chartIndex].position,overviewHeight=0;this.__showOverview&&this.__overviewChart&&(overviewHeight=this.__elementOverview.outerHeight());let triggerWindowHeight=0,triggerWindowWidth=0;if(this.__showTriggerWindow)if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Top){triggerWindowHeight=this.__elementTriggerWindow.outerHeight()+5}else if(this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Left){triggerWindowWidth=this.__elementTriggerWindow.outerWidth()+5}let middlePoint=chartPosition.x+tooltipObj.position.x-widthTooltip/2+5;tooltipObj.position.y+menubarHeight+triggerWindowHeight-heightTooltip+chartPosition.y-4>0?middlePoint>=0&&triggerWindowWidth+middlePoint+widthTooltip<=this.getRenderedWidth()?(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom"),this.__elementTooltip.css({top:tooltipObj.position.y+menubarHeight+triggerWindowHeight-heightTooltip+chartPosition.y+overviewHeight-4,left:triggerWindowWidth+chartPosition.x+tooltipObj.position.x-widthTooltip/2+5})):triggerWindowWidth+tooltipObj.position.x+5+widthTooltip<=this.getRenderedWidth()?(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left"),this.__elementTooltip.css({top:tooltipObj.position.y-heightTooltip/2+chartPosition.y+overviewHeight+menubarHeight+triggerWindowHeight+4,left:triggerWindowWidth+chartPosition.x+tooltipObj.position.x+4})):(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right"),this.__elementTooltip.css({top:tooltipObj.position.y-heightTooltip/2+chartPosition.y+overviewHeight+menubarHeight+triggerWindowHeight+4,left:triggerWindowWidth+chartPosition.x+tooltipObj.position.x-widthTooltip-4})):middlePoint>=0&&triggerWindowWidth+middlePoint+widthTooltip<=this.getRenderedWidth()?(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top"),this.__elementTooltip.css({top:tooltipObj.position.y+12+chartPosition.y+overviewHeight+menubarHeight+triggerWindowHeight,left:triggerWindowWidth+chartPosition.x+middlePoint})):triggerWindowWidth+tooltipObj.position.x+4+widthTooltip<=this.getRenderedWidth()?(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left"),this.__elementTooltip.css({top:tooltipObj.position.y-heightTooltip/2+chartPosition.y+overviewHeight+menubarHeight+triggerWindowHeight+4,left:triggerWindowWidth+chartPosition.x+tooltipObj.position.x+4})):(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right"),this.__elementTooltip.css({top:tooltipObj.position.y-heightTooltip/2+chartPosition.y+overviewHeight+menubarHeight+triggerWindowHeight+4,left:chartPosition.x+tooltipObj.position.x-widthTooltip-4}));let __this=this;this.__tooltipTimeout=setTimeout((function(){__this.__elementTooltip.css({visibility:"hidden",top:"0px",left:"0px"})}),Beckhoff.TcHmiScopeHelpers.ScopeHelper.__isoToMilliSec(tooltipObj.timeoutMS))}startRecord(recordTime){this.__serverSymbolsHelper.startRecord(recordTime)}stopRecord(){this.__serverSymbolsHelper.stopRecord()}startDisplay(){this.__serverSymbolsHelper.startDisplay()}stopDisplay(){this.__serverSymbolsHelper.stopDisplay()}zoomToDefault(){this.__serverSymbolsHelper.zoomToDefault()}zoomOutMax(){this.__serverSymbolsHelper.zoomOutMax()}goTo(goTo){this.__serverSymbolsHelper.goTo(goTo)}setDisplayWidth(displayWidth){this.__serverSymbolsHelper.setDisplayWidth(displayWidth)}scroll(direction){this.__serverSymbolsHelper.scroll(direction)}scrollBig(direction){this.__serverSymbolsHelper.scrollBig(direction)}undo(){this.__serverSymbolsHelper.undo()}redo(){this.__serverSymbolsHelper.redo()}setOverviewMode(){this.__serverSymbolsHelper.setOverviewMode()}setMouseMode(valueNew){this.__serverSymbolsHelper.setMouseMode(valueNew)}getMouseMode(){return this.__mouseMode===TcHmiScopeControl_1.MouseMode.None?null:TcHmiScopeControl_1.MouseMode[this.__mouseMode]}setScopeConfig(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ScopeConfig"));let resolverInfo=this.__objectResolvers.get("scopeConfig");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue,this);this.__objectResolvers.set("scopeConfig",{resolver:resolver,watchCallback:this.__onResolverForScopeConfigWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForScopeConfigWatchCallback)})}__onResolverForScopeConfigWatchCallback=data=>{!1===this.__isAttached&&data.destroy&&this.__suspendObjectResolver("scopeConfig"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__scopeConfig)||(this.__oldScopeConfig=this.__scopeConfig,this.__scopeConfig=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ScopeConfig"}),this.__processScopeConfig()):TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type}${TcHmiScopeControl.#tchmiFQN!==this.__type?", Origin="+TcHmiScopeControl.#tchmiFQN:""}, Id=${this.getId()}, Attribute=ScopeConfig] Resolving symbols from object faield with error: `+TcHmi.Log.buildMessage(data.details))};getScopeConfig(){return this.__scopeConfig}__processScopeConfig(){if(TCHMI_DESIGNER){const designerMessage=this.__element.find(".tchmi-designer-control-message")[0]??document.createElement("div");return designerMessage.classList.add("tchmi-designer-control-message"),this.__scopeConfig?(this.__localizedEngineeringElements.delete("Engineering_Not_Configured"),designerMessage.innerHTML=this.__scopeConfig.name+"::"+this.__scopeConfig.chart):(designerMessage.innerHTML="Engineering_Not_Configured",this.__localizedEngineeringElements.set("Engineering_Not_Configured",designerMessage),this.__localizationReader&&(designerMessage.innerHTML=this.__localizationReader.get("Engineering_Not_Configured"))),void this.__element[0].appendChild(designerMessage)}this.__isAttached&&(this.__activeLegendElements=void 0,this.__serverSymbolsHelper.closeConnection(this.__oldScopeConfig),this.__openWebsocket())}setServerInterval(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ServerInterval")),convertedValue!==this.__serverInterval&&(this.__serverInterval=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ServerInterval"}),this.__processServerInterval())}getServerInterval(){return this.__serverInterval}__processServerInterval(){this.__isAttached&&null!==this.__subscriptionId&&this.__resubscribe(!0)}setServerDomain(valueNew){let convertedValue=TcHmi.ValueConverter.toString(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ServerDomain")),tchmi_equal(convertedValue,this.__serverDomain)||(this.__serverDomain=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ServerDomain"}),this.__processServerDomain())}getServerDomain(){return this.__serverDomain}__processServerDomain(){if(this.__isAttached){if(this.__clearFullControl(),this.__scopeLayout=void 0,this.__scopeGraphData=void 0,this.__menubar=void 0,this.__legend=void 0,this.__scopeGraphWindow=null,this.__enabledButtons=TcHmiScopeControl_1.ButtonsEnabled.None,this.__enabledTimes=TcHmiScopeControl_1.TimesEnabled.None,this.__configEventsDestroyEvent?.(),this.__configEventsDestroyEvent=null,null!==this.__subscriptionIdOnExtensionStateChanged&&(TcHmi.Server.unsubscribe(this.__subscriptionIdOnExtensionStateChanged,null),this.__subscriptionIdOnExtensionStateChanged=null),this.__serverDomain&&(this.__configEventsDestroyEvent=TcHmi.Server.Events.registerConsumer([{path:"domain",comparator:"==",value:this.__serverDomain},{logic:"AND"},{path:"payload",comparator:"contains",value:"configType"},{logic:"OR"},{path:"payload::type",comparator:"==",value:"general"}],{subscription:this.__configEventCallback()})),this.__scopeEventsDestroyEvent?.(),this.__scopeEventsDestroyEvent=null,this.__serverDomain){let symbol="ListDomains";this.__subscriptionIdOnExtensionStateChanged=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbol}],300,this.__onExtensionStateChanged()),this.__sessionId&&this.__socketId&&(this.__scopeIsInitialized=!1,this.__scopeEventsDestroyEvent=TcHmi.Server.Events.registerConsumer([{path:"domain",comparator:"==",value:this.__serverDomain},{logic:"AND"},{path:"payload::sessionId",comparator:"==",value:this.__sessionId},{logic:"AND"},{path:"payload::socketId",comparator:"==",value:this.__socketId}],{subscription:this.__scopeEventCallback()},this.__eventRegisterDoneCallback()))}let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Init",writeValue:{controlName:this.__id}},{commandOptions:["SendErrorMessage"],symbol:"GetSymbolAccess",writeValue:this.__serverDomain+".GetAllUploadedRecords"}]};TcHmi.Server.releaseRequest(this.__initRequestId),this.__initRequestId=TcHmi.Server.requestEx(request,null,this.__initCallback()),this.__openWebsocket()}}setEnableRecordControls(valueNew){let convertedValue=TcHmi.ValueConverter.toBoolean(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("EnableRecordControls")),convertedValue!==this.__enableRecordControls&&(this.__enableRecordControls=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"EnableRecordControls"}),this.__processEnableRecordControls())}getEnableRecordControls(){return this.__enableRecordControls}__processEnableRecordControls(){if(this.__isAttached){if(this.__enableRecordControls){if(null===(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton"))){let buttonStopControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__id}_StopRecordButton`,{"data-tchmi-is-enabled":!1,"data-tchmi-virtual-control-right-mappings":this.__virtualMappingForControlRecord},this);if(!buttonStopControl)throw new Error("Needed Button could not be instantiated");buttonStopControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-StopRecordButton"),buttonStopControl.getElement().prependTo(this.__elementToolBar),this.__toolBarControls.StopRecordButton=buttonStopControl,this.__toolBarControlsArray.unshift(buttonStopControl),this.__destroyEvents.StopRecordButton=TcHmi.EventProvider.register(this.__id+"_StopRecordButton.onPressed",this.__onPressed())}if(null===(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton"))){let buttonStartControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__id}_StartRecordButton`,{"data-tchmi-is-enabled":!1,"data-tchmi-virtual-control-right-mappings":this.__virtualMappingForControlRecord},this);if(!buttonStartControl)throw new Error("Needed Button could not be instantiated");buttonStartControl.getElement()[0].classList.add("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-StartRecordButton"),buttonStartControl.getElement().prependTo(this.__elementToolBar),this.__toolBarControls.StartRecordButton=buttonStartControl,this.__toolBarControlsArray.unshift(buttonStartControl),this.__destroyEvents.StartRecordButton=TcHmi.EventProvider.register(this.__id+"_StartRecordButton.onPressed",this.__onPressed())}}else{if(null!==(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StartRecordButton"))){const elem=this.__toolBarControls.StartRecordButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.StartRecordButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.StartRecordButton),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StartRecordButton}if(null!==(this.__elementToolBar[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+tchmi_css_escape_selector(this.__id)+"_StopRecordButton"))){const elem=this.__toolBarControls.StopRecordButton;elem&&elem.destroy();const destroyEvent=this.__destroyEvents.StopRecordButton;destroyEvent&&(destroyEvent(),delete this.__destroyEvents.StopRecordButton),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StopRecordButton}}this.__calcMenuButtons(),this.__scopeGraphWindow&&this.__scopeLayout?this.__enableOrDisableMenuControls(this.__scopeGraphWindow.scopeState,this.__scopeGraphWindow.liveState,this.__scopeGraphWindow.undo,this.__scopeGraphWindow.redo,TcHmiScopeControl_1.ChartType[this.__scopeLayout.chartType]):this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl_1.ChartType.YT)}}setChartColorSource(valueNew){let convertedValue=TcHmi.ValueConverter.toEnum(valueNew,TcHmiScopeControl_1.ChartColorSource)??TcHmi.ValueConverter.toEnum(this.getAttributeDefaultValueInternal("ChartColorSource"),TcHmiScopeControl_1.ChartColorSource,TcHmiScopeControl_1.ChartColorSource.ScopeConfig);convertedValue!==this.__chartChartColorSource&&(this.__chartChartColorSource=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ChartColorSource"}),this.__processChartColorSource())}getChartColorSource(){if(void 0!==this.__chartChartColorSource)return TcHmiScopeControl_1.ChartColorSource[this.__chartChartColorSource]}__processChartColorSource(){this.__isAttached&&this.__drawLineChart()}setTriggerWindowPosition(valueNew){let convertedValue=TcHmi.ValueConverter.toEnum(valueNew,TcHmiScopeControl_1.TriggerWindowPosition);null===convertedValue&&(convertedValue=TcHmi.ValueConverter.toEnum(this.getAttributeDefaultValueInternal("TriggerWindowPosition"),TcHmiScopeControl_1.TriggerWindowPosition,TcHmiScopeControl_1.TriggerWindowPosition.Left)),convertedValue!==this.__triggerWindowPosition&&(this.__triggerWindowPosition=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"TriggerWindowPosition"}),this.__processTriggerWindowPosition())}getTriggerWindowPosition(){return this.__triggerWindowPosition}__processTriggerWindowPosition(){this.__elementTemplateRoot.css({"grid-template-columns":"","grid-template-rows":""}),this.__elementTriggerWindow[0].classList.toggle("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-window-right",this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Right),this.__elementTriggerWindow[0].classList.toggle("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-window-left",this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Left),this.__elementTriggerWindow[0].classList.toggle("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-window-bottom",this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Bottom),this.__elementTriggerWindow[0].classList.toggle("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-window-top",this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Top),this.__elementTemplateRoot[0].classList.toggle("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-none",!this.__showTriggerWindow),this.__elementTemplateRoot[0].classList.toggle("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-right",this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Right&&this.__showTriggerWindow),this.__elementTemplateRoot[0].classList.toggle("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-left",this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Left&&this.__showTriggerWindow),this.__elementTemplateRoot[0].classList.toggle("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-bottom",this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Bottom&&this.__showTriggerWindow),this.__elementTemplateRoot[0].classList.toggle("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-trigger-top",this.__triggerWindowPosition===TcHmiScopeControl_1.TriggerWindowPosition.Top&&this.__showTriggerWindow),this.__isAttached&&this.__serverSymbolsHelper.setChartSize(!0)}setShowTriggerWindow(valueNew){let convertedValue=TcHmi.ValueConverter.toBoolean(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ShowTriggerWindow")),convertedValue!==this.__showTriggerWindow&&(this.__showTriggerWindow=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowTriggerWindow"}),this.__processShowTriggerWindow())}getShowTriggerWindow(){return this.__showTriggerWindow}__processShowTriggerWindow(){this.__elementTemplateRoot.css({"grid-template-columns":"","grid-template-rows":""}),this.__showTriggerWindow?(this.__elementTriggerWindow.css({display:""}),this.__toolBarControls.TriggerWindowButton&&this.__toolBarControls.TriggerWindowButton.setToggleState("Active")):(this.__elementTriggerWindow.css({display:"none"}),this.__toolBarControls.TriggerWindowButton&&this.__toolBarControls.TriggerWindowButton.setToggleState("Normal"),null!==this.__subscriptionIdTriggerWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdTriggerWindow,null),this.__subscriptionIdTriggerWindow=null)),this.__isAttached&&(this.__processTriggerWindowPosition(),this.__showTriggerWindow&&this.__unsubscribeTriggerWindow())}}TcHmiScopeControl_1.TcHmiScopeControl=TcHmiScopeControl}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("TcHmiScopeControl","TcHmi.Controls.Beckhoff.TcHmiScopeControl",TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){!function(Charting){class ScopeChart{__elementRoot;__canvasFrame;__canvasDrawing;__canvasZooming;__canvasMarker;__contextFrame;__contextDrawing;__contextZooming;__contextMarker;__yAxis=[];__xAxis=[];__grid=[];__subgrid=[];__trigger=[];__xyTrigger=[];__axisGroupForegroundColor="";__lineGraph=new Map;__hasChanged;__lineChanged;constructor(elementRoot,canvasWidth,canvasHeight){this.__elementRoot=elementRoot,this.__hasChanged=!1,this.__lineChanged=!1,this.__initCanvas(canvasWidth,canvasHeight)}addXAxis(xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){if(this.__canvasFrame){let xAxis=new Charting.XAxis(this.__xAxis.length+1,this.__canvasFrame,xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor);return this.__xAxis.push(xAxis),this.__hasChanged=!0,xAxis}return null}addXAxisAtPosition(index,xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){if(this.__canvasFrame){let xAxis=new Charting.XAxis(this.__xAxis.length+1,this.__canvasFrame,xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor);this.__xAxis.splice(index,0,xAxis),this.__hasChanged=!0}}deleteXAxis(index){this.__xAxis.splice(index,1),this.setHasChanged(!0)}deleteAllXAxis(){this.__xAxis=[],this.setHasChanged(!0)}addYAxis(yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){if(this.__canvasFrame){let yAxis=new Charting.YAxis(this.__yAxis.length+1,this.__canvasFrame,yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor);this.__yAxis.push(yAxis),this.__hasChanged=!0}}addYAxisAtPosition(index,yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){if(this.__canvasFrame){let yAxis=new Charting.YAxis(this.__yAxis.length+1,this.__canvasFrame,yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor);this.__yAxis.splice(index,0,yAxis),this.__hasChanged=!0}}deleteYAxis(index){this.__yAxis.splice(index,1),this.setHasChanged(!0)}deleteAllYAxis(){this.__yAxis=[],this.setHasChanged(!0)}addGrid(xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor){if(this.__canvasFrame){let grid=new Charting.Grid(this.__canvasFrame,xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor);this.__grid.push(grid),this.__hasChanged=!0}}addGridAtPosition(index,xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor){if(this.__canvasFrame){let grid=new Charting.Grid(this.__canvasFrame,xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor);this.__grid.splice(index,0,grid),this.__hasChanged=!0}}deleteGrid(index){this.__grid.splice(index,1),this.setHasChanged(!0)}deleteAllGrids(){this.__grid=[],this.setHasChanged(!0)}addSubgrid(xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor){if(this.__canvasFrame){let subgrid=new Charting.Subgrid(this.__canvasFrame,xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor);this.__subgrid.push(subgrid),this.__hasChanged=!0}}addSubgridAtPosition(index,xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor){if(this.__canvasFrame){let subgrid=new Charting.Subgrid(this.__canvasFrame,xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor);this.__subgrid.splice(index,0,subgrid),this.__hasChanged=!0}}deleteSubgrid(index){this.__subgrid.splice(index,1),this.setHasChanged(!0)}deleteAllSubgrids(){this.__subgrid=[],this.setHasChanged(!0)}addTrigger(triggerData){if(this.__canvasMarker){let __trigger=new Charting.Trigger(this.__canvasMarker,triggerData);this.__trigger.push(__trigger),this.__hasChanged=!0}}addTriggerAtPosition(index,triggerData){if(this.__canvasMarker){let __trigger=new Charting.Trigger(this.__canvasMarker,triggerData);this.__trigger.splice(index,0,__trigger),this.__hasChanged=!0}}deleteTrigger(index){this.__trigger.splice(index,1),this.setHasChanged(!0)}deleteAllTriggers(){this.__trigger=[],this.setHasChanged(!0)}addXYTrigger(xyTriggerData){if(this.__canvasMarker){let xyTrigger=new Charting.XYTrigger(this.__canvasMarker,xyTriggerData);this.__xyTrigger.push(xyTrigger),this.__hasChanged=!0}}addXYTriggerAtPosition(index,xyTriggerData){if(this.__canvasMarker){let xyTrigger=new Charting.XYTrigger(this.__canvasMarker,xyTriggerData);this.__xyTrigger.splice(index,0,xyTrigger),this.__hasChanged=!0}}deleteXYTrigger(index){this.__xyTrigger.splice(index,1),this.setHasChanged(!0)}deleteAllXYTriggers(){this.__xyTrigger=[],this.setHasChanged(!0)}addLineGraph(graphLayout,gridSize){if(this.__canvasDrawing&&this.__lineGraph&&graphLayout){let graph=new Beckhoff.TcHmiScopeControl.Charting.LineGraph(this.__canvasDrawing,graphLayout,gridSize);this.__lineGraph.set(graphLayout.graphName,graph),this.__lineChanged=!0}}deleteAllLineGraphs(){this.__lineGraph.clear(),this.__lineChanged=!0}remove(){this.__canvasFrame&&this.__canvasFrame.parentNode&&this.__canvasFrame.remove(),this.__canvasDrawing&&this.__canvasDrawing.parentNode&&this.__canvasDrawing.remove(),this.__canvasMarker&&this.__canvasMarker.parentNode&&this.__canvasMarker.remove(),this.__canvasZooming&&this.__canvasZooming.parentNode&&this.__canvasZooming.remove(),this.deleteAllGrids(),this.deleteAllSubgrids(),this.deleteAllYAxis(),this.deleteAllXAxis(),this.deleteAllLineGraphs(),this.deleteAllTriggers(),this.deleteAllXYTriggers()}clear(width,height){let deviceDPI=window.devicePixelRatio;width*=deviceDPI,height*=deviceDPI,this.__canvasFrame&&this.__contextFrame&&(this.__contextFrame.clearRect(0,0,this.__canvasFrame.width,this.__canvasFrame.height),this.__canvasFrame.width=width,this.__canvasFrame.height=height,this.__contextFrame.scale(deviceDPI,deviceDPI)),this.__canvasDrawing&&this.__contextDrawing&&(this.__contextDrawing.setTransform(1,0,0,1,0,0),this.__contextDrawing.clearRect(0,0,this.__canvasDrawing.width,this.__canvasDrawing.height),this.__canvasDrawing.width=width,this.__canvasDrawing.height=height,this.__contextDrawing.scale(deviceDPI,deviceDPI)),this.__canvasMarker&&this.__contextMarker&&(this.__contextMarker.clearRect(0,0,this.__canvasMarker.width,this.__canvasMarker.height),this.__canvasMarker.width=width,this.__canvasMarker.height=height,this.__contextMarker.scale(deviceDPI,deviceDPI)),this.__canvasZooming&&this.__contextZooming&&(this.__contextZooming.clearRect(0,0,this.__canvasZooming.width,this.__canvasZooming.height),this.__canvasZooming.width=width,this.__canvasZooming.height=height,this.__contextZooming.scale(deviceDPI,deviceDPI)),this.deleteAllGrids(),this.deleteAllSubgrids(),this.deleteAllYAxis(),this.deleteAllXAxis(),this.deleteAllLineGraphs(),this.deleteAllTriggers(),this.deleteAllXYTriggers()}getYAxis(){return this.__yAxis}getYAxisAtPosition(index){return this.__yAxis[index]}getXAxis(){return this.__xAxis}getXAxisAtPosition(index){return this.__xAxis[index]}getGrid(){return this.__grid}getGridAtPosition(index){return this.__grid[index]}getSubgrid(){return this.__subgrid}getSubgridAtPosition(index){return this.__subgrid[index]}getTriggerAtPosition(index){return this.__trigger[index]}getTrigger(){return this.__trigger}getXYTriggerAtPosition(index){return this.__xyTrigger[index]}getXYTrigger(){return this.__xyTrigger}getLineGraph(){return this.__lineGraph}getLineGraphWithName(name){return this.__lineGraph.get(name)}getCanvasDrawing(){return this.__canvasDrawing}getCanvasFrame(){return this.__canvasFrame}getCanvasZooming(){return this.__canvasZooming}getCanvasMarker(){return this.__canvasMarker}getHasChanged(){return this.__hasChanged}__initCanvas(canvasWidth,canvasHeight){let deviceDPI=window.devicePixelRatio,canvas=document.createElement("canvas"),width=(canvasWidth*deviceDPI).toString(),height=(canvasHeight*deviceDPI).toString();canvas.setAttribute("height",height),canvas.setAttribute("width",width),canvas.setAttribute("class","tchmi-chart-canvas-frame"),canvas.setAttribute("style","position:absolute;width:100%;height:100%;"),canvas.style.backgroundColor="transparent",this.__elementRoot.append(canvas),this.__canvasFrame=canvas,this.__contextFrame=this.__canvasFrame.getContext("2d"),this.__contextFrame&&this.__contextFrame.scale(deviceDPI,deviceDPI);let canvasDrawing=document.createElement("canvas");canvasDrawing.setAttribute("height",height),canvasDrawing.setAttribute("width",width),canvasDrawing.setAttribute("class","tchmi-chart-canvas-drawing"),canvasDrawing.style.backgroundColor="transparent",canvasDrawing.setAttribute("style","position:absolute;width:100%;height:100%;"),this.__elementRoot.append(canvasDrawing),this.__canvasDrawing=canvasDrawing,this.__contextDrawing=this.__canvasDrawing.getContext("2d"),this.__contextDrawing&&this.__contextDrawing.scale(deviceDPI,deviceDPI);let canvasMarker=document.createElement("canvas");canvasMarker.setAttribute("height",height),canvasMarker.setAttribute("width",width),canvasMarker.setAttribute("class","tchmi-chart-canvas-marker"),canvasMarker.setAttribute("style","position:absolute;width:100%;height:100%;"),this.__elementRoot.append(canvasMarker),this.__canvasMarker=canvasMarker,this.__contextMarker=this.__canvasMarker.getContext("2d"),this.__contextMarker&&this.__contextMarker.scale(deviceDPI,deviceDPI);let canvasZooming=document.createElement("canvas");canvasZooming.setAttribute("height",height),canvasZooming.setAttribute("width",width),canvasZooming.setAttribute("class","tchmi-chart-canvas-zooming"),canvasZooming.setAttribute("style","position:absolute;width:100%;height:100%;"),this.__elementRoot.append(canvasZooming),this.__canvasZooming=canvasZooming,this.__contextZooming=this.__canvasZooming.getContext("2d"),this.__contextZooming&&this.__contextZooming.scale(deviceDPI,deviceDPI)}setHasChanged(hasChanged){this.__hasChanged=hasChanged}setLineChanged(lineChanged){this.__lineChanged=lineChanged}setAxisGroupForegroundColor(axisGroupForegroundColor){this.__axisGroupForegroundColor=axisGroupForegroundColor}draw(layout,themeResourcesCanvasColor){if(this.__canvasFrame&&this.__contextFrame){let canvasWidth=this.__canvasFrame.width/window.devicePixelRatio,canvasHeight=this.__canvasFrame.height/window.devicePixelRatio;if(this.__hasChanged){if(this.__contextFrame&&this.__contextFrame.clearRect(0,0,canvasWidth,canvasHeight),layout.headline){let fontFamily;const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvasFrame,"font-family")["font-family"];fontFamily=inheritedFontfamily||"sans-serif",this.__contextFrame.font=layout.headline.fontSize+"pt "+fontFamily,this.__contextFrame.fillStyle=this.__axisGroupForegroundColor,this.__contextFrame.textAlign="center",this.__contextFrame.textBaseline="top",this.__contextFrame.beginPath(),this.__contextFrame.fillText(layout.headline.label,layout.headline.position.x+layout.headline.dimensions.width/2,layout.headline.position.y)}for(let i=0,ii=this.__xAxis.length;i<ii;i++)this.__xAxis[i].drawAxis();for(let i=0,ii=this.__yAxis.length;i<ii;i++)this.__yAxis[i].drawAxis();this.__contextFrame.fillStyle=themeResourcesCanvasColor||layout.canvas.backgroundColor,this.__contextFrame.fillRect(layout.canvas.position.x,layout.canvas.position.y,layout.canvas.dimensions.width,layout.canvas.dimensions.height);for(let i=0,ii=this.__grid.length;i<ii;i++)this.__grid[i].draw();for(let i=0,ii=this.__subgrid.length;i<ii;i++)this.__subgrid[i].draw();this.__hasChanged=!1}if(this.__lineChanged){if(this.__contextDrawing&&this.__contextDrawing.clearRect(0,0,canvasWidth,canvasHeight),this.__lineGraph.forEach(((graph,key)=>{graph.draw()})),this.__contextDrawing){let transform=this.__contextDrawing.getTransform(),horizontalMove=transform.e/window.devicePixelRatio,verticalMove=transform.f/window.devicePixelRatio;verticalMove>=0?horizontalMove>=0?(this.__contextDrawing.clearRect(-horizontalMove,-verticalMove,canvasWidth+horizontalMove,layout.canvas.position.y+verticalMove),this.__contextDrawing.clearRect(-horizontalMove,canvasHeight-verticalMove,canvasWidth+horizontalMove,-(canvasHeight-layout.canvas.dimensions.height-layout.canvas.position.y)),this.__contextDrawing.clearRect(-horizontalMove,-verticalMove,layout.canvas.position.x+horizontalMove,canvasHeight+verticalMove),this.__contextDrawing.clearRect(canvasWidth-horizontalMove,-verticalMove,-(canvasWidth-layout.canvas.position.x-layout.canvas.dimensions.width),canvasHeight+verticalMove)):(this.__contextDrawing.clearRect(-horizontalMove,-verticalMove,canvasWidth+horizontalMove,layout.canvas.position.y+verticalMove),this.__contextDrawing.clearRect(-horizontalMove,canvasHeight-verticalMove,canvasWidth+horizontalMove,-(canvasHeight-layout.canvas.dimensions.height-layout.canvas.position.y)),this.__contextDrawing.clearRect(-horizontalMove,-verticalMove,layout.canvas.position.x,canvasHeight+verticalMove),this.__contextDrawing.clearRect(canvasWidth-horizontalMove,-verticalMove,-(canvasWidth-layout.canvas.position.x-layout.canvas.dimensions.width-horizontalMove),canvasHeight+verticalMove)):horizontalMove>=0?(this.__contextDrawing.clearRect(-horizontalMove,-verticalMove,canvasWidth+horizontalMove,layout.canvas.position.y),this.__contextDrawing.clearRect(-horizontalMove,canvasHeight-verticalMove,canvasWidth+horizontalMove,-(canvasHeight-layout.canvas.dimensions.height-layout.canvas.position.y-verticalMove)),this.__contextDrawing.clearRect(-horizontalMove,-verticalMove,layout.canvas.position.x+horizontalMove,canvasHeight+verticalMove),this.__contextDrawing.clearRect(canvasWidth-horizontalMove,-verticalMove,-(canvasWidth-layout.canvas.position.x-layout.canvas.dimensions.width),canvasHeight+verticalMove)):(this.__contextDrawing.clearRect(-horizontalMove,-verticalMove,canvasWidth+horizontalMove,layout.canvas.position.y),this.__contextDrawing.clearRect(-horizontalMove,canvasHeight-verticalMove,canvasWidth+horizontalMove,-(canvasHeight-layout.canvas.dimensions.height-layout.canvas.position.y-verticalMove)),this.__contextDrawing.clearRect(-horizontalMove,-verticalMove,layout.canvas.position.x,canvasHeight+verticalMove),this.__contextDrawing.clearRect(canvasWidth-horizontalMove,-verticalMove,-(canvasWidth-layout.canvas.position.x-layout.canvas.dimensions.width-horizontalMove),canvasHeight+verticalMove))}this.__contextMarker&&this.__contextMarker.clearRect(0,0,canvasWidth,canvasHeight);for(const xyTrigger of this.__xyTrigger)xyTrigger.draw();if(this.__contextMarker){let transform=this.__contextMarker.getTransform(),horizontalMove=transform.e/window.devicePixelRatio,verticalMove=transform.f/window.devicePixelRatio;this.__contextMarker.clearRect(-horizontalMove,-verticalMove,canvasWidth+horizontalMove,layout.canvas.position.y),this.__contextMarker.clearRect(-horizontalMove,canvasHeight-verticalMove,canvasWidth+horizontalMove,-(canvasHeight-layout.canvas.position.y-layout.canvas.dimensions.height)),this.__contextMarker.clearRect(-horizontalMove,-verticalMove,layout.canvas.position.x,canvasHeight),this.__contextMarker.clearRect(canvasWidth-horizontalMove,-verticalMove,-(canvasWidth-layout.canvas.position.x-layout.canvas.dimensions.width),canvasHeight)}for(const trigger of this.__trigger)trigger.draw();this.__lineChanged=!1}}}}Charting.ScopeChart=ScopeChart,function(ScopeChart){let LineStyle;!function(LineStyle){LineStyle[LineStyle.Dotted=0]="Dotted",LineStyle[LineStyle.Dashed=1]="Dashed",LineStyle[LineStyle.Solid=2]="Solid"}(LineStyle=ScopeChart.LineStyle||(ScopeChart.LineStyle={}))}(ScopeChart=Charting.ScopeChart||(Charting.ScopeChart={}))}(TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){!function(Charting){Charting.Grid=class{__canvas;__context;__xAxisLayout;__yAxisLayout;__gridSize;__themeResourcesGridColor=null;constructor(canvas,xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor){this.__canvas=canvas,this.__context=canvas.getContext("2d"),this.__xAxisLayout=xAxisLayout,this.__yAxisLayout=yAxisLayout,this.__gridSize=gridSize,this.__themeResourcesGridColor=themeResourcesGridColor}draw(){if(this.__context&&this.__gridSize){if(this.__context.globalAlpha=1,this.__xAxisLayout&&void 0!==this.__xAxisLayout.grid&&this.__xAxisLayout.grid.visible){this.__themeResourcesGridColor?this.__context.strokeStyle=this.__themeResourcesGridColor:this.__context.strokeStyle=this.__xAxisLayout.grid.color,this.__context.lineWidth=this.__xAxisLayout.grid.lineWidth,this.__context.lineCap="butt",1!==this.__xAxisLayout.grid.lineWidth?this.__context.setLineDash([this.__xAxisLayout.grid.lineWidth,this.__xAxisLayout.grid.lineWidth]):this.__context.setLineDash([this.__xAxisLayout.grid.lineWidth,2]),this.__context.beginPath();let yStart=this.__gridSize.position.y;if(1===this.__xAxisLayout.grid.ticks)this.__context.moveTo((0|this.__gridSize.position.x)+(this.__xAxisLayout.grid.lineWidth%2==0?0:.5),(yStart+(this.__xAxisLayout.grid.lineWidth/2|0)|0)-(this.__xAxisLayout.grid.lineWidth%2==0?0:.5)),this.__context.lineTo((0|this.__gridSize.position.x)+(this.__xAxisLayout.grid.lineWidth%2==0?0:.5),yStart+this.__gridSize.dimensions.height-(this.__xAxisLayout.grid.lineWidth/2|0)|0);else{let xDiff=this.__gridSize.dimensions.width/(this.__xAxisLayout.grid.ticks-1),xStart=this.__gridSize.position.x;for(let i=0;i<this.__xAxisLayout.grid.ticks;i++)this.__context.moveTo((0|xStart)+(this.__xAxisLayout.grid.lineWidth%2==0?0:.5),(0|yStart)-(this.__xAxisLayout.grid.lineWidth%2==0?0:.5)),this.__context.lineTo((0|xStart)+(this.__xAxisLayout.grid.lineWidth%2==0?0:.5),yStart+this.__gridSize.dimensions.height|0),xStart+=xDiff}this.__context.stroke()}if(this.__yAxisLayout&&void 0!==this.__yAxisLayout.grid&&this.__yAxisLayout.grid.visible){this.__themeResourcesGridColor?this.__context.strokeStyle=this.__themeResourcesGridColor:this.__context.strokeStyle=this.__yAxisLayout.grid.color,this.__context.lineWidth=this.__yAxisLayout.grid.lineWidth,this.__context.lineCap="butt",1!==this.__yAxisLayout.grid.lineWidth?this.__context.setLineDash([this.__yAxisLayout.grid.lineWidth,this.__yAxisLayout.grid.lineWidth]):this.__context.setLineDash([this.__yAxisLayout.grid.lineWidth,2]),this.__context.beginPath();let width=this.__gridSize.dimensions.width;if(1===this.__yAxisLayout.grid.ticks)this.__context.moveTo(0|this.__gridSize.position.x,(this.__gridSize.position.y+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.grid.lineWidth%2==0?0:.5)),this.__context.lineTo(this.__gridSize.position.x+width|0,(this.__gridSize.position.y+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.grid.lineWidth%2==0?0:.5));else{let yDiff=this.__gridSize.dimensions.height/(this.__yAxisLayout.grid.ticks-1),yStart=this.__gridSize.position.y;for(let i=0;i<this.__yAxisLayout.grid.ticks;i++)this.__context.moveTo(0|this.__gridSize.position.x,(yStart+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.grid.lineWidth%2==0?0:.5)),this.__context.lineTo(this.__gridSize.position.x+width|0,(yStart+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.grid.lineWidth%2==0?0:.5)),yStart-=yDiff}this.__context.stroke()}}}}}(TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){!function(Charting){Charting.Subgrid=class{__canvas;__context;__xAxisLayout;__yAxisLayout;__gridSize;__themeResourcesSubgridColor=null;constructor(canvas,xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor){this.__canvas=canvas,this.__context=canvas.getContext("2d"),this.__xAxisLayout=xAxisLayout,this.__yAxisLayout=yAxisLayout,this.__gridSize=gridSize,this.__themeResourcesSubgridColor=themeResourcesSubgridColor}draw(){if(this.__context&&this.__gridSize){let xBegin=this.__gridSize.position.x;if(this.__context.globalAlpha=1,this.__xAxisLayout&&this.__xAxisLayout.subGrid&&this.__xAxisLayout.grid&&this.__xAxisLayout.subGrid.visible){let xDiffSubgrid=this.__gridSize.dimensions.width/(this.__xAxisLayout.grid.ticks-1)/(this.__xAxisLayout.subGrid.ticks+1);this.__themeResourcesSubgridColor?this.__context.strokeStyle=this.__themeResourcesSubgridColor:this.__context.strokeStyle=this.__xAxisLayout.subGrid.color,this.__context.lineWidth=this.__xAxisLayout.subGrid.lineWidth,this.__context.lineCap="butt",this.__context.setLineDash([2,2]),this.__context.beginPath();let yStart=this.__gridSize.position.y,xStart=this.__gridSize.position.x+xDiffSubgrid;for(let j=0;j<this.__xAxisLayout.grid.ticks-1;j++){for(let i=0;i<this.__xAxisLayout.subGrid.ticks;i++)this.__context.moveTo((0|xStart)+(this.__xAxisLayout.subGrid.lineWidth%2==0?0:.5),yStart+(this.__xAxisLayout.grid.lineWidth/2|0)|0),this.__context.lineTo((0|xStart)+(this.__xAxisLayout.subGrid.lineWidth%2==0?0:.5),(yStart+this.__gridSize.dimensions.height+(this.__xAxisLayout.grid.lineWidth/2|0)|0)-(this.__xAxisLayout.subGrid.lineWidth%2==0?0:.5)),xStart+=xDiffSubgrid;xStart+=xDiffSubgrid}this.__context.stroke()}if(this.__yAxisLayout&&this.__yAxisLayout.subGrid&&this.__yAxisLayout.grid&&this.__yAxisLayout.subGrid.visible){let yDiffSubgrid=this.__gridSize.dimensions.height/(this.__yAxisLayout.grid.ticks-1)/(this.__yAxisLayout.subGrid.ticks+1);this.__themeResourcesSubgridColor?this.__context.strokeStyle=this.__themeResourcesSubgridColor:this.__context.strokeStyle=this.__yAxisLayout.subGrid.color,this.__context.lineWidth=this.__yAxisLayout.subGrid.lineWidth,this.__context.lineCap="butt",this.__context.setLineDash([2,2]),this.__context.beginPath();let yStart=this.__gridSize.position.y-yDiffSubgrid;for(let j=0;j<this.__yAxisLayout.grid.ticks-1;j++){for(let i=0;i<this.__yAxisLayout.subGrid.ticks;i++)this.__context.moveTo((xBegin-(this.__yAxisLayout.grid.lineWidth/2|0)|0)+(this.__yAxisLayout.subGrid.lineWidth%2==0?0:.5),(yStart+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.subGrid.lineWidth%2==0?0:.5)),this.__context.lineTo((xBegin-(this.__yAxisLayout.grid.lineWidth/2|0)+this.__gridSize.dimensions.width|0)+(this.__yAxisLayout.subGrid.lineWidth%2==0?0:.5),(yStart+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.subGrid.lineWidth%2==0?0:.5)),yStart-=yDiffSubgrid;yStart-=yDiffSubgrid}this.__context.stroke()}}}}}(TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){!function(Charting){Charting.XAxis=class{__labelFontFamily=null;__labelFontSize=null;__labelFontSizeUnit=null;__labelFontWeight=null;__axisNameFontFamily=null;__axisNameFontSize=null;__axisNameFontSizeUnit=null;__axisNameFontWeight=null;__xAxisLayout;__id;__canvas;__context;__themeResourcesHeadlineColor=null;__themeResourcesAxisColor=null;constructor(id,canvas,xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){this.__canvas=canvas,this.__context=this.__canvas.getContext("2d"),this.__xAxisLayout=xAxisLayout,this.__themeResourcesHeadlineColor=themeResourcesHeadlineColor,this.__themeResourcesAxisColor=themeResourcesAxisColor,this.__id=id}drawAxis(){let fontFamily;const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-family")["font-family"];if(fontFamily=inheritedFontfamily||"sans-serif",this.__context&&this.__xAxisLayout){if(this.__context.lineCap="butt",this.__context.globalAlpha=1,this.__xAxisLayout.headline&&(this.__context.font=this.__xAxisLayout.headline.fontSize+"pt "+fontFamily,this.__themeResourcesHeadlineColor?this.__context.fillStyle=this.__themeResourcesHeadlineColor:this.__context.fillStyle=this.__xAxisLayout.headline.color,this.__context.textAlign="center",this.__context.textBaseline="middle",this.__context.beginPath(),this.__context.fillText(this.__xAxisLayout.headline.label,this.__xAxisLayout.headline.position.x+this.__xAxisLayout.headline.dimensions.width/2,this.__xAxisLayout.headline.position.y+this.__xAxisLayout.headline.dimensions.height/2,this.__xAxisLayout.headline.dimensions.width),this.__context.stroke()),this.__xAxisLayout.labels&&this.__xAxisLayout.visibleTicks){for(let i=0;i<this.__xAxisLayout.labels.length;i++)this.__context.font=this.__xAxisLayout.labels[i].fontSize+"pt "+fontFamily,this.__themeResourcesAxisColor?this.__context.fillStyle=this.__themeResourcesAxisColor:this.__context.fillStyle=this.__xAxisLayout.labels[i].color,this.__context.textAlign="center",this.__context.textBaseline="middle",this.__context.beginPath(),this.__context.fillText(this.__xAxisLayout.labels[i].label,this.__xAxisLayout.labels[i].position.x+this.__xAxisLayout.labels[i].dimensions.width/2,this.__xAxisLayout.labels[i].position.y+this.__xAxisLayout.labels[i].dimensions.height/2,this.__xAxisLayout.labels[i].dimensions.width);this.__context.stroke()}if(this.__xAxisLayout.grid&&this.__xAxisLayout.subGrid&&this.__xAxisLayout.visibleTicks){let mainTicks=this.__xAxisLayout.grid.ticks,mainTickLength=5,pixelDiffBetweenMain=this.__xAxisLayout.dimensions.width/(mainTicks-1),startPoint={x:this.__xAxisLayout.position.x,y:this.__xAxisLayout.position.y+mainTickLength};this.__themeResourcesAxisColor?this.__context.strokeStyle=this.__themeResourcesAxisColor:this.__context.strokeStyle=this.__xAxisLayout.color,this.__context.lineWidth=this.__xAxisLayout.lineWidth,this.__context.setLineDash([]),this.__context.beginPath();for(let i=0;i<mainTicks;i++)0===i?(this.__context.moveTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),0|startPoint.y),this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),(startPoint.y-mainTickLength|0)+(this.__xAxisLayout.lineWidth%2==0?0:.5))):i===mainTicks?(startPoint.x=startPoint.x+pixelDiffBetweenMain,this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),(startPoint.y-mainTickLength|0)+(this.__xAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),0|startPoint.y)):(startPoint.x=startPoint.x+pixelDiffBetweenMain,this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),(startPoint.y-mainTickLength|0)+(this.__xAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),0|startPoint.y),this.__context.moveTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),(startPoint.y-mainTickLength|0)+(this.__xAxisLayout.lineWidth%2==0?0:.5)));this.__context.stroke()}}}getId(){return this.__id}}}(TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){!function(Charting){Charting.YAxis=class{__labelFontFamily=null;__labelFontSize=null;__labelFontSizeUnit=null;__labelFontWeight=null;__axisNameFontFamily=null;__axisNameFontSize=null;__axisNameFontSizeUnit=null;__axisNameFontWeight=null;__yAxisLayout;__id;__canvas;__context;__themeResourcesHeadlineColor=null;__themeResourcesAxisColor=null;constructor(id,canvas,yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){this.__canvas=canvas,this.__context=this.__canvas.getContext("2d"),this.__yAxisLayout=yAxisLayout,this.__themeResourcesHeadlineColor=themeResourcesHeadlineColor,this.__themeResourcesAxisColor=themeResourcesAxisColor,this.__id=id}drawAxis(){let fontFamily;const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-family")["font-family"];if(fontFamily=inheritedFontfamily||"sans-serif",null!==this.__context&&this.__yAxisLayout){if(this.__context.lineCap="butt",this.__context.globalAlpha=1,this.__yAxisLayout.headline){this.__context.font=this.__yAxisLayout.headline.fontSize+"pt "+fontFamily,this.__themeResourcesHeadlineColor?this.__context.fillStyle=this.__themeResourcesHeadlineColor:this.__context.fillStyle=this.__yAxisLayout.headline.color,this.__context.beginPath(),this.__context.textAlign="center",this.__context.textBaseline="middle",this.__context.translate(this.__yAxisLayout.headline.position.x+this.__yAxisLayout.headline.dimensions.width/2,this.__yAxisLayout.headline.position.y+this.__yAxisLayout.headline.dimensions.height/2),this.__context.rotate(-.5*Math.PI),this.__context.fillText(this.__yAxisLayout.headline.label,0,0),this.__context.stroke(),this.__context.setTransform(1,0,0,1,0,0);let deviceDPI=window.devicePixelRatio;this.__context.scale(deviceDPI,deviceDPI)}if(this.__yAxisLayout.labels&&this.__yAxisLayout.visibleTicks){for(let i=0;i<this.__yAxisLayout.labels.length;i++){let lines=this.__yAxisLayout.labels[i].label.split("\n");this.__context.font=this.__yAxisLayout.labels[i].fontSize+"pt "+fontFamily,this.__themeResourcesAxisColor?this.__context.fillStyle=this.__themeResourcesAxisColor:this.__context.fillStyle=this.__yAxisLayout.labels[i].color,this.__context.textAlign="right",this.__context.textBaseline="middle",this.__context.beginPath();for(let j=0,jj=lines.length;j<jj;j++)0===j&&lines.length>1?this.__context.textBaseline="bottom":j>0&&lines.length>1&&(this.__context.textBaseline="top"),this.__context.fillText(lines[j],this.__yAxisLayout.labels[i].position.x+this.__yAxisLayout.labels[i].dimensions.width,this.__yAxisLayout.labels[i].position.y+this.__yAxisLayout.labels[i].dimensions.height/2,this.__yAxisLayout.labels[i].dimensions.width)}this.__context.stroke()}if(this.__yAxisLayout.grid&&this.__yAxisLayout.subGrid&&this.__yAxisLayout.visibleTicks){let mainTicks=this.__yAxisLayout.grid.ticks,mainTickLength=5,pixelDiffBetweenMain=this.__yAxisLayout.dimensions.height/(mainTicks-1),startPoint={x:this.__yAxisLayout.position.x,y:this.__yAxisLayout.position.y+this.__yAxisLayout.dimensions.height};this.__themeResourcesAxisColor?this.__context.strokeStyle=this.__themeResourcesAxisColor:this.__context.strokeStyle=this.__yAxisLayout.color,this.__context.lineWidth=this.__yAxisLayout.lineWidth,this.__context.setLineDash([]),this.__context.beginPath();for(let i=0;i<mainTicks;i++)0===i?(this.__context.moveTo(startPoint.x+this.__yAxisLayout.dimensions.width-mainTickLength|0,(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo((startPoint.x+this.__yAxisLayout.dimensions.width|0)+(this.__yAxisLayout.lineWidth%2==0?0:.5),(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5))):i===mainTicks-1?(startPoint.y=startPoint.y-pixelDiffBetweenMain,this.__context.lineTo((startPoint.x+this.__yAxisLayout.dimensions.width|0)+(this.__yAxisLayout.lineWidth%2==0?0:.5),(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo(startPoint.x+this.__yAxisLayout.dimensions.width-mainTickLength|0,(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5))):(startPoint.y=startPoint.y-pixelDiffBetweenMain,this.__context.lineTo((startPoint.x+this.__yAxisLayout.dimensions.width|0)+(this.__yAxisLayout.lineWidth%2==0?0:.5),(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo(startPoint.x+this.__yAxisLayout.dimensions.width-mainTickLength|0,(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)),this.__context.moveTo((startPoint.x+this.__yAxisLayout.dimensions.width|0)+(this.__yAxisLayout.lineWidth%2==0?0:.5),(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)));this.__context.stroke()}}}getId(){return this.__id}}}(TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){!function(Charting){Charting.Trigger=class{__fontFamily=null;__fontSize=null;__fontSizeUnit=null;__fontWeight=null;__canvas;__context;__triggerData=null;constructor(canvas,triggerData){this.__canvas=canvas,this.__context=this.__canvas.getContext("2d"),this.__triggerData=triggerData}draw(){let fontFamily;const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-family")["font-family"];if(fontFamily=inheritedFontfamily||"sans-serif",this.__context&&this.__triggerData&&(this.__context.lineCap="butt",this.__context.globalAlpha=1,TcHmiScopeControl.Orientation[this.__triggerData.orientation]===TcHmiScopeControl.Orientation.Vertical)){if(this.__context.setLineDash([]),this.__context.lineWidth=this.__triggerData.lineWidth,this.__context.strokeStyle=this.__triggerData.color,this.__context.beginPath(),this.__context.moveTo(this.__triggerData.position.x,this.__triggerData.position.y),this.__context.lineTo(this.__triggerData.position.x,this.__triggerData.position.y+this.__triggerData.dimensions.height),this.__triggerData.text&&(this.__context.fillStyle=this.__triggerData.text.backgroundColor,this.__context.fillRect(this.__triggerData.text.position.x,this.__triggerData.text.position.y,this.__triggerData.text.dimensions.width,this.__triggerData.text.dimensions.height),this.__context.font=this.__triggerData.text.fontSize+"pt "+fontFamily,this.__context.fillStyle=this.__triggerData.text.color,this.__context.textAlign="center",this.__context.textBaseline="middle",this.__context.fillText(this.__triggerData.text.text,this.__triggerData.text.position.x+this.__triggerData.text.dimensions.width/2,this.__triggerData.text.position.y+this.__triggerData.text.dimensions.height/2,this.__triggerData.text.dimensions.width)),this.__triggerData.label){this.__context.font=this.__triggerData.label.fontSize+"pt "+fontFamily,this.__context.fillStyle=this.__triggerData.label.color;let cuttedString=this.getCuttedString(this.__triggerData.label.label,this.__triggerData.dimensions.height);"Right"===this.__triggerData.label.position?(this.__context.textAlign="end",this.__context.textBaseline="top",this.__context.translate(this.__triggerData.position.x,this.__triggerData.position.y),this.__context.rotate(-.5*Math.PI),this.__context.translate(-this.__triggerData.position.x,-this.__triggerData.position.y),this.__context.fillText(cuttedString,this.__triggerData.position.x,this.__triggerData.position.y)):cuttedString===this.__triggerData.label.label?(this.__context.textAlign="start",this.__context.textBaseline="bottom",this.__context.translate(this.__triggerData.position.x,this.__triggerData.position.y+this.__triggerData.dimensions.height),this.__context.rotate(-.5*Math.PI),this.__context.translate(-this.__triggerData.position.x,-(this.__triggerData.position.y+this.__triggerData.dimensions.height)),this.__context.fillText(cuttedString,this.__triggerData.position.x,this.__triggerData.position.y+this.__triggerData.dimensions.height)):(this.__context.textAlign="end",this.__context.textBaseline="bottom",this.__context.translate(this.__triggerData.position.x,this.__triggerData.position.y),this.__context.rotate(-.5*Math.PI),this.__context.translate(-this.__triggerData.position.x,-this.__triggerData.position.y),this.__context.fillText(cuttedString,this.__triggerData.position.x,this.__triggerData.position.y)),this.__context.setTransform(1,0,0,1,0,0);let deviceDPI=window.devicePixelRatio;this.__context.scale(deviceDPI,deviceDPI)}if(this.__triggerData.icon){let triggerIcon=TcHmiScopeControl.TcHmiScopeControl.triggerImages.get(this.__triggerData.icon.icon);if(triggerIcon)this.__context.drawImage(triggerIcon,this.__triggerData.icon.position.x,this.__triggerData.icon.position.y,this.__triggerData.icon.dimensions.width,this.__triggerData.icon.dimensions.height);else{let image=new Image;image.src=tchmi_path(this.__triggerData.icon.icon);let __this=this;image.onload=function(){__this.__context&&__this.__triggerData&&__this.__triggerData.icon&&(TcHmiScopeControl.TcHmiScopeControl.triggerImages.set(__this.__triggerData.icon.icon,image),__this.__context.drawImage(image,__this.__triggerData.icon.position.x,__this.__triggerData.icon.position.y,__this.__triggerData.icon.dimensions.width,__this.__triggerData.icon.dimensions.height))}}}this.__context.stroke()}}getCuttedString(str,maxWidth){if(this.__context){let allWidth=this.__context.measureText(str).width;if(allWidth<=maxWidth)return str;{let len=str.length;for(;allWidth>maxWidth;)str=str.substring(1,len),allWidth=this.__context.measureText(str).width;return str}}return str}}}(TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){!function(Charting){Charting.XYTrigger=class{__fontFamily=null;__fontSize=null;__fontSizeUnit=null;__fontWeight=null;__canvas;__context;__xyTriggerData=null;constructor(canvas,triggerData){this.__canvas=canvas,this.__context=this.__canvas.getContext("2d"),this.__xyTriggerData=triggerData}draw(){this.__context&&this.__xyTriggerData&&(this.__context.lineCap="butt",this.__context.globalAlpha=1,this.__context.setLineDash([]),this.__context.lineWidth=this.__xyTriggerData.lineWidth,this.__context.strokeStyle=this.__xyTriggerData.color,this.__context.beginPath(),this.__xyTriggerData.circle&&this.__context.arc(this.__xyTriggerData.circle.middlePoint.x,this.__xyTriggerData.circle.middlePoint.y,this.__xyTriggerData.circle.diameter/2,0,2*Math.PI),this.__xyTriggerData.marker&&(this.__context.moveTo(this.__xyTriggerData.marker.horizontal.point1.x,this.__xyTriggerData.marker.horizontal.point1.y),this.__context.lineTo(this.__xyTriggerData.marker.horizontal.point2.x,this.__xyTriggerData.marker.horizontal.point2.y),this.__context.moveTo(this.__xyTriggerData.marker.vertical.point1.x,this.__xyTriggerData.marker.vertical.point1.y),this.__context.lineTo(this.__xyTriggerData.marker.vertical.point2.x,this.__xyTriggerData.marker.vertical.point2.y)),this.__context.stroke())}}}(TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){!function(Charting){Charting.LineGraph=class{__canvas;__context;__points=null;__zeroPoint=null;__lineSeries=null;__graphLayout;__gridSizeLayout;constructor(canvas,graphLayout,gridSize){this.__canvas=canvas,this.__context=this.__canvas.getContext("2d"),this.__graphLayout=graphLayout,this.__gridSizeLayout=gridSize}draw(){if(this.__context&&this.__canvas&&this.__points&&this.__points.length>0&&this.__graphLayout){if(this.__graphLayout.lineColor&&this.__graphLayout.lineWidth)if(this.__context.strokeStyle=this.__graphLayout.lineColor,this.__context.lineWidth=this.__graphLayout.lineWidth,this.__context.lineCap="butt",this.__context.globalAlpha=1,this.__context.setLineDash([]),this.__graphLayout.graphType===TcHmiScopeControl.GraphType.Bar){if(this.__zeroPoint){this.__context.beginPath();for(let i=0,ii=this.__points.length;i<ii;i++)this.__context.moveTo(this.__points[i].x,this.__zeroPoint.y),this.__context.lineTo(this.__points[i].x,this.__points[i].y);this.__context.stroke()}}else if(this.__graphLayout.graphType===TcHmiScopeControl.GraphType.ExtendedLine&&this.__lineSeries){this.__context.save();let start=0,end=this.__points.length,current="";for(let i=0,ii=this.__lineSeries.length;i<ii&&!(this.__lineSeries[i].index>=this.__points.length);i++){let lineStates=this.__lineSeries[i].lineStates.filter((ls=>1===parseInt(ls[14],16))),next=0===lineStates.length?"":lineStates[0];""!==next&&next!==current&&(this.__lineSeries[i].index>start&&(end=this.__lineSeries[i].index,this.__renderLineSegment(start,end,current)),start=this.__lineSeries[i].index,current=next)}start<this.__points.length-1&&this.__renderLineSegment(start,this.__points.length-1,current)}else if(this.__graphLayout.graphType===TcHmiScopeControl.GraphType.RoundShape){if(this.__points.length>=7){let startAngle=Math.ceil(Math.atan2(this.__points[5].y-this.__points[0].y,this.__points[5].x-this.__points[0].x)*(180/Math.PI)),sweepAngle=Math.ceil(Math.atan2(this.__points[6].y-this.__points[0].y,this.__points[6].x-this.__points[0].x)*(180/Math.PI));this.__context.beginPath(),startAngle===sweepAngle?this.__context.ellipse(this.__points[0].x,this.__points[0].y,(this.__points[1].x-this.__points[3].x)/2,(this.__points[4].y-this.__points[2].y)/2,0,0,2*Math.PI):(this.__context.ellipse(this.__points[0].x,this.__points[0].y,(this.__points[1].x-this.__points[3].x)/2,(this.__points[4].y-this.__points[2].y)/2,0,startAngle*Math.PI/180,sweepAngle*Math.PI/180,!0),this.__graphLayout.fillColor&&this.__graphLayout.fillTransparency&&(this.__context.moveTo(this.__points[5].x,this.__points[5].y),this.__context.lineTo(this.__points[0].x,this.__points[0].y),this.__context.lineTo(this.__points[6].x,this.__points[6].y))),this.__context.stroke()}}else{this.__context.beginPath();for(let i=0,ii=this.__points.length;i<ii;i++)0===i?this.__context.moveTo(this.__points[i].x,this.__points[i].y):(this.__graphLayout.graphType===TcHmiScopeControl.GraphType.Stair&&this.__context.lineTo(this.__points[i].x,this.__points[i-1].y),this.__context.lineTo(this.__points[i].x,this.__points[i].y));this.__context.stroke()}if(this.__graphLayout.fillColor&&this.__graphLayout.fillTransparency)if(this.__context.lineWidth=0,this.__context.fillStyle=this.__graphLayout.fillColor,this.__context.strokeStyle=this.__graphLayout.lineColor,this.__context.globalAlpha=this.__graphLayout.fillTransparency/255,this.__graphLayout.graphType===TcHmiScopeControl.GraphType.ExtendedLine&&this.__lineSeries){this.__context.save();let start=this.__points.length-1,end=0,current="1";for(let i=this.__lineSeries.length-1,ii=0;i>=ii;i--)this.__lineSeries[i].lineStates.filter((ls=>2===parseInt(ls[14],16)))&&(current=this.__lineSeries[i].lineStates.filter((ls=>2===parseInt(ls[14],16)))[0],end=this.__lineSeries[i].index,this.__renderFillSegment(start,end,current),start=end);start>0&&this.__renderFillSegment(start,this.__points.length-1,current)}else if(this.__graphLayout.fillMode===TcHmiScopeControl.FillMode.FromTop)this.__context.lineTo(this.__points[this.__points.length-1].x,this.__gridSizeLayout.position.y),this.__context.lineTo(this.__points[0].x,this.__gridSizeLayout.position.y),this.__context.lineTo(this.__points[0].x,this.__points[0].y),this.__context.fill();else if(this.__graphLayout.fillMode===TcHmiScopeControl.FillMode.FromBottom)this.__context.lineTo(this.__points[this.__points.length-1].x,this.__gridSizeLayout.position.y+this.__gridSizeLayout.dimensions.height),this.__context.lineTo(this.__points[0].x,this.__gridSizeLayout.position.y+this.__gridSizeLayout.dimensions.height),this.__context.lineTo(this.__points[0].x,this.__points[0].y),this.__context.fill();else if(this.__graphLayout.fillMode===TcHmiScopeControl.FillMode.FromHorizontalZero)this.__zeroPoint&&(this.__context.lineTo(this.__points[this.__points.length-1].x,this.__zeroPoint.y),this.__context.lineTo(this.__points[0].x,this.__zeroPoint.y),this.__context.fill());else if(this.__graphLayout.fillMode===TcHmiScopeControl.FillMode.FromCenter){if(this.__zeroPoint)for(let i=0,ii=this.__points.length-1;i<ii;i++)this.__context.beginPath(),this.__context.moveTo(this.__points[i].x,this.__points[i].y),this.__context.lineTo(this.__points[i+1].x,this.__points[i+1].y),this.__context.lineTo(this.__zeroPoint.x,this.__zeroPoint.y),this.__context.closePath(),this.__context.fill()}else this.__graphLayout.fillMode===TcHmiScopeControl.FillMode.FromSource?(this.__context.lineTo(this.__points[0].x,this.__points[0].y),this.__context.fill("evenodd")):this.__graphLayout.fillMode===TcHmiScopeControl.FillMode.FromFirst&&this.__context.fill();if(this.__graphLayout.markWidth&&this.__graphLayout.markColor&&(this.__context.strokeStyle=this.__graphLayout.markColor,this.__context.lineWidth=this.__graphLayout.markWidth,this.__context.lineCap="square",this.__context.globalAlpha=1,this.__context.setLineDash([]),this.__graphLayout.marks))if(this.__graphLayout.graphType===TcHmiScopeControl.GraphType.ExtendedLine&&this.__lineSeries){this.__context.save();let start=0,end=this.__points.length,current="1";for(let i=0,ii=this.__lineSeries.length;i<ii;i++)this.__lineSeries[i].lineStates.filter((ls=>4===parseInt(ls[14],16)))&&(this.__lineSeries[i].index>start&&(end=this.__lineSeries[i].index,parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.Invisible||this.__renderMarkSegment(start,end-1,current)),start=this.__lineSeries[i].index,current=this.__lineSeries[i].lineStates.filter((ls=>4===parseInt(ls[14],16)))[0]);start<this.__points.length&&this.__renderMarkSegment(start,this.__points.length-1,current)}else{this.__context.beginPath();for(let i=0,ii=this.__points.length;i<ii;i++)this.__context.moveTo(this.__points[i].x,this.__points[i].y),this.__context.lineTo(this.__points[i].x,this.__points[i].y);this.__context.stroke()}if(this.__graphLayout.showStartCap&&this.__graphLayout.capSize&&this.__graphLayout.capColor){let startCapS=this.__points[this.__points.length-2],startCapE=this.__points[this.__points.length-1],dx=startCapE.x-startCapS.x,dy=startCapE.y-startCapS.y,ang=Math.atan2(dy,dx);this.__context.fillStyle=this.__graphLayout.capColor,this.__context.save(),this.__context.translate(startCapE.x,startCapE.y),this.__context.rotate(ang),this.__context.beginPath(),this.__context.moveTo(0,this.__graphLayout.capSize),this.__context.lineTo(0,-this.__graphLayout.capSize),this.__context.lineTo(this.__graphLayout.capSize,0),this.__context.fill(),this.__context.restore()}this.__graphLayout.showEndCap&&this.__graphLayout.capSize&&this.__graphLayout.capColor&&(this.__context.beginPath(),this.__context.fillStyle=this.__graphLayout.capColor,this.__context.arc(this.__points[0].x,this.__points[0].y,this.__graphLayout.capSize/2,0,2*Math.PI),this.__context.fill())}}__renderLineSegment(start,end,current){if(this.__context&&this.__points){if(this.__context.restore(),this.__context.beginPath(),this.__context.save(),parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.Invisible)return;(parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.BoldLine)===TcHmiScopeControl.LineState.BoldLine&&(this.__context.lineWidth=14.5*this.__context.lineWidth),(parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.MediumBoldLine)===TcHmiScopeControl.LineState.MediumBoldLine&&(this.__context.lineWidth=7*this.__context.lineWidth),(parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.Dashed)===TcHmiScopeControl.LineState.Dashed&&this.__context.setLineDash([2,5]),(parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.ApplyToLine)===TcHmiScopeControl.LineState.ApplyToLine&&0!==parseInt(current.substring(5,14),16)&&(this.__context.strokeStyle="#"+current.substring(8,14),this.__context.globalAlpha=parseInt(current.substring(6,8),16)/255);for(let i=start,ii=end;i<=ii;i++)i===start?this.__context.moveTo(this.__points[i].x,this.__points[i].y):this.__context.lineTo(this.__points[i].x,this.__points[i].y);this.__context.stroke()}}__renderMarkSegment(start,end,current){if(this.__context&&this.__points){if(this.__context.restore(),this.__context.beginPath(),this.__context.save(),(parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.BoldMark)===TcHmiScopeControl.LineState.BoldMark&&(this.__context.lineWidth=14.5*this.__context.lineWidth),(parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.MediumBoldMark)===TcHmiScopeControl.LineState.MediumBoldMark&&(this.__context.lineWidth=7*this.__context.lineWidth),(parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.ApplyToMark)===TcHmiScopeControl.LineState.ApplyToMark&&0!==parseInt(current.substring(5,14),16)&&(this.__context.strokeStyle="#"+current.substring(8,14),this.__context.globalAlpha=parseInt(current.substring(6,8),16)/255),this.__graphLayout&&this.__graphLayout.markWidth&&this.__graphLayout.markColor){this.__context.beginPath();for(let i=start,ii=end;i<=ii;i++)this.__context.moveTo(this.__points[i].x,this.__points[i].y),this.__context.lineTo(this.__points[i].x,this.__points[i].y)}this.__context.stroke()}}__renderFillSegment(start,end,current){if(this.__context&&this.__points){this.__context.restore(),this.__context.beginPath(),this.__context.save(),(parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.ApplyToFillArea)===TcHmiScopeControl.LineState.ApplyToFillArea&&0!==parseInt(current.substring(5,14),16)&&(this.__context.fillStyle="#"+current.substring(8,14),this.__context.globalAlpha=parseInt(current.substring(6,8),16)/255),parseInt(current.substring(14,18),16)&TcHmiScopeControl.LineState.Invisible&&(this.__context.globalAlpha=0),this.__context.moveTo(this.__points[end].x,this.__points[end].y);for(let i=end+1,ii=start;i<=ii;i++)this.__context.lineTo(this.__points[i].x,this.__points[i].y);this.__graphLayout&&(this.__graphLayout.fillMode===TcHmiScopeControl.FillMode.FromTop?(this.__context.lineTo(this.__points[start].x,this.__gridSizeLayout.position.y),this.__context.lineTo(this.__points[end].x,this.__gridSizeLayout.position.y),this.__context.lineTo(this.__points[end].x,this.__points[end].y),this.__context.fill()):this.__graphLayout.fillMode===TcHmiScopeControl.FillMode.FromBottom?(this.__context.lineTo(this.__points[start].x,this.__gridSizeLayout.position.y+this.__gridSizeLayout.dimensions.height),this.__context.lineTo(this.__points[end].x,this.__gridSizeLayout.position.y+this.__gridSizeLayout.dimensions.height),this.__context.lineTo(this.__points[end].x,this.__points[end].y),this.__context.fill()):this.__graphLayout.fillMode===TcHmiScopeControl.FillMode.FromHorizontalZero&&this.__zeroPoint&&(this.__context.lineTo(this.__points[start].x,this.__zeroPoint.y),this.__context.lineTo(this.__points[end].x,this.__zeroPoint.y),this.__context.fill()))}}setPoints(points){this.__points=points}setZeroPoint(zeroPoint){this.__zeroPoint=zeroPoint}setLineSeries(lineSeries){this.__lineSeries=lineSeries}}}(TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){TcHmiScopeControl.Dialog=class{constructor(element,control){this.__parentControl=control,this.__element=element;let contentTabs=element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-dialog")[0];contentTabs.useMaxContent();let elementTabContentUpload=element.querySelector('tchmi-tab-content[name="upload"]');if(this.__elementChunkSizeRow=element.getElementsByClassName("chunksizeRow")[0],this.__elementProgressbar=element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-dialog-progress-bar")[0],!(this.__element&&contentTabs&&elementTabContentUpload&&this.__elementChunkSizeRow&&this.__elementProgressbar))throw new Error("Invalid Template.html");const saveButton=Controls.get(this.__parentControl.getId()+".saveButton"),fileButton=Controls.get(this.__parentControl.getId()+".fileButton"),persistCheckbox=Controls.get(this.__parentControl.getId()+".persistCheckbox"),toggleSwitch=Controls.get(this.__parentControl.getId()+".advancedToggleSwitch"),chunksizeTextbox=Controls.get(this.__parentControl.getId()+".chunksizeTextbox"),uploadButton=Controls.get(this.__parentControl.getId()+".uploadButton");let noFile=elementTabContentUpload.getElementsByClassName("no_file")[0];const selectAllButton=Controls.get(this.__parentControl.getId()+".selectAllButton"),deselectAllButton=Controls.get(this.__parentControl.getId()+".deselectAllButton"),deleteSelectedButton=Controls.get(this.__parentControl.getId()+".deleteSelectedButton"),datagridRecordsPerUser=Controls.get(this.__parentControl.getId()+".datagridRecordsPerUser"),detachButton=Controls.get(this.__parentControl.getId()+".detachButton"),resetButton=Controls.get(this.__parentControl.getId()+".resetButton"),cancelButton=Controls.get(this.__parentControl.getId()+".cancelButton");if(!(saveButton&&fileButton&&persistCheckbox&&chunksizeTextbox&&uploadButton&&selectAllButton&&deselectAllButton&&deleteSelectedButton&&datagridRecordsPerUser&&detachButton&&toggleSwitch&&resetButton&&cancelButton&&noFile))throw new Error("Invalid Template.html");this.__saveButton=saveButton,this.__noFile=noFile,this.__persistCheckbox=persistCheckbox,this.__chunksizeTextbox=chunksizeTextbox,this.__fileButton=fileButton,this.__uploadButton=uploadButton,this.__uploadedRecordsDatagrid=datagridRecordsPerUser,this.__deleteSelectedButton=deleteSelectedButton,this.__detachButton=detachButton;let elementCharts=$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-dialog-charts TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-popup tchmi-box"></div>'),chartsCombobox=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiCombobox",`${this.__parentControl.getId()}.chartsCombobox`,{"data-tchmi-width":150,"data-tchmi-height":26},this.__parentControl),chartsOkButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__parentControl.getId()}.chartsOkButton`,{"data-tchmi-width":60,"data-tchmi-height":30,"data-tchmi-text":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Dialog_Button_Text_Charts_Ok%/l%"},this.__parentControl);if(this.__toggleSwitch=toggleSwitch,!chartsCombobox||!elementCharts||!chartsOkButton)throw new Error("Could not create controls for dialog.");this.__chartsCombobox=chartsCombobox,elementCharts.append(this.__chartsCombobox.getElement()[0]),elementCharts.append(chartsOkButton.getElement()[0]),this.__elementCharts=elementCharts,contentTabs.addTabChangeCallback(this.__onTabChanged),this.__eventDestroyers.push(TcHmi.EventProvider.register(saveButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!1,saveButton?.getId())}))),this.__eventDestroyers.push(TcHmi.EventProvider.register(fileButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!1,fileButton?.getId())}))),this.__eventDestroyers.push(TcHmi.EventProvider.register(uploadButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!1,uploadButton?.getId())}))),this.__eventDestroyers.push(TcHmi.EventProvider.register(chartsOkButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!1,chartsOkButton?.getId())}))),this.__eventDestroyers.push(TcHmi.EventProvider.register(deleteSelectedButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!1,deleteSelectedButton?.getId())}))),this.__eventDestroyers.push(TcHmi.EventProvider.register(selectAllButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!1,selectAllButton?.getId())}))),this.__eventDestroyers.push(TcHmi.EventProvider.register(deselectAllButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!1,deselectAllButton?.getId())}))),this.__eventDestroyers.push(TcHmi.EventProvider.register(datagridRecordsPerUser.getId()+".onDataChanged",this.__onDataChanged())),this.__eventDestroyers.push(TcHmi.EventProvider.register(detachButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!1,detachButton?.getId())}))),this.__eventDestroyers.push(TcHmi.EventProvider.register(toggleSwitch.getId()+".onToggleStateChanged",this.__onToggleStateChanged())),this.__eventDestroyers.push(TcHmi.EventProvider.register(resetButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!1,resetButton?.getId())}))),this.__eventDestroyers.push(TcHmi.EventProvider.register(cancelButton.getId()+".onPressed",(()=>{this.__onButtonPressed(!0,cancelButton?.getId())})))}__parentControl;__element;__elementChunkSizeRow;__noFile;__elementCharts;__elementProgressbar;__toggleSwitch;__persistCheckbox;__chunksizeTextbox;__file=null;__uploadedRecordsDatagrid;__chartsCombobox;__deleteSelectedButton;__saveButton;__fileButton;__uploadButton;__detachButton;__eventDestroyers=[];__isShowing=!1;__isWaitingForServer=!1;__confirmationPrompt=null;__replacePrompt=null;attachedGuid=null;show(){this.__isShowing||(TcHmi.TopMostLayer.add(this.__parentControl,this.__element,{removeCb:()=>{this.__isShowing=!1},centerHorizontal:!0,centerVertical:!0}),this.__isShowing=!0)}hide(){this.__isShowing&&(TcHmi.TopMostLayer.remove(this.__parentControl,this.__element),this.__isShowing=!1)}addChartsToCombobox(chartArray){this.__chartsCombobox.setSrcData(chartArray),this.__chartsCombobox.setSelectedIndex(0)}showChartsDialog(){TcHmi.TopMostLayer.add(this.__parentControl,this.__elementCharts,{centerHorizontal:!0,centerVertical:!0,removeCb:data=>{data.canceled&&this.setAttachedGuid(null)}})}closeChartsDialog(){TcHmi.TopMostLayer.remove(this.__parentControl,this.__elementCharts)}destroy(){for(let i=0,ii=this.__eventDestroyers.length;i<ii;i++)this.__eventDestroyers[i]();this.__eventDestroyers=[],this.__confirmationPrompt?.destroy(),this.__confirmationPrompt=null,this.__replacePrompt?.destroy(),this.__replacePrompt=null}disableAllButtons(){this.__saveButton.setIsEnabled(!1),this.__uploadButton.setIsEnabled(!1),this.__detachButton.setIsEnabled(!1),this.__uploadedRecordsDatagrid.setIsEnabled(!1),this.__deleteSelectedButton.setIsEnabled(!1),this.__parentControl.enableOrDisableMenuControls()}enableAllButtons(){this.__saveButton.setIsEnabled(!0),this.__uploadButton.setIsEnabled(!0),this.__detachButton.setIsEnabled(!0),this.__uploadedRecordsDatagrid.setIsEnabled(!0);let srcData=this.__uploadedRecordsDatagrid.getSrcData();srcData&&(srcData.some((x=>x.select))?this.__deleteSelectedButton.setIsEnabled(!0):this.__deleteSelectedButton.setIsEnabled(!1)),this.__parentControl.enableOrDisableMenuControls()}resetToDefault(){this.__noFile.textContent="",this.__file=null,this.__parentControl.__localizationReader&&(this.__noFile.textContent=this.__parentControl.__localizationReader.get("Dialog_Tab_Upload_No_File")),this.__persistCheckbox.setToggleState("Active"),this.__elementChunkSizeRow.style.display="none",this.__chunksizeTextbox.setText("1048576"),this.__elementProgressbar.value=0,this.__elementProgressbar.max=0,this.__toggleSwitch.setToggleState("Normal")}__onTabChanged=tabIndex=>{"currentRecord"===tabIndex?this.__toggleSwitch.setVisibility("Hidden"):"upload"===tabIndex?this.__toggleSwitch.setVisibility("Visible"):"record"===tabIndex&&this.__toggleSwitch.setVisibility("Hidden")};setAttachedGuid(guid){if(this.attachedGuid=guid,this.attachedGuid){let srcDataFromDatagrid=this.__uploadedRecordsDatagrid.getSrcData(),srcData=tchmi_clone_object(srcDataFromDatagrid);if(srcData)for(let element of srcData)if(element.guid===this.attachedGuid){element.attach=!0,this.__uploadedRecordsDatagrid.setSrcData(srcData);break}}else{let srcDataFromDatagrid=this.__uploadedRecordsDatagrid.getSrcData(),srcData=tchmi_clone_object(srcDataFromDatagrid);srcData&&(srcData.forEach((x=>{x.attach=!1})),this.__uploadedRecordsDatagrid.setSrcData(srcData))}}setSrcDataOfRecordsDatagrid(srcData){let clone=tchmi_clone_object(srcData);if(clone)for(let element of clone){if(element.select=!1,this.attachedGuid&&element.guid===this.attachedGuid){element.attach=!0;break}"__AutoSave"===element.extensionName&&(element.autoSave=!0)}this.__uploadedRecordsDatagrid.setSrcData(clone),this.__deleteSelectedButton.setIsEnabled(!1)}__onButtonPressed(hide,id){if(id===this.__parentControl.getId()+".saveButton")this.__parentControl.__serverSymbolsHelper.saveCurrentRecord();else if(id===this.__parentControl.getId()+".uploadButton")if(null===this.__file);else{let persist="Active"===this.__persistCheckbox.getToggleState();this.__parentControl.__serverSymbolsHelper.uploadRecord(this.__file,persist,Number(this.__chunksizeTextbox.getText())/2)}else if(id===this.__parentControl.getId()+".detachButton")this.__parentControl.__serverSymbolsHelper.detachFromScopeRecord();else if(id===this.__parentControl.getId()+".fileButton"){let inputElement=document.createElement("input");inputElement.type="file",inputElement.accept=".svdx",inputElement.multiple=!1;let __this=this;inputElement.addEventListener("change",(function(data){if(inputElement.files&&inputElement.files.length>0){let file=inputElement.files[0];__this.__noFile.textContent=file.name,__this.__file=file}else __this.__noFile.textContent="",__this.__file=null})),inputElement.click()}else if(id===this.__parentControl.getId()+".chartsOkButton"){let srcDataFromDatagrid=this.__uploadedRecordsDatagrid.getSrcData(),srcData=tchmi_clone_object(srcDataFromDatagrid),selectedRowIndex=this.__uploadedRecordsDatagrid.getSelectedRowIndex();if(srcData&&null!==selectedRowIndex){let element=tchmi_clone_object(srcData[selectedRowIndex]);element.chartName=this.__chartsCombobox.getSelectedText(),delete element.attach,this.attachedGuid=element.guid,this.__parentControl.__serverSymbolsHelper.openConnectionToFile(element)}}else if(id===this.__parentControl.getId()+".selectAllButton"){let datagridSrcData=this.__uploadedRecordsDatagrid.getSrcData();if(datagridSrcData){let srcData=tchmi_clone_object(datagridSrcData);srcData.forEach((x=>{x.select=!0})),this.__uploadedRecordsDatagrid.setSrcData(srcData),this.__isWaitingForServer||this.__deleteSelectedButton.setIsEnabled(!0)}}else if(id===this.__parentControl.getId()+".deselectAllButton"){let datagridSrcData=this.__uploadedRecordsDatagrid.getSrcData();if(datagridSrcData){let srcData=tchmi_clone_object(datagridSrcData);srcData.forEach((x=>{x.select=!1})),this.__uploadedRecordsDatagrid.setSrcData(srcData)}this.__deleteSelectedButton.setIsEnabled(!1)}else id===this.__parentControl.getId()+".deleteSelectedButton"?this.__delete():id===this.__parentControl.getId()+".resetButton"&&this.resetToDefault();hide&&this.hide()}__onDataChanged(){let __this=this;return function(evt,value){if("select"===value.property){let srcData=__this.__uploadedRecordsDatagrid.getSrcData();if(srcData){let clone=tchmi_clone_object(srcData);clone[value.index].select=value.value,__this.__uploadedRecordsDatagrid.setSrcData(clone),srcData.some((x=>x.select))?__this.__deleteSelectedButton.setIsEnabled(!0):__this.__deleteSelectedButton.setIsEnabled(!1)}}else if("persist"===value.property){let srcData=__this.__uploadedRecordsDatagrid.getSrcData();if(srcData){let element=srcData[value.index];__this.__parentControl.__serverSymbolsHelper.changePersist(element)}}else if("download"!==value.property||value.value){if("attach"===value.property)if(value.value){let srcData=__this.__uploadedRecordsDatagrid.getSrcData();if(srcData){let element=srcData[value.index];__this.__parentControl.__serverSymbolsHelper.getChartList(element)}}else __this.__parentControl.__serverSymbolsHelper.detachFromScopeRecord()}else{let srcData=__this.__uploadedRecordsDatagrid.getSrcData();if(srcData){let element=srcData[value.index];__this.__parentControl.__serverSymbolsHelper.download(element)}}}}__onToggleStateChanged(){return()=>{"Active"===this.__toggleSwitch.getToggleState()?this.__elementChunkSizeRow.style.display="":this.__elementChunkSizeRow.style.display="none"}}async __delete(){this.__confirmationPrompt||(this.__confirmationPrompt=new Controls.Helpers.TextAndButtonsPrompt({yes:{value:!0,attributes:{"data-tchmi-width":60,"data-tchmi-height":30,"data-tchmi-text":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Button_Text_Yes%/l%"}},no:{value:!1,attributes:{"data-tchmi-width":60,"data-tchmi-height":30,"data-tchmi-text":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Button_Text_No%/l%"}}},this.__parentControl),this.__confirmationPrompt.setBackgroundAction({close:!0,action:"no"}),this.__confirmationPrompt.setLocalizations({headerText:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Header_ConfirmDelete%/l%",contentText:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_ConfirmDelete%/l%"}));if(await this.__confirmationPrompt.prompt()){let datagridSrcData=this.__uploadedRecordsDatagrid.getSrcData();if(datagridSrcData){let filteredElements=tchmi_clone_object(datagridSrcData).filter((x=>x.select));if(0===filteredElements.length)return;filteredElements.forEach((x=>{delete x.attach,delete x.select})),this.__parentControl.__serverSymbolsHelper.deleteScopeUpload(filteredElements)}}}async replaceOrIncrementCurrentRecord(){return this.__replacePrompt||(this.__replacePrompt=new TcHmiScopeControl.ReplacePrompt(this.__parentControl),this.__replacePrompt.setLocalizations({headerText:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Header_ConfirmSave%/l%",contentText:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_ConfirmSave%/l%",buttonTextCancel:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Button_Text_Cancel%/l%",buttonTextReplace:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Button_Text_Replace%/l%",buttonTextIncrement:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Button_Text_Increment%/l%",toggleSwitchTextSave:"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_ToggleSwitch_Text_Save%/l%"})),await this.__replacePrompt.prompt()}isShowing(){return this.__isShowing}getIsWaitingForServer(){return this.__isWaitingForServer}setIsWaitingForServer(isWaitingForServer){this.__isWaitingForServer=isWaitingForServer}setProgressbarValue(newValue){this.__elementProgressbar.value=newValue}setProgressbarMaxValue(maxValue){this.__elementProgressbar.max=maxValue}getProgressbarValue(){return this.__elementProgressbar.value}}}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){class ReplacePrompt extends TcHmi.Controls.Helpers.Popup{__cancelButton;__replaceButton;__incrementButton;__saveToggleSwitch;__backgroundAction={close:!0};__closeButton={show:!1};constructor(parentControl){super(parentControl);let cancelButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.cancelButton`,{"data-tchmi-width":80,"data-tchmi-height":30},this.__parentControl),replaceButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.replaceButton`,{"data-tchmi-width":80,"data-tchmi-height":30},this.__parentControl),incrementButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.incrementButton`,{"data-tchmi-width":80,"data-tchmi-height":30},this.__parentControl),saveToggleSwitch=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiToggleSwitch",`${this.__name}.saveToggleSwitch`,{"data-tchmi-width":60,"data-tchmi-height":30},this.__parentControl);if(!(cancelButton&&replaceButton&&incrementButton&&saveToggleSwitch))throw new Error("Could not create controls for ReplacePrompt.");this.__elementFooter.appendChild(saveToggleSwitch.getElement()[0]),this.__elementFooter.appendChild(cancelButton.getElement()[0]),this.__destroyers.push(TcHmi.EventProvider.register(cancelButton.getId()+".onPressed",this.__onCancelPressed)),this.__elementFooter.appendChild(replaceButton.getElement()[0]),this.__destroyers.push(TcHmi.EventProvider.register(replaceButton.getId()+".onPressed",this.__onReplacePressed)),this.__elementFooter.appendChild(incrementButton.getElement()[0]),this.__destroyers.push(TcHmi.EventProvider.register(incrementButton.getId()+".onPressed",this.__onIncrementPressed)),this.__cancelButton=cancelButton,this.__replaceButton=replaceButton,this.__incrementButton=incrementButton,this.__saveToggleSwitch=saveToggleSwitch,this.__childControls.push(replaceButton,incrementButton)}destroy(force=!1){TcHmi.Binding.removeEx2(null,"Text",this.__cancelButton),TcHmi.Binding.removeEx2(null,"Text",this.__replaceButton),TcHmi.Binding.removeEx2(null,"Text",this.__incrementButton),TcHmi.Binding.removeEx2(null,"Text",this.__saveToggleSwitch),super.destroy(force)}abort(action){super.abort(action)}__onCancelPressed=()=>{this.__parentControl.getIsEnabled()&&TcHmi.Access.checkAccess(this.__parentControl,"operate")&&this.__cancel()};__onReplacePressed=()=>{this.__parentControl.getIsEnabled()&&TcHmi.Access.checkAccess(this.__parentControl,"operate")&&this.__replace()};__onIncrementPressed=()=>{this.__parentControl.getIsEnabled()&&TcHmi.Access.checkAccess(this.__parentControl,"operate")&&this.__increment()};__cancel(){this.__prompt?.answer({result:"cancel"})}__replace(){let toggleSwitchValue=this.__saveToggleSwitch.getToggleState(),save=!(!toggleSwitchValue||"Active"!==toggleSwitchValue);this.__prompt?.answer({result:"replace",saveResult:save})}__increment(){let toggleSwitchValue=this.__saveToggleSwitch.getToggleState(),save=!(!toggleSwitchValue||"Active"!==toggleSwitchValue);this.__prompt?.answer({result:"increment",saveResult:save})}setBackgroundAction(action){super.setBackgroundAction(action)}setCloseButton(buttonOrShow){super.setCloseButton(buttonOrShow)}__performPromptAction(toPerform){if(toPerform.action)switch(toPerform.action){case"replace":this.__replace();break;case"increment":this.__increment();break;case"cancel":this.__cancel()}}setLocalizations(texts){this.__applyTextToElement("headerText",texts.headerText,this.__elementHeader),this.__applyTextToElement("contentText",texts.contentText,(text=>{this.__elementContent.textContent=tchmi_decode_control_characters(text)})),this.__applyTextToControl("buttonTextCancel",texts.buttonTextCancel,this.__cancelButton,"Text"),this.__applyTextToControl("buttonTextReplace",texts.buttonTextReplace,this.__replaceButton,"Text"),this.__applyTextToControl("buttonTextIncrement",texts.buttonTextIncrement,this.__incrementButton,"Text"),this.__applyTextToControl("toggleSwitchTextSave",texts.toggleSwitchTextSave,this.__saveToggleSwitch,"Text")}}TcHmiScopeControl.ReplacePrompt=ReplacePrompt}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){TcHmiScopeControl.TimeRangeDialog=class{constructor(element,control){if(this.__parentControl=control,this.__element=element,this.__elementList=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-time-range-dialog-list")[0],this.__elementSliderTemplate=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-slider-template")[0],this.__elementSliderValue=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-slider-value")[0],this.__elementSliderValueText=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-slider-value-text")[0],this.__elementSliderMin=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-slider-knob-min-value")[0],this.__elementSliderMax=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-slider-knob-max-value")[0],this.__elementList=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-time-range-dialog-list")[0],this.__elementRecordTimespanControl=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-control-for-record")[0],this.__elementLoading=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-time-range-dialog-loading")[0],this.__elementNoDataText=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-time-range-dialog-no-data-text")[0],this.__elementLoadingOverlay=this.__element.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-time-range-dialog-loading-overlay")[0],!(this.__parentControl&&this.__element&&this.__elementList&&this.__elementSliderTemplate&&this.__elementSliderValue&&this.__elementSliderValueText&&this.__elementSliderMin&&this.__elementSliderMax&&this.__elementList&&this.__elementRecordTimespanControl&&this.__elementLoading&&this.__elementNoDataText&&this.__elementLoadingOverlay))throw new Error("Invalid Template.html");this.__mousedownHandler=this.__onMouseDown(),this.__touchstartHandler=this.__onTouchStart(),this.__mouseupHandler=this.__onMouseUp(),this.__touchmoveHandler=this.__onTouchMove(),this.__mousemoveHandler=this.__onMouseMove(),this.__touchendHandler=this.__onTouchEnd();const passiveEventOptions={passive:!0,capture:!1},activeEventOptions={passive:!1,capture:!1};this.__elementSliderMin.addEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),this.__elementSliderMin.addEventListener("touchstart",this.__touchstartHandler,activeEventOptions),this.__elementSliderMax.addEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),this.__elementSliderMax.addEventListener("touchstart",this.__touchstartHandler,activeEventOptions),document.addEventListener("mousemove",this.__mousemoveHandler,passiveEventOptions),document.addEventListener("touchmove",this.__touchmoveHandler,activeEventOptions),document.addEventListener("mouseup",this.__mouseupHandler,passiveEventOptions),document.addEventListener("touchend",this.__touchendHandler,activeEventOptions);const datetimeStart=Controls.get(this.__parentControl.getId()+".datetimeInputStart"),datetimeEnd=Controls.get(this.__parentControl.getId()+".datetimeInputEnd"),intervalTime=Controls.get(this.__parentControl.getId()+".timespanTextblock"),applyButton=Controls.get(this.__parentControl.getId()+".applyAquisitionsButton"),cancelButton=Controls.get(this.__parentControl.getId()+".cancelTimeRangeButton"),refreshButton=Controls.get(this.__parentControl.getId()+".refreshTimeRangeButton");if(!(datetimeStart&&datetimeEnd&&intervalTime&&applyButton&&cancelButton&&refreshButton))throw new Error("Invalid Template.html");this.__datetimeStart=datetimeStart,this.__datetimeEnd=datetimeEnd,this.__intervalTime=intervalTime,this.__applyButton=applyButton,this.__cancelButton=cancelButton,this.__refreshButton=refreshButton,this.__eventDestroyers.push(TcHmi.EventProvider.register(this.__parentControl.getId()+".datetimeInputStart.onValueChanged",this.__onValueChangedStart())),this.__eventDestroyers.push(TcHmi.EventProvider.register(this.__parentControl.getId()+".datetimeInputEnd.onValueChanged",this.__onValueChangedEnd())),this.__eventDestroyers.push(TcHmi.EventProvider.register(this.__parentControl.getId()+".applyAquisitionsButton.onPressed",this.__onApplyPressed())),this.__eventDestroyers.push(TcHmi.EventProvider.register(this.__parentControl.getId()+".cancelTimeRangeButton.onPressed",this.__onCancelPressed())),this.__eventDestroyers.push(TcHmi.EventProvider.register(this.__parentControl.getId()+".refreshTimeRangeButton.onPressed",this.__onRefreshPressed())),this.__textFontStyle=TcHmi.StyleProvider.getComputedElementStyle(this.__elementSliderValueText,"font").font;let loadingSpinnerDivTempDiv=document.createElement("div");loadingSpinnerDivTempDiv.innerHTML='<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-loading-spinner-container"><div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-loading-spinner"><div></div><div></div><div></div><div></div></div></div>',this.__loadingSpinner=loadingSpinnerDivTempDiv.firstElementChild,this.__elementNoDataText.style.display="none"}__parentControl;__element;__elementLoading;__elementList;__elementRecordTimespanControl;__elementSliderTemplate;__elementSliderValue;__elementSliderValueText;__elementSliderMin;__elementSliderMax;__elementNoDataText;__elementLoadingOverlay;__data=[];__activeData=null;__isShowing=!1;__eventDestroyers=[];__listElements=[];__datetimeStart;__datetimeEnd;__intervalTime;__applyButton;__refreshButton;__cancelButton;__mousedownHandler;__touchstartHandler;__mousemoveHandler;__touchmoveHandler;__mouseupHandler;__touchendHandler;__ignoreDateTimeInputEvents=!1;__draggingInfo={isDragging:!1,draggingElem:null,offsetLeft:0,startPositionX:0};__textFontStyle="";__loadingSpinner=null;show(){this.__isShowing||(TcHmi.TopMostLayer.add(this.__parentControl,this.__element,{removeCb:()=>{this.__isShowing=!1},centerHorizontal:!0,centerVertical:!0}),this.__isShowing=!0,this.__loadingSpinner&&(this.__elementLoading.appendChild(this.__loadingSpinner),this.__elementLoadingOverlay.style.display=""),this.__parentControl.__serverSymbolsHelper.getAnalyticsData())}hide(){this.__isShowing&&(TcHmi.TopMostLayer.remove(this.__parentControl,this.__element),this.__isShowing=!1)}destroy(){for(let i=0,ii=this.__eventDestroyers.length;i<ii;i++)this.__eventDestroyers[i]();this.__eventDestroyers=[];const passiveEventOptions={passive:!0,capture:!1};this.__elementSliderMin.removeEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),this.__elementSliderMax.removeEventListener("mousedown",this.__mousedownHandler,passiveEventOptions),document.removeEventListener("mousemove",this.__mousemoveHandler,passiveEventOptions),document.removeEventListener("mouseup",this.__mouseupHandler,passiveEventOptions)}isShowing(){return this.__isShowing}addData(data){if(data){for(let i=0,ii=data.length;i<ii;i++)data[i].startTime=new Date(data[i].startTime).toISOString(),data[i].endTime=new Date(data[i].endTime).toISOString();data.sort(((a,b)=>-a.startTime.localeCompare(b.startTime)))}if(this.__data=data,data){let existingItemBefore=this.__data.find((elem=>this.__activeData&&elem.id===this.__activeData.id));this.__elementNoDataText.style.display="none";let actElementsLength=this.__elementList.children.length;for(let i=0,ii=Math.min(actElementsLength,data.length);i<ii;i++){let elem=this.__elementList.children.item(i);elem&&(elem.innerHTML=data[i].name+" ("+this.__calcRoundedValue(data[i].startTime,data[i].endTime)+") <br>["+data[i].startTime+", "+data[i].endTime+"]",existingItemBefore&&data[i].id===existingItemBefore.id?(elem.classList.add("active"),elem.appendChild(this.__elementRecordTimespanControl)):elem.classList.remove("active"))}if(0===data.length){for(let i=this.__elementList.children.length-1,ii=0;i>=ii;i--){let elem=this.__elementList.children.item(i);elem&&(elem.removeEventListener("mousedown",this.__onMouseDownList()),this.__elementList.removeChild(elem))}this.__elementNoDataText.style.display=""}else if(actElementsLength<data.length)for(let i=actElementsLength,ii=data.length;i<ii;i++){let node=document.createElement("li");node.addEventListener("mousedown",this.__onMouseDownList()),node.appendChild(document.createTextNode(data[i].name+" ("+this.__calcRoundedValue(data[i].startTime,data[i].endTime)+")")),node.appendChild(document.createElement("br")),node.appendChild(document.createTextNode("["+data[i].startTime+", "+data[i].endTime+"]")),this.__elementList.appendChild(node)}else if(actElementsLength>data.length)for(let i=actElementsLength,ii=data.length;i>=ii;i--){let elem=this.__elementList.children.item(i);elem&&(elem.removeEventListener("mousedown",this.__onMouseDownList()),this.__elementList.removeChild(elem))}}else{for(let i=this.__elementList.children.length-1,ii=0;i>=ii;i--){let elem=this.__elementList.children.item(i);elem&&(elem.removeEventListener("mousedown",this.__onMouseDownList()),this.__elementList.removeChild(elem))}this.__elementNoDataText.style.display=""}this.__loadingSpinner&&(this.__loadingSpinner.remove(),this.__elementLoadingOverlay.style.display="none")}__calcValuesFromSlider(){if(this.__activeData){let minBoundingRect=this.__elementSliderMin.getBoundingClientRect(),maxBoundingRect=this.__elementSliderMax.getBoundingClientRect(),templateBoundingRect=this.__elementSliderTemplate.getBoundingClientRect(),fullPixel=templateBoundingRect.width-maxBoundingRect.width-minBoundingRect.width,startTime=this.__activeData.startTime,endTime=this.__activeData.endTime;if(startTime&&endTime){let timePerPixel=(Date.parse(endTime)-Date.parse(startTime))/fullPixel,newInterval=timePerPixel*this.__elementSliderValue.getBoundingClientRect().width,t=new Date(newInterval),days=parseInt((newInterval/1e3/60/60/24).toString(),10),intervalTime="00 d 00:00:00.000";startTime<endTime&&(intervalTime=`${`0${days}`.slice(-2)} d ${`0${t.getUTCHours()}`.slice(-2)}:${`0${t.getUTCMinutes()}`.slice(-2)}:${`0${t.getUTCSeconds()}`.slice(-2)}.${`00${t.getUTCMilliseconds()}`.slice(-3)}`),this.__intervalTime.setText(intervalTime);let startOffset=(minBoundingRect.left-templateBoundingRect.left)*timePerPixel,newStartMilliseconds=Date.parse(this.__activeData.startTime)+startOffset,newStartDate=new Date(newStartMilliseconds);this.__datetimeStart.setValue(newStartDate.toISOString());let endOffset=(templateBoundingRect.left+templateBoundingRect.width-maxBoundingRect.width-maxBoundingRect.left)*timePerPixel,newEndMilliseconds=Date.parse(this.__activeData.endTime)-endOffset,newEndDate=new Date(newEndMilliseconds);this.__datetimeEnd.setValue(newEndDate.toISOString())}let calcStartTime=this.__datetimeStart.getValue(),calcEndTime=this.__datetimeEnd.getValue();calcStartTime&&calcEndTime&&(this.__activeData.startTimeNow=calcStartTime,this.__activeData.endTimeNow=calcStartTime,this.__setRoundedValueText(calcStartTime,calcEndTime))}}__calcSliderFromValues(){if(this.__activeData){let originalStartTime=this.__activeData.startTime,originalEndTime=this.__activeData.endTime,startTimeNow=this.__datetimeStart.getValue(),endTimeNow=this.__datetimeEnd.getValue();if(originalStartTime&&originalEndTime&&startTimeNow&&endTimeNow){let minBoundingRect=this.__elementSliderMin.getBoundingClientRect(),maxBoundingRect=this.__elementSliderMax.getBoundingClientRect(),fullPixel=this.__elementSliderTemplate.getBoundingClientRect().width-maxBoundingRect.width-minBoundingRect.width,fullTimespan=Date.parse(originalEndTime)-Date.parse(originalStartTime),actTimespan=Date.parse(endTimeNow)-Date.parse(startTimeNow),pixelPerTime=fullPixel/fullTimespan,pixelWidthForStart=pixelPerTime*(Date.parse(startTimeNow)-Date.parse(originalStartTime));if(this.__elementSliderMin.style.left=pixelWidthForStart+"px",startTimeNow<endTimeNow){let pixelWidthForEnd=pixelPerTime*(Date.parse(endTimeNow)-Date.parse(originalStartTime));this.__elementSliderMax.style.left=pixelWidthForEnd+maxBoundingRect.width+"px",this.__elementSliderValue.style.width=pixelWidthForEnd-pixelWidthForStart+"px",this.__elementSliderValue.style.left=pixelWidthForStart+minBoundingRect.width+"px"}else this.__elementSliderMax.style.left=pixelWidthForStart+maxBoundingRect.width+"px",this.__elementSliderValue.style.width="0px",this.__elementSliderValue.style.left=pixelWidthForStart+minBoundingRect.width+"px";let t=new Date(actTimespan),days=parseInt((actTimespan/1e3/60/60/24).toString(),10),intervalTime="00 d 00:00:00.000";startTimeNow<endTimeNow&&(intervalTime=`${`0${days}`.slice(-2)} d ${`0${t.getUTCHours()}`.slice(-2)}:${`0${t.getUTCMinutes()}`.slice(-2)}:${`0${t.getUTCSeconds()}`.slice(-2)}.${`00${t.getUTCMilliseconds()}`.slice(-3)}`),this.__activeData.startTimeNow=startTimeNow,this.__activeData.endTimeNow=endTimeNow,this.__intervalTime.setText(intervalTime),this.__setRoundedValueText(startTimeNow,endTimeNow)}}}__getTextWidth(text,font){let context=document.createElement("canvas").getContext("2d");if(context){return context.font=font,context.measureText(text).width}return 0}__setRoundedValueText(startTime,endTime){let newText=this.__calcRoundedValue(startTime,endTime),diff=Date.parse(endTime)-Date.parse(startTime);this.__elementSliderValueText.innerText=newText,this.__getTextWidth(this.__elementSliderValueText.innerText.trim(),this.__textFontStyle)>this.__elementSliderValue.getBoundingClientRect().width?this.__elementSliderValueText.style.display="none":this.__elementSliderValueText.style.display="",diff<=0?this.__applyButton.setIsEnabled(!1):this.__applyButton.setIsEnabled(!0)}__calcRoundedValue(startTime,endTime){let newText="",diff=Date.parse(endTime)-Date.parse(startTime),interval={days:0,hours:0,minutes:0,seconds:0};diff>0&&(interval={days:Math.floor(diff/1e3/60/60/24),hours:Math.floor(diff/1e3/60/60),minutes:Math.floor(diff/1e3/60),seconds:Math.floor(diff/1e3)});let timeAlias="",value=0;return interval.days>0?(timeAlias="d",value=interval.days):interval.hours>0?(timeAlias="h",value=interval.hours):interval.minutes>0?(timeAlias="m",value=interval.minutes):interval.seconds>0?(timeAlias="s",value=interval.seconds):newText="<1 s",newText=">"+value.toString()+" "+timeAlias,newText}__onCancelPressed(){return evt=>{this.hide()}}__onRefreshPressed(){return evt=>{this.__loadingSpinner&&(this.__elementLoading.appendChild(this.__loadingSpinner),this.__elementLoadingOverlay.style.display=""),this.__parentControl.__serverSymbolsHelper.getAnalyticsData()}}__onApplyPressed(){return evt=>{if(this.__activeData){let startTime=this.__datetimeStart.getValue(),endTime=this.__datetimeEnd.getValue();startTime&&endTime&&this.__parentControl.__serverSymbolsHelper.setAnalyticsRecord(this.__activeData.name,this.__activeData.id,startTime,endTime)}}}__onValueChangedStart(){return evt=>{this.__ignoreDateTimeInputEvents||this.__calcSliderFromValues()}}__onValueChangedEnd(){return evt=>{this.__ignoreDateTimeInputEvents||this.__calcSliderFromValues()}}__onMouseDownList(){return evt=>{const target=evt.target;if("LI"===target.nodeName)if(target.classList.contains("active"))target.classList.remove("active"),target.removeChild(this.__elementRecordTimespanControl),this.__activeData=null;else{for(let i=0,ii=this.__elementList.children.length;i<ii;i++)this.__elementList.children[i].classList.remove("active");if(target.classList.add("active"),target.appendChild(this.__elementRecordTimespanControl),target.parentElement){this.__ignoreDateTimeInputEvents=!0;let index=Array.prototype.indexOf.call(target.parentElement.children,evt.target),activeAnalyticsData=this.__data[index]||null;if(!activeAnalyticsData)return;this.__activeData={id:activeAnalyticsData.id,name:activeAnalyticsData.name,startTime:activeAnalyticsData.startTime,endTime:activeAnalyticsData.endTime,startTimeNow:activeAnalyticsData.startTime,endTimeNow:activeAnalyticsData.endTime},this.__datetimeStart.setMinValue(this.__activeData.startTime),this.__datetimeStart.setMaxValue(this.__activeData.endTime),this.__datetimeStart.setValue(this.__activeData.startTime),this.__datetimeEnd.setMinValue(this.__activeData.startTime),this.__datetimeEnd.setMaxValue(this.__activeData.endTime),this.__datetimeEnd.setValue(this.__activeData.endTime);let sliderTemplateBoundingRect=this.__elementSliderTemplate.getBoundingClientRect(),sliderMaxBoundingRect=this.__elementSliderMax.getBoundingClientRect(),sliderMinBoundingRect=this.__elementSliderMin.getBoundingClientRect(),min=0,max=sliderTemplateBoundingRect.width-sliderMaxBoundingRect.width;this.__elementSliderMin.style.left=min+"px",this.__elementSliderMax.style.left=max+"px",this.__elementSliderValue.style.width=sliderTemplateBoundingRect.width-sliderMaxBoundingRect.width-sliderMinBoundingRect.width+"px",this.__elementSliderValue.style.left=sliderMinBoundingRect.width+"px";let actTimespan=Date.parse(this.__activeData.endTime)-Date.parse(this.__activeData.startTime),t=new Date(actTimespan),days=parseInt((actTimespan/1e3/60/60/24).toString(),10),intervalTime="00 d 00:00:00.000";this.__activeData.startTime<this.__activeData.endTime&&(intervalTime=`${`0${days}`.slice(-2)} d ${`0${t.getUTCHours()}`.slice(-2)}:${`0${t.getUTCMinutes()}`.slice(-2)}:${`0${t.getUTCSeconds()}`.slice(-2)}.${`00${t.getUTCMilliseconds()}`.slice(-3)}`),this.__intervalTime.setText(intervalTime),this.__setRoundedValueText(this.__activeData.startTime,this.__activeData.endTime),this.__ignoreDateTimeInputEvents=!1}}}}__onMouseDown(){return e=>{const target=e.target;this.__draggingInfo={isDragging:!0,draggingElem:target,offsetLeft:this.__elementSliderTemplate.getBoundingClientRect().left,startPositionX:e.clientX}}}__onTouchStart(){return e=>{const target=e.target;this.__draggingInfo={isDragging:!0,draggingElem:target,offsetLeft:this.__elementSliderTemplate.getBoundingClientRect().left,startPositionX:e.touches[0].clientX}}}__onMouseMove(){return e=>{if(this.__draggingInfo.isDragging&&this.__draggingInfo.draggingElem){if(this.__draggingInfo.draggingElem.classList.contains("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-slider-knob-min-value")){let boundingRectMax=this.__elementSliderMax.getBoundingClientRect(),boundingRectTarget=this.__draggingInfo.draggingElem.getBoundingClientRect(),offsetX=boundingRectTarget.left-this.__elementSliderTemplate.getBoundingClientRect().left+(e.clientX-this.__draggingInfo.startPositionX),min=0,max=boundingRectMax.left-boundingRectMax.width-this.__elementSliderTemplate.getBoundingClientRect().left;offsetX=offsetX<min?min:offsetX,offsetX=offsetX>max?max:offsetX,this.__draggingInfo.draggingElem.style.left=offsetX+"px";let positionMax=this.__elementSliderTemplate.getBoundingClientRect().width-max-boundingRectMax.width;this.__elementSliderValue.style.width="calc(100% - "+(offsetX+boundingRectTarget.width+positionMax)+"px)",this.__elementSliderValue.style.left=offsetX+boundingRectTarget.width+"px"}else if(this.__draggingInfo.draggingElem.classList.contains("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-slider-knob-max-value")){let boundingRectMin=this.__elementSliderMin.getBoundingClientRect(),boundingRectTarget=this.__draggingInfo.draggingElem.getBoundingClientRect(),offsetX=boundingRectTarget.left-this.__elementSliderTemplate.getBoundingClientRect().left+(e.clientX-this.__draggingInfo.startPositionX),min=boundingRectMin.left+boundingRectMin.width-this.__elementSliderTemplate.getBoundingClientRect().left,max=this.__elementSliderTemplate.getBoundingClientRect().width-boundingRectTarget.width;offsetX=offsetX<min?min:offsetX,offsetX=offsetX>max?max:offsetX,this.__draggingInfo.draggingElem.style.left=offsetX+"px",this.__elementSliderValue.style.width=offsetX-min+"px"}this.__draggingInfo.startPositionX=e.clientX,this.__calcValuesFromSlider()}}}__onTouchMove(){return e=>{if(this.__draggingInfo.isDragging&&this.__draggingInfo.draggingElem){if(this.__draggingInfo.draggingElem.classList.contains("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-slider-knob-min-value")){let boundingRectMax=this.__elementSliderMax.getBoundingClientRect(),boundingRectTarget=this.__draggingInfo.draggingElem.getBoundingClientRect(),offsetX=boundingRectTarget.left-this.__elementSliderTemplate.getBoundingClientRect().left+(e.touches[0].clientX-this.__draggingInfo.startPositionX),min=0,max=boundingRectMax.left-boundingRectMax.width-this.__elementSliderTemplate.getBoundingClientRect().left;offsetX=offsetX<min?min:offsetX,offsetX=offsetX>max?max:offsetX,this.__draggingInfo.draggingElem.style.left=offsetX+"px";let positionMax=this.__elementSliderTemplate.getBoundingClientRect().width-max-boundingRectMax.width;this.__elementSliderValue.style.width="calc(100% - "+(offsetX+boundingRectTarget.width+positionMax)+"px)",this.__elementSliderValue.style.left=offsetX+boundingRectTarget.width+"px"}else if(this.__draggingInfo.draggingElem.classList.contains("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-slider-knob-max-value")){let boundingRectMin=this.__elementSliderMin.getBoundingClientRect(),boundingRectTarget=this.__draggingInfo.draggingElem.getBoundingClientRect(),offsetX=boundingRectTarget.left-this.__elementSliderTemplate.getBoundingClientRect().left+(e.touches[0].clientX-this.__draggingInfo.startPositionX),min=boundingRectMin.left+boundingRectMin.width-this.__elementSliderTemplate.getBoundingClientRect().left,max=this.__elementSliderTemplate.getBoundingClientRect().width-boundingRectTarget.width;offsetX=offsetX<min?min:offsetX,offsetX=offsetX>max?max:offsetX,this.__draggingInfo.draggingElem.style.left=offsetX+"px",this.__elementSliderValue.style.width=offsetX-min+"px"}this.__draggingInfo.startPositionX=e.touches[0].clientX,this.__calcValuesFromSlider()}}}__onMouseUp(){return e=>{this.__draggingInfo.isDragging&&(this.__draggingInfo.isDragging=!1)}}__onTouchEnd(){return e=>{this.__draggingInfo.isDragging&&(this.__draggingInfo.isDragging=!1)}}}}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){TcHmiScopeControl.ServerSymbols=class{constructor(scopeControl){this.__parentControl=scopeControl}__parentControl;__fileUploader=null;setChartSize(setLoadingSpinner){let width=this.__parentControl.__elementChartings.innerWidth(),height=this.__parentControl.__elementChartings.innerHeight(),scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SetChartSize",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig,chartWidth:width,chartHeight:height}}]};this.__parentControl.__loadingSpinner&&setLoadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__setChartSizeRequestId),this.__parentControl.__scopeConfigToFile?this.__parentControl.__setChartSizeRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback()):this.__parentControl.__setChartSizeRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__setChartSizeCallback())}startRecord(recordTime){if(this.__parentControl.__scopeConfigToFile)return;let writeValue;writeValue=recordTime?{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig,recordTime:recordTime}:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig};let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".StartRecord",writeValue:writeValue}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__startRecordRequestId),this.__parentControl.__startRecordRequestId=TcHmi.Server.requestEx(request,{timeout:1e4},this.__parentControl.__getDataCallback())}stopRecord(){if(this.__parentControl.__scopeConfigToFile)return;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".StopRecord",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__stopRecordRequestId),this.__parentControl.__stopRecordRequestId=TcHmi.Server.requestEx(request,{timeout:1e4},this.__parentControl.__getDataCallback())}startDisplay(){if(this.__parentControl.__scopeConfigToFile)return;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".StartDisplay",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__startRequestId),this.__parentControl.__startRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}stopDisplay(){if(this.__parentControl.__scopeConfigToFile)return;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".StopDisplay",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__stopRequestId),this.__parentControl.__stopRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}__getDataAsRequest(){let writeValueData={controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfigToFile},request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetLayout",writeValue:writeValueData},{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetWindow",writeValue:writeValueData},{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetData",writeValue:writeValueData},{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetTriggerWindow",writeValue:writeValueData}]};TcHmi.Server.releaseRequest(this.__parentControl.__getDataRequestId),this.__parentControl.__getDataRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}setDisplayWidth(displayWidth){if(!/^[0-9],[0-9]{2}:[0-9]{2}:[0-9]{2},[0-9]{3}:[0-9]{3}?$/.test(displayWidth))return void TcHmi.Log.errorEx(`[Source=Control, Module=${this.__parentControl.getType()}, Id='${this.__parentControl.getId()}'] Wrong format for the argument "displayWidth". Example: "0,00:00:00,000:000"`);let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SetDisplayWidth",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig,displayWidth:Beckhoff.TcHmiScopeHelpers.ScopeHelper.__scopeStringToIso(displayWidth)}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),this.__parentControl.__displayWidthText=displayWidth,TcHmi.Server.releaseRequest(this.__parentControl.__displayWidthRequestId),this.__parentControl.__displayWidthRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}scroll(direction){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".Scroll",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig,direction:direction}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__scrollRequestId),this.__parentControl.__scrollRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}scrollBig(direction){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ScrollBig",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig,direction:direction}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__scrollBigRequestId),this.__parentControl.__scrollBigRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}goTo(goTo){if(!/^[0-9],[0-9]{2}:[0-9]{2}:[0-9]{2},[0-9]{3}:[0-9]{3}?$/.test(goTo))return void TcHmi.Log.errorEx(`[Source=Control, Module=${this.__parentControl.getType()}, Id='${this.__parentControl.getId()}'] Wrong format for the argument "goTo". Example: "0,00:00:00,000:000"`);let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".Goto",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig,position:Beckhoff.TcHmiScopeHelpers.ScopeHelper.__scopeStringToIso(goTo)}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),this.__parentControl.__gotoText=goTo,TcHmi.Server.releaseRequest(this.__parentControl.__gotoRequestId),this.__parentControl.__gotoRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}undo(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".Undo",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__undoRequestId),this.__parentControl.__undoRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}redo(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".Redo",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__redoRequestId),this.__parentControl.__redoRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}zoomToDefault(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ZoomToDefault",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__unzoomRequestId),this.__parentControl.__unzoomRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}zoomOutMax(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ZoomOutMax",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__zoomOutRequestId),this.__parentControl.__zoomOutRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}setOverviewMode(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SetOverviewMode",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig,showOverview:!this.__parentControl.__showOverview}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__setOverviewModeRequestId),this.__parentControl.__setOverviewModeRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}setMouseMode(valueNew){let convertedValue=TcHmi.ValueConverter.toEnum(valueNew,TcHmiScopeControl.MouseMode);if(!tchmi_equal(convertedValue,this.__parentControl.__mouseMode))if(TcHmi.EventProvider.raise(this.__parentControl.getId()+".onPropertyChanged",{propertyName:"MouseMode"}),this.__parentControl.__scopeLayout)if(convertedValue===TcHmiScopeControl.MouseMode.PanX)this.__parentControl.__toolBarControls.PanToggleButton&&(this.__parentControl.__toolBarControls.PanToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=TcHmiScopeControl.MouseMode.PanX);else if(convertedValue===TcHmiScopeControl.MouseMode.PanY)this.__parentControl.__toolBarControls.PanYToggleButton&&(this.__parentControl.__toolBarControls.PanYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=TcHmiScopeControl.MouseMode.PanY);else if(convertedValue===TcHmiScopeControl.MouseMode.PanXY)this.__parentControl.__toolBarControls.PanXYToggleButton&&(this.__parentControl.__toolBarControls.PanXYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=TcHmiScopeControl.MouseMode.PanXY);else if(convertedValue===TcHmiScopeControl.MouseMode.ZoomX)this.__parentControl.__toolBarControls.ZoomToggleButton&&(this.__parentControl.__toolBarControls.ZoomToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=TcHmiScopeControl.MouseMode.ZoomX);else if(convertedValue===TcHmiScopeControl.MouseMode.ZoomY)this.__parentControl.__toolBarControls.ZoomYToggleButton&&(this.__parentControl.__toolBarControls.ZoomYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=TcHmiScopeControl.MouseMode.ZoomY);else if(convertedValue===TcHmiScopeControl.MouseMode.ZoomXY)this.__parentControl.__toolBarControls.ZoomXYToggleButton&&(this.__parentControl.__toolBarControls.ZoomXYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=TcHmiScopeControl.MouseMode.ZoomXY);else{for(let controlName in this.__parentControl.__toolBarControls)controlName.includes("ToggleButton")&&this.__parentControl.__toolBarControls[controlName].setToggleState("Normal");switch(TcHmiScopeControl.ChartType[this.__parentControl.__scopeLayout.chartType]){case TcHmiScopeControl.ChartType.SingleBarChart:this.__parentControl.__toolBarControls.PanYToggleButton&&(this.__parentControl.__toolBarControls.PanYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=TcHmiScopeControl.MouseMode.PanY);break;case TcHmiScopeControl.ChartType.YT:case TcHmiScopeControl.ChartType.XY:case TcHmiScopeControl.ChartType.ArrayBarChart:default:this.__parentControl.__toolBarControls.PanXYToggleButton&&(this.__parentControl.__toolBarControls.PanXYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=TcHmiScopeControl.MouseMode.PanXY)}}else this.__parentControl.__mouseMode=TcHmiScopeControl.MouseMode.None}changeChannelState(id,state){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ChangeChannelState",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig,channelId:id,newState:state}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__changeChannelStateRequestId),this.__parentControl.__changeChannelStateRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}__downloadScopeRecord(element=null){if(element){let downloaderAElement=document.createElement("a");downloaderAElement.href=tchmi_path(TcHmi.Environment.getHostBaseUri()+"/Config/ExtensionData/"+this.__parentControl.__serverDomain+"?extensionName="+element.extensionName+"&userName="+element.userName+"&fileName="+element.fileName),downloaderAElement.style.display="none",downloaderAElement.download="ScopeRecord.svdx",document.body.appendChild(downloaderAElement),downloaderAElement.click(),document.body.removeChild(downloaderAElement)}else if(this.__parentControl.__scopeConfig){let downloaderAElement=document.createElement("a");downloaderAElement.href=tchmi_path(TcHmi.Environment.getHostBaseUri()+"/Config/ExtensionData/"+this.__parentControl.__serverDomain+"?configName="+this.__parentControl.__scopeConfig.name),downloaderAElement.style.display="none",downloaderAElement.download="ScopeRecord.svdx",document.body.appendChild(downloaderAElement),downloaderAElement.click(),document.body.removeChild(downloaderAElement)}else TcHmi.Log.error(`[Source=Control, Module=${this.__parentControl.getType()}, Id=${this.__parentControl.getId()}] ScopeConfig has not been defined.`)}uploadRecord(file,persist,chunkSize){if(this.__parentControl.__dialog){this.__parentControl.__dialog.setIsWaitingForServer(!0),this.__parentControl.__dialog.disableAllButtons();let allChunks=Math.ceil(file.size/chunkSize);this.__parentControl.__dialog.setProgressbarMaxValue(allChunks)}this.__fileUploader??=new TcHmi.FileUploader({domain:this.__parentControl.__serverDomain}),this.__fileUploader.chunkSize=chunkSize;let blob=file.slice(0,file.size);this.__fileUploader?.queue(file.name,blob,{progressCallback:this.__uploadCallback(),additionalProperties:{fileSize:file.size,persist:persist}})}__uploadCallback(){return result=>{if(!this.__parentControl.getIsDestroyed())if(result&&result.error===TcHmi.Errors.NONE){if(result.status===TcHmi.FileUploader.FileStatus.Finished)this.__parentControl.__dialog&&(this.__parentControl.__dialog.setIsWaitingForServer(!1),this.__parentControl.__dialog.enableAllButtons());else if(this.__parentControl.__dialog){let value=this.__parentControl.__dialog.getProgressbarValue();this.__parentControl.__dialog.setProgressbarValue(value+1)}}else if(result.error){if(result.details.errors)for(let i=0,ii=result.details.errors.length;i<ii;i++)if(result.details.errors[i].code){if(TcHmi.Log.errorEx(`[Source=Control, Module=${this.__parentControl.getType()}, Id='${this.__parentControl.getId()}'] Server responds with error for command for symbol 'Upload'\n                                        }. Details: `+TcHmi.Log.buildMessage(result.details.errors[i])),result.details.errors[i].code){const errorMessage=result.details.errors[i].reason??result.details.errors[i].message??result.details.errors[i].code?.toString()??"";this.__parentControl.__dialog&&(this.__parentControl.__createErrorDialog("%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_Upload%/l%",errorMessage),this.__parentControl.__dialog.setIsWaitingForServer(!1),this.__parentControl.__dialog.enableAllButtons())}return}TcHmi.Log.errorEx(`[Source=Control, Module=${this.__parentControl.getType()}, Id='${this.__parentControl.getId()}'] Framework error=${result.error}, name=${TcHmi.Errors[result.error]} while fetching data from server.`)}}}async saveCurrentRecord(){if(this.__parentControl.__scopeConfig){let replace=!1;if(void 0===this.__parentControl.__replace){if(this.__parentControl.__uploadedRecordsForActUser){let userInfos=TcHmi.Server.getCurrentUserConfig(),filteredElements=this.__parentControl.__uploadedRecordsForActUser.filter((x=>x.userName===userInfos.name&&x.extensionName===userInfos.defaultAuthExtension&&x.fileName.includes(this.__parentControl.__scopeConfig?.name)));if(this.__parentControl.__dialog&&filteredElements&&filteredElements.length>0){let promise=await this.__parentControl.__dialog.replaceOrIncrementCurrentRecord();if("cancel"===promise.result)return;"replace"===promise.result&&(replace=!0),promise.saveResult&&(this.__parentControl.__replace=replace,this.__parentControl.__storage?.set("replace",this.__parentControl.__replace))}}}else replace=this.__parentControl.__replace;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SaveCurrentRecord",writeValue:{scopeConfigName:this.__parentControl.__scopeConfig.name,persist:!0,replace:replace}}]};this.__parentControl.__dialog&&(this.__parentControl.__dialog.setIsWaitingForServer(!0),this.__parentControl.__dialog.disableAllButtons()),TcHmi.Server.releaseRequest(this.__parentControl.__saveCurrentRecordRequestId),this.__parentControl.__saveCurrentRecordRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}}deleteScopeUpload(elements){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".DeleteScopeRecord",writeValue:elements}]};this.__parentControl.__dialog&&(this.__parentControl.__dialog.setIsWaitingForServer(!0),this.__parentControl.__dialog.disableAllButtons()),TcHmi.Server.releaseRequest(this.__parentControl.__deleteScopeRecordRequestId),this.__parentControl.__deleteScopeRecordRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}changePersist(element){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ChangePersist",writeValue:element}]};TcHmi.Server.releaseRequest(this.__parentControl.__changePersistRequestId),this.__parentControl.__changePersistRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}getChartList(element){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetChartList",writeValue:element}]};TcHmi.Server.releaseRequest(this.__parentControl.__getChartListRequestId),this.__parentControl.__getChartListRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}download(element){this.__downloadScopeRecord(element)}openConnectionToFile(element){if(null===this.__parentControl.__openConnectionRequestId){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:this.__parentControl.__serverDomain+".OpenConnectionToFile",writeValue:{controlName:this.__parentControl.getId(),uploadFileInformation:element}}]};TcHmi.Server.releaseRequest(this.__parentControl.__openConnectionToFileRequestId),this.__parentControl.__openConnectionToFileRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}else this.__parentControl.__dialog&&(this.__parentControl.__createErrorDialog("%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_OpenConnectionNotReady%/l%"),this.__parentControl.__dialog.closeChartsDialog())}detachFromScopeRecord(){if(this.__parentControl.__scopeConfigToFile){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".CloseConnection",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfigToFile}}]};TcHmi.Server.releaseRequest(this.__parentControl.__closeConnectionRequestId),this.__parentControl.__closeConnectionRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}}closeConnection(scopeConfig){if(scopeConfig){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".CloseConnection",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:scopeConfig}}]};TcHmi.Server.releaseRequest(this.__parentControl.__closeConnectionRequestId),this.__parentControl.__closeConnectionRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}}getAnalyticsData(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetAnalyticsData",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:null!==this.__parentControl.__scopeConfigToFile?this.__parentControl.__scopeConfigToFile:this.__parentControl.__scopeConfig}}]};TcHmi.Server.releaseRequest(this.__parentControl.__getAnalyticsDataRequestId),this.__parentControl.__getAnalyticsDataRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback())}setAnalyticsRecord(recordName,recordId,startTime,endTime){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SetAnalyticsRecord",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:null!==this.__parentControl.__scopeConfigToFile?this.__parentControl.__scopeConfigToFile:this.__parentControl.__scopeConfig,recordName:recordName,recordId:recordId,startTime:startTime,endTime:endTime}}]};TcHmi.Server.releaseRequest(this.__parentControl.__setAnalyticsRecordRequestId),this.__parentControl.__setAnalyticsRecordRequestId=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback()),this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner)}}}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeHelpers){!function(ScopeHelper){ScopeHelper.__scopeStringToIso=function(scopeString){if("0,00:00:00,000:000"===scopeString)return"PT0S";let commaResult=scopeString.split(","),colonResult=commaResult[1].split(":"),colonSecondsResult=commaResult[2].split(":"),fullDays=parseInt(commaResult[0],10),years=Math.floor(fullDays/365.25),months=Math.floor(fullDays%365.25/30.4375),days=Math.floor(fullDays%365.25%30.4375),hours=parseInt(colonResult[0],10),minutes=parseInt(colonResult[1],10),seconds=parseInt(colonResult[2],10),f=parseInt(colonSecondsResult[0]+colonSecondsResult[1],10),isoString="";return isoString+="P",years>0&&(isoString+=years+"Y"),months>0&&(isoString+=months+"M"),days>0&&(isoString+=days+"D"),(hours>0||minutes>0||seconds>0||f>0)&&(isoString+="T"),hours>0&&(isoString+=hours+"H"),minutes>0&&(isoString+=minutes+"M"),(seconds>0||0===days&&0===hours&&0===minutes)&&(isoString+=seconds),f>0&&(isoString+="."+("000000"+f).slice(-6).replace(/\.?0+$/,"")),(f>0||seconds>0)&&(isoString+="S"),isoString},ScopeHelper.__isoToScopeString=function(t){let seconds=0,minutes=0,hours=0,days=0,months=0,years=0,isTime=!1,current=t.split("");for(let i=0,ii=current.length;i<ii;i++){let num=0,sNum="";for(;current[i]>="0"&&current[i]<="9"||"."===current[i];)sNum+=current[i],i++,num=parseFloat(sNum);switch(current[i]){case"Y":years=num,days+=365.25*years;break;case"D":days=num;break;case"T":isTime=!0;break;case"H":hours=num;break;case"M":isTime?minutes=num:(months=num,days+=30.4375*months);break;case"S":seconds=num}}let milliseconds=seconds.toString().split(".")[1];if(milliseconds){if(milliseconds=milliseconds.slice(0,6),milliseconds.length<6)for(let i=milliseconds.length,ii=6;i<ii;i++)milliseconds+=0}else milliseconds="000000";return days+","+("00"+hours).slice(-2)+":"+("00"+minutes).slice(-2)+":"+("00"+Math.floor(seconds)).slice(-2)+","+("000"+milliseconds.slice(0,3)).slice(-3)+":"+("000"+milliseconds.slice(3,6)).slice(-3)},ScopeHelper.__isoToMilliSec=function(t){let seconds=0,minutes=0,hours=0,days=0,months=0,years=0,isneg=!1,isTime=!1,current=t.split("");for(let i=0,ii=current.length;i<ii;i++){let num=0,sNum="";for(;current[i]>="0"&&current[i]<="9"||"."===current[i];)sNum+=current[i],i++,num=parseFloat(sNum);switch(current[i]){case"-":isneg=!0;break;case"Y":years=num;break;case"D":days=num;break;case"T":isTime=!0;break;case"H":hours=num;break;case"M":isTime?minutes=num:months=num;break;case"S":seconds=num}}let milliSec=3154e7*years;return milliSec+=2628e6*months,milliSec+=864e5*days,milliSec+=36e5*hours,milliSec+=6e4*minutes,milliSec+=1e3*seconds,isneg&&(milliSec*=-1),milliSec}}(TcHmiScopeHelpers.ScopeHelper||(TcHmiScopeHelpers.ScopeHelper={}))}(Beckhoff.TcHmiScopeHelpers||(Beckhoff.TcHmiScopeHelpers={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){!function(Controls){!function(Beckhoff){!function(TcHmiScopeControl){let ConfigType,ChartColorSource,TriggerWindowPosition,ChartType,Orientation,ButtonsEnabled,TimesEnabled,LineState,MouseMode,Direction,GraphType,FillMode;!function(ConfigType){ConfigType[ConfigType.Add=0]="Add",ConfigType[ConfigType.Change=1]="Change",ConfigType[ConfigType.Rename=2]="Rename",ConfigType[ConfigType.Delete=3]="Delete"}(ConfigType=TcHmiScopeControl.ConfigType||(TcHmiScopeControl.ConfigType={})),function(ChartColorSource){ChartColorSource[ChartColorSource.ScopeConfig=0]="ScopeConfig",ChartColorSource[ChartColorSource.Theme=1]="Theme"}(ChartColorSource=TcHmiScopeControl.ChartColorSource||(TcHmiScopeControl.ChartColorSource={})),function(TriggerWindowPosition){TriggerWindowPosition[TriggerWindowPosition.Left=0]="Left",TriggerWindowPosition[TriggerWindowPosition.Right=1]="Right",TriggerWindowPosition[TriggerWindowPosition.Top=2]="Top",TriggerWindowPosition[TriggerWindowPosition.Bottom=3]="Bottom"}(TriggerWindowPosition=TcHmiScopeControl.TriggerWindowPosition||(TcHmiScopeControl.TriggerWindowPosition={})),function(ChartType){ChartType[ChartType.YT=0]="YT",ChartType[ChartType.XY=1]="XY",ChartType[ChartType.ArrayBarChart=2]="ArrayBarChart",ChartType[ChartType.SingleBarChart=3]="SingleBarChart"}(ChartType=TcHmiScopeControl.ChartType||(TcHmiScopeControl.ChartType={})),function(Orientation){Orientation[Orientation.Vertical=1]="Vertical",Orientation[Orientation.Horizontal=2]="Horizontal"}(Orientation=TcHmiScopeControl.Orientation||(TcHmiScopeControl.Orientation={})),function(ButtonsEnabled){ButtonsEnabled[ButtonsEnabled.None=0]="None",ButtonsEnabled[ButtonsEnabled.RunButton=1]="RunButton",ButtonsEnabled[ButtonsEnabled.PauseButton=2]="PauseButton",ButtonsEnabled[ButtonsEnabled.Splitter1=4]="Splitter1",ButtonsEnabled[ButtonsEnabled.DisplaywidthTextBox=8]="DisplaywidthTextBox",ButtonsEnabled[ButtonsEnabled.Splitter2=16]="Splitter2",ButtonsEnabled[ButtonsEnabled.ScrollBackBigButton=32]="ScrollBackBigButton",ButtonsEnabled[ButtonsEnabled.ScrollBackSmallButton=64]="ScrollBackSmallButton",ButtonsEnabled[ButtonsEnabled.ScrollForwardSmallButton=128]="ScrollForwardSmallButton",ButtonsEnabled[ButtonsEnabled.ScrollForwardBigButton=256]="ScrollForwardBigButton",ButtonsEnabled[ButtonsEnabled.Splitter3=512]="Splitter3",ButtonsEnabled[ButtonsEnabled.GotoTextBox=1024]="GotoTextBox",ButtonsEnabled[ButtonsEnabled.Splitter4=2048]="Splitter4",ButtonsEnabled[ButtonsEnabled.UndoButton=4096]="UndoButton",ButtonsEnabled[ButtonsEnabled.RedoButton=8192]="RedoButton",ButtonsEnabled[ButtonsEnabled.Splitter5=16384]="Splitter5",ButtonsEnabled[ButtonsEnabled.PanToggleButton=65536]="PanToggleButton",ButtonsEnabled[ButtonsEnabled.PanYToggleButton=33554432]="PanYToggleButton",ButtonsEnabled[ButtonsEnabled.PanXYToggleButton=131072]="PanXYToggleButton",ButtonsEnabled[ButtonsEnabled.ZoomToggleButton=262144]="ZoomToggleButton",ButtonsEnabled[ButtonsEnabled.ZoomYToggleButton=67108864]="ZoomYToggleButton",ButtonsEnabled[ButtonsEnabled.ZoomXYToggleButton=524288]="ZoomXYToggleButton",ButtonsEnabled[ButtonsEnabled.UnzoomButton=1048576]="UnzoomButton",ButtonsEnabled[ButtonsEnabled.ZoomOutMaxButton=2097152]="ZoomOutMaxButton",ButtonsEnabled[ButtonsEnabled.OverviewButton=4194304]="OverviewButton"}(ButtonsEnabled=TcHmiScopeControl.ButtonsEnabled||(TcHmiScopeControl.ButtonsEnabled={})),function(TimesEnabled){TimesEnabled[TimesEnabled.None=0]="None",TimesEnabled[TimesEnabled.StartTimeLabel=1]="StartTimeLabel",TimesEnabled[TimesEnabled.Splitter1=2]="Splitter1",TimesEnabled[TimesEnabled.EndTimeLabel=4]="EndTimeLabel",TimesEnabled[TimesEnabled.Splitter2=8]="Splitter2",TimesEnabled[TimesEnabled.PositionLabel=16]="PositionLabel",TimesEnabled[TimesEnabled.Splitter3=32]="Splitter3",TimesEnabled[TimesEnabled.AbsTimeLabel=64]="AbsTimeLabel",TimesEnabled[TimesEnabled.Splitter4=128]="Splitter4",TimesEnabled[TimesEnabled.DateLabel=256]="DateLabel"}(TimesEnabled=TcHmiScopeControl.TimesEnabled||(TcHmiScopeControl.TimesEnabled={})),function(LineState){LineState[LineState.None=0]="None",LineState[LineState.Normal=1]="Normal",LineState[LineState.Bold=2]="Bold",LineState[LineState.MediumBold=4]="MediumBold",LineState[LineState.Invisible=8]="Invisible",LineState[LineState.Up=16]="Up",LineState[LineState.Down=32]="Down",LineState[LineState.Dashed=256]="Dashed",LineState[LineState.DashedLine=4352]="DashedLine",LineState[LineState.MarkerArrowRight=17408]="MarkerArrowRight",LineState[LineState.MarkerArrowLeft=18432]="MarkerArrowLeft",LineState[LineState.ApplyToLine=4096]="ApplyToLine",LineState[LineState.ApplyToFillArea=8192]="ApplyToFillArea",LineState[LineState.ApplyToMark=16384]="ApplyToMark",LineState[LineState.ApplyToLineNMarkNFill=28672]="ApplyToLineNMarkNFill",LineState[LineState.InvisibleLine=4104]="InvisibleLine",LineState[LineState.InvisibleMark=16392]="InvisibleMark",LineState[LineState.InvisibleLineNMark=20488]="InvisibleLineNMark",LineState[LineState.LineUp=4112]="LineUp",LineState[LineState.LineDown=4128]="LineDown",LineState[LineState.MarkUp=16400]="MarkUp",LineState[LineState.MarkDown=16416]="MarkDown",LineState[LineState.LineNMarkUp=20496]="LineNMarkUp",LineState[LineState.LineNMarkDown=20512]="LineNMarkDown",LineState[LineState.NormalLine=4097]="NormalLine",LineState[LineState.NormalLineUp=4113]="NormalLineUp",LineState[LineState.NormalLineDown=4129]="NormalLineDown",LineState[LineState.NormalFill=8193]="NormalFill",LineState[LineState.NormalMark=16385]="NormalMark",LineState[LineState.NormalMarkUp=16401]="NormalMarkUp",LineState[LineState.NormalMarkDown=16417]="NormalMarkDown",LineState[LineState.NormalLineNMark=20481]="NormalLineNMark",LineState[LineState.NormalLineNMarkUp=20497]="NormalLineNMarkUp",LineState[LineState.NormalLineNMarkDown=20513]="NormalLineNMarkDown",LineState[LineState.BoldLine=4098]="BoldLine",LineState[LineState.BoldLineUp=4114]="BoldLineUp",LineState[LineState.BoldLineDown=4130]="BoldLineDown",LineState[LineState.BoldMark=16386]="BoldMark",LineState[LineState.BoldMarkUp=16402]="BoldMarkUp",LineState[LineState.BoldMarkDown=16418]="BoldMarkDown",LineState[LineState.BoldLineNMark=20482]="BoldLineNMark",LineState[LineState.BoldLineNMarkUp=20498]="BoldLineNMarkUp",LineState[LineState.BoldLineNMarkDown=20514]="BoldLineNMarkDown",LineState[LineState.MediumBoldLine=4100]="MediumBoldLine",LineState[LineState.MediumBoldLineUp=4116]="MediumBoldLineUp",LineState[LineState.MediumBoldLineDown=4132]="MediumBoldLineDown",LineState[LineState.MediumBoldMark=16388]="MediumBoldMark",LineState[LineState.MediumBoldMarkUp=16404]="MediumBoldMarkUp",LineState[LineState.MediumBoldMarkDown=16420]="MediumBoldMarkDown",LineState[LineState.MediumBoldLineNMark=20484]="MediumBoldLineNMark",LineState[LineState.MediumBoldLineNMarkUp=20500]="MediumBoldLineNMarkUp",LineState[LineState.MediumBoldLineNMarkDown=20516]="MediumBoldLineNMarkDown",LineState[LineState.Colored=0xffffff0000]="Colored",LineState[LineState.ColoredRed=0xff00000000]="ColoredRed",LineState[LineState.ColoredGreen=4278190080]="ColoredGreen",LineState[LineState.ColoredBlue=16711680]="ColoredBlue",LineState[LineState.Transparent=0xff0000000000]="Transparent"}(LineState=TcHmiScopeControl.LineState||(TcHmiScopeControl.LineState={})),function(MouseMode){MouseMode[MouseMode.None=0]="None",MouseMode[MouseMode.ZoomX=1]="ZoomX",MouseMode[MouseMode.ZoomY=2]="ZoomY",MouseMode[MouseMode.ZoomXY=3]="ZoomXY",MouseMode[MouseMode.PanX=4]="PanX",MouseMode[MouseMode.PanY=5]="PanY",MouseMode[MouseMode.PanXY=6]="PanXY"}(MouseMode=TcHmiScopeControl.MouseMode||(TcHmiScopeControl.MouseMode={})),function(Direction){Direction.Forward="Forward",Direction.Reverse="Reverse"}(Direction=TcHmiScopeControl.Direction||(TcHmiScopeControl.Direction={})),function(GraphType){GraphType.Line="Line",GraphType.Stair="Stair",GraphType.Bar="Bar",GraphType.ExtendedLine="ExtendedLine",GraphType.RoundShape="RoundShape"}(GraphType=TcHmiScopeControl.GraphType||(TcHmiScopeControl.GraphType={})),function(FillMode){FillMode.None="None",FillMode.FromHorizontalZero="FromHorizontalZero",FillMode.FromBottom="FromBottom",FillMode.FromTop="FromTop",FillMode.FromCenter="FromCenter",FillMode.FromSource="FromSource",FillMode.FromFirst="FromFirst"}(FillMode=TcHmiScopeControl.FillMode||(TcHmiScopeControl.FillMode={}))}(Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={}));