function [coeff] = Quintic(t, p, v0, acc0)
A = zeros(18, 18);
B = zeros(18,1);

A(1, 1:5) = F4(t(1));
A(2, 1:5) = F4Dot(t(1));
A(3, 1:5) = F4DotDot(t(1));
A(4, 1:5) = F4(t(2));
A(5, 1:5) = F4(t(2));           A(5, 6:9) = -F3(t(2));
A(6, 1:5) = F4Dot(t(2));        A(6, 6:9) = -F3Dot(t(2));
A(7, 1:5) = F4DotDot(t(2));     A(7, 6:9) = -F3DotDot(t(2));
A(8, 6:9) = F3(t(3));
A(9, 6:9) = F3(t(3));           A(9, 10:13) = -F3(t(3));
A(10, 6:9) = F3Dot(t(3));       A(10, 10:13) = -F3Dot(t(3));
A(11, 6:9) = F3DotDot(t(3));    A(11, 10:13) = -F3DotDot(t(3));
A(12, 10:13) = F3(t(4));
A(13, 10:13) = F3(t(4));            A(13, 14:18) = -F4(t(4));
A(14, 10:13) = F3Dot(t(4));         A(14, 14:18) = -F4Dot(t(4));
A(15, 10:13) = F3DotDot(t(4));      A(15, 14:18) = -F4DotDot(t(4));
A(16, 14:18) = F4(t(5));
A(17, 14:18) = F4Dot(t(5));
A(18, 14:18) = F4DotDot(t(5));

B(1) = p(1);
B(2) = v0;
B(3) = acc0;
B(4) = p(2);
B(8) = p(3);
B(12) = p(4);
B(16) = p(5);

coeff = A\B;
end